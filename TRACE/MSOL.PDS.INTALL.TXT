CNTL MEMBER NAME  ICKDSF
CNTL //ICKDSF  JOB MOVE,'ICKDSF INIT DISQUE',NOTIFY=&SYSUID
CNTL //*---------------------------------------------------------------------
CNTL //ICKDSF EXEC PGM=ICKDSF,PARM='NOREPLYU,FORCE'
CNTL //SYSPRINT DD SYSOUT=*
CNTL //*DA      DD DISP=SHR,UNIT=3390,VOL=SER=MSOL01
CNTL //*---------------------------------------------------------------------
CNTL //SYSIN    DD *
CNTL   INIT UNIT(0A9B) VTOC(1,0,270) -
CNTL   INDEX(0,1,14) NOVERIFY
CNTL //* SOUS SDSF I:
CNTL //* *10 ICK003D REPLY U TO ALTER VOLUME 0A9B CONTENTS, ELSE T
CNTL //* AVEC LA CONSOLE ON REPOND
CNTL //* R 10,U
CNTL MEMBER NAME  FTP
CNTL //XFTP     JOB MOVE,'FTP',NOTIFY=&SYSUID
CNTL //*---------------------------------------------------------------------
CNTL //XFER     EXEC PGM=FTP
CNTL //SYSTCPD  DD DISP=SHR,DSN=MSOL.JCL(TCPDATA)
CNTL //SYSFTPD  DD DISP=SHR,DSN=MSOL.JCL(TCPDATA)
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SYSPRINT DD SYSOUT=*
CNTL //NETRC    DD DISP=SHR,DSN=MSOL.JCL(NETRC)
CNTL //SYSIN    DD *
CNTL airbus airmovebus185
CNTL OPEN
CNTL ASCII
CNTL PUT 'MSOL.JCL($CASM)' $CASM.mvs
CNTL QUIT
CNTL MEMBER NAME  ADRDSSU
CNTL //ADRDSSU  JOB MOVE,'ADRDSSU SAVE FILE',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*---------------------------------------------------------------------
CNTL // SET MYSAVE=MSOL.SAVE.CSD
CNTL //*---------------------------------------------------------------------
CNTL //DELETE   EXEC PGM=IEFBR14
CNTL //F0001    DD DSN=&MYSAVE,
CNTL //         DISP=(MOD,DELETE),SPACE=(TRK,0)
CNTL //*---------------------------------------------------------------------
CNTL //ADRDSSU  EXEC PGM=ADRDSSU
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SYSPRINT DD SYSOUT=*
CNTL //MYSAVE   DD DSN=&MYSAVE,
CNTL //            VOL=SER=MSOL01,
CNTL //            SPACE=(TRK,(500,500),RLSE),
CNTL //            DISP=(NEW,CATLG,DELETE)
CNTL //SYSIN    DD *
CNTL  DUMP DATASET(                 -
CNTL  INCLUDE(                      -
CNTL          DFH320.CICS.DFHCSD.*  -
CNTL          ))                    -
CNTL  OUTDDNAME(MYSAVE)             -
CNTL  ALLDATA(*)                    -
CNTL  ALLEXCP                       -
CNTL  OPTIMIZE(4)
CNTL MEMBER NAME  IEB$UPD
CNTL //IEB$UPD  JOB MOVE,'IEBUPDTE',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*---------------------------------------------------------------------
CNTL // SET SEQ=MSOL.XFER
CNTL // SET PDS=CECABANK.PDS.PROCLIB
CNTL //*---------------------------------------------------------------------
CNTL //DELETE   EXEC PGM=IEFBR14
CNTL //F0001    DD DSN=&PDS,
CNTL //         DISP=(MOD,DELETE),SPACE=(TRK,0)
CNTL //*---------------------------------------------------------------------
CNTL //IEBUPDTE EXEC PGM=IEBUPDTE,PARM=NEW
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSUT2   DD DSN=&PDS,DISP=(NEW,CATLG),
CNTL //         VOL=SER=MSOL01,SPACE=(TRK,(10,10,20),RLSE),
CNTL //         DCB=(RECFM=FB,LRECL=80,BLKSIZE=8000)
CNTL //SYSIN    DD DISP=SHR,DSN=&SEQ
CNTL MEMBER NAME  CSD$ADD
CNTL //CSD$ADD  JOB MOVE,'CHARGEMENT CSD   ',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*--------------------------------------------------------------------
CNTL //CSDXTRCT EXEC PGM=DFHCSDUP
CNTL //STEPLIB   DD DISP=SHR,DSN=DFH320.CICS.SDFHLOAD
CNTL //          DD DISP=SHR,DSN=DFH320.CPSM.SEYUAUTH
CNTL //DFHCSD    DD DISP=SHR,DSN=DFH320.CICS.DFHCSD
CNTL //SYSOUT    DD SYSOUT=*
CNTL //SYSPRINT  DD SYSOUT=*
CNTL //SYSIN     DD *
CNTL  DEL  GROUP(MOVEGRP) REMOVE
CNTL  ADD  GROUP(MOVEGRP) LIST(MOVELIST)
CNTL  DEF  MAPSET(BCOBCIC) GROUP(MOVEGRP)
CNTL  DEF  PROGRAM(PCOBCIC) GROUP(MOVEGRP) LANGUAGE(COBOL)
CNTL  DEF  TRANSACTION(TCOB) GROUP(MOVEGRP) PROGRAM(PCOBCIC)
CNTL MEMBER NAME  CSD$LIST
CNTL //CSD$LIST JOB MOVE,'LISTE DE LA CSD  ',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*--------------------------------------------------------------------
CNTL //CSDXTRCT EXEC PGM=DFHCSDUP,
CNTL //             COND=(0,NE),
CNTL //             PARM='CSD(READONLY)'
CNTL //STEPLIB   DD DISP=SHR,DSN=DFH320.CICS.SDFHLOAD
CNTL //          DD DISP=SHR,DSN=DFH320.CPSM.SEYUAUTH
CNTL //DFHCSD    DD DISP=SHR,DSN=DFH320.CICS.DFHCSD
CNTL //SYSOUT    DD SYSOUT=*
CNTL //SYSPRINT  DD SYSOUT=*
CNTL //SYSIN     DD *
CNTL  LIST GROUP(MOVEGRP) OBJECTS
CNTL //
CNTL  LIST ALL
CNTL MEMBER NAME  IDC$LSTC
CNTL //IDC$LSTC JOB MOVE,'LISTCAT VSAM     ',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*---------------------------------------------------------------------
CNTL //IDCAMS   EXEC PGM=IDCAMS
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SYSIN    DD *
CNTL  LISTCAT ENTRIES(DFH320.CICS.DFHCSD) ALL
CNTL MEMBER NAME  C$DBD
CNTL //C$DBD    JOB MOVE,'DBDGEN',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*--------------------------------------------------< VARIABLES   >---
CNTL // SET SRCELIB=CECABANK.PDS.DBD
CNTL // SET LOADLIB=CECABANK.PDS.DBDLIB
CNTL //*--------------------------------------------------< COMPILATION >---
CNTL //DBDGEN   PROC MBR=
CNTL //C        EXEC PGM=ASMA90,REGION=0M,
CNTL //            PARM=(OBJECT,NODECK,NODBCS,'SIZE(MAX,ABOVE)')
CNTL //SYSIN    DD DISP=SHR,DSN=&SRCELIB(&MBR)
CNTL //SYSLIB   DD DSN=IMS1010.SDFSMAC,DISP=SHR
CNTL //SYSLIN   DD UNIT=SYSDA,DISP=(,PASS),
CNTL //            SPACE=(80,(100,100),RLSE),
CNTL //            DCB=(BLKSIZE=80,RECFM=F,LRECL=80)
CNTL //SYSPRINT DD SYSOUT=*,DCB=BLKSIZE=1089,
CNTL //            SPACE=(121,(300,300),RLSE,,ROUND)
CNTL //SYSUT1   DD UNIT=SYSDA,DISP=(,DELETE),
CNTL //            SPACE=(CYL,(10,5))
CNTL //*--------------------------------------------------< LINK EDIT   >---
CNTL //L        EXEC PGM=IEWL,PARM='XREF,LIST',
CNTL //            COND=(0,LT,C),REGION=4M
CNTL //SYSLIN   DD DSN=*.C.SYSLIN,DISP=(OLD,DELETE)
CNTL //SYSPRINT DD SYSOUT=*,DCB=BLKSIZE=1089,
CNTL //         SPACE=(121,(90,90),RLSE)
CNTL //SYSLMOD  DD DISP=SHR,DSN=&LOADLIB(&MBR)
CNTL //SYSUT1   DD UNIT=(SYSDA,SEP=(SYSLMOD,SYSLIN)),
CNTL //         SPACE=(1024,(100,10),RLSE),DISP=(,DELETE)
CNTL // PEND
CNTL //*---------------------------------------------------------------------
CNTL //DBAGSAI  EXEC DBDGEN,MBR=DBAGSAI
CNTL //DBA050O  EXEC DBDGEN,MBR=DBA050O
CNTL //DBA061O  EXEC DBDGEN,MBR=DBA061O
CNTL //DBA100O  EXEC DBDGEN,MBR=DBA100O
CNTL //DBA130O  EXEC DBDGEN,MBR=DBA130O
CNTL //DBA170I  EXEC DBDGEN,MBR=DBA170I
CNTL //DBA170O  EXEC DBDGEN,MBR=DBA170O
CNTL //DBA220O  EXEC DBDGEN,MBR=DBA220O
CNTL //DBA300O  EXEC DBDGEN,MBR=DBA300O
CNTL //DBBOBBO  EXEC DBDGEN,MBR=DBBOBBO
CNTL //DBBOCTL  EXEC DBDGEN,MBR=DBBOCTL
CNTL //DBBOCTR  EXEC DBDGEN,MBR=DBBOCTR
CNTL //DBBOCUM  EXEC DBDGEN,MBR=DBBOCUM
CNTL //DBBOIBC  EXEC DBDGEN,MBR=DBBOIBC
CNTL //DBBOIBO  EXEC DBDGEN,MBR=DBBOIBO
CNTL //DBBOLAG  EXEC DBDGEN,MBR=DBBOLAG
CNTL //DBBOUNU  EXEC DBDGEN,MBR=DBBOUNU
CNTL //DBCCCLO  EXEC DBDGEN,MBR=DBCCCLO
CNTL //DBCCMTO  EXEC DBDGEN,MBR=DBCCMTO
CNTL //DBCCTAS  EXEC DBDGEN,MBR=DBCCTAS
CNTL //DBCCVAL  EXEC DBDGEN,MBR=DBCCVAL
CNTL //DBCLIEN  EXEC DBDGEN,MBR=DBCLIEN
CNTL //DBCONTR  EXEC DBDGEN,MBR=DBCONTR
CNTL //DBCUMVA  EXEC DBDGEN,MBR=DBCUMVA
CNTL //DBDOCUM  EXEC DBDGEN,MBR=DBDOCUM
CNTL //DBENTIF  EXEC DBDGEN,MBR=DBENTIF
CNTL //DBFECOL  EXEC DBDGEN,MBR=DBFECOL
CNTL //DBLTERM  EXEC DBDGEN,MBR=DBLTERM
CNTL //DBODDIA  EXEC DBDGEN,MBR=DBODDIA
CNTL //DBOPERA  EXEC DBDGEN,MBR=DBOPERA
CNTL //DBP1PRT  EXEC DBDGEN,MBR=DBP1PRT
CNTL //DBP2PRT  EXEC DBDGEN,MBR=DBP2PRT
CNTL //DBTOPER  EXEC DBDGEN,MBR=DBTOPER
CNTL //DBVAFIN  EXEC DBDGEN,MBR=DBVAFIN
CNTL //DBVAIMP  EXEC DBDGEN,MBR=DBVAIMP
CNTL //DBVALOR  EXEC DBDGEN,MBR=DBVALOR
CNTL //DBVAMOR  EXEC DBDGEN,MBR=DBVAMOR
CNTL //DBVATAR  EXEC DBDGEN,MBR=DBVATAR
CNTL //DBVAUNU  EXEC DBDGEN,MBR=DBVAUNU
CNTL //DBVCUMP  EXEC DBDGEN,MBR=DBVCUMP
CNTL //DBVTX06  EXEC DBDGEN,MBR=DBVTX06
CNTL //DWCCTAS  EXEC DBDGEN,MBR=DWCCTAS
CNTL //DXBOLAG  EXEC DBDGEN,MBR=DXBOLAG
CNTL //DXCLIEN  EXEC DBDGEN,MBR=DXCLIEN
CNTL //DXCONTR  EXEC DBDGEN,MBR=DXCONTR
CNTL //DXDOCUM  EXEC DBDGEN,MBR=DXDOCUM
CNTL //DXENTIF  EXEC DBDGEN,MBR=DXENTIF
CNTL //DXFECOL  EXEC DBDGEN,MBR=DXFECOL
CNTL //DXODDIA  EXEC DBDGEN,MBR=DXODDIA
CNTL //DXOPERA  EXEC DBDGEN,MBR=DXOPERA
CNTL //DXTOPER  EXEC DBDGEN,MBR=DXTOPER
CNTL //DXVAFIN  EXEC DBDGEN,MBR=DXVAFIN
CNTL //DXVAIMP  EXEC DBDGEN,MBR=DXVAIMP
CNTL //DXVATAR  EXEC DBDGEN,MBR=DXVATAR
CNTL //DXVCUMP  EXEC DBDGEN,MBR=DXVCUMP
CNTL //DXVTX06  EXEC DBDGEN,MBR=DXVTX06
CNTL //DYBOBBO  EXEC DBDGEN,MBR=DYBOBBO
CNTL //DYCCTAS  EXEC DBDGEN,MBR=DYCCTAS
CNTL //DYCLIEN  EXEC DBDGEN,MBR=DYCLIEN
CNTL //DYENTIA  EXEC DBDGEN,MBR=DYENTIA
CNTL //DYFECOL  EXEC DBDGEN,MBR=DYFECOL
CNTL //DYODDIA  EXEC DBDGEN,MBR=DYODDIA
CNTL //DYOPERA  EXEC DBDGEN,MBR=DYOPERA
CNTL //DYOPERB  EXEC DBDGEN,MBR=DYOPERB
CNTL //DYOPERC  EXEC DBDGEN,MBR=DYOPERC
CNTL //DYVALAN  EXEC DBDGEN,MBR=DYVALAN
CNTL //DYVCUMP  EXEC DBDGEN,MBR=DYVCUMP
CNTL //DZCCTAS  EXEC DBDGEN,MBR=DZCCTAS
CNTL //DZODDIA  EXEC DBDGEN,MBR=DZODDIA
CNTL //DZTOPER  EXEC DBDGEN,MBR=DZTOPER
CNTL //DZVALOR  EXEC DBDGEN,MBR=DZVALOR
CNTL //DZVCUMP  EXEC DBDGEN,MBR=DZVCUMP
CNTL MEMBER NAME  C$PSB
CNTL //C$PSB    JOB MOVE,'PSBGEN',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*--------------------------------------------------< VARIABLES   >---
CNTL // SET SRCELIB=CECABANK.PDS.PSB
CNTL // SET LOADLIB=CECABANK.PDS.PSBLIB
CNTL //*--------------------------------------------------< COMPILATION >---
CNTL //PSBGEN   PROC MBR=
CNTL //C        EXEC PGM=ASMA90,REGION=0M,
CNTL //            PARM=(OBJECT,NODECK,NODBCS,'SIZE(MAX,ABOVE)')
CNTL //SYSIN    DD DISP=SHR,DSN=&SRCELIB(&MBR)
CNTL //SYSLIB   DD DSN=IMS1010.SDFSMAC,DISP=SHR
CNTL //SYSLIN   DD UNIT=SYSDA,DISP=(,PASS),
CNTL //            SPACE=(80,(100,100),RLSE),
CNTL //            DCB=(BLKSIZE=80,RECFM=F,LRECL=80)
CNTL //SYSPRINT DD SYSOUT=*,DCB=BLKSIZE=1089,
CNTL //            SPACE=(121,(300,300),RLSE,,ROUND)
CNTL //SYSUT1   DD UNIT=SYSDA,DISP=(,DELETE),
CNTL //            SPACE=(CYL,(10,5))
CNTL //*--------------------------------------------------< LINK EDIT   >---
CNTL //L        EXEC PGM=IEWL,PARM='XREF,LIST',
CNTL //            COND=(0,LT,C),REGION=4M
CNTL //SYSLIN   DD DSN=*.C.SYSLIN,DISP=(OLD,DELETE)
CNTL //SYSPRINT DD SYSOUT=*,DCB=BLKSIZE=1089,
CNTL //         SPACE=(121,(90,90),RLSE)
CNTL //SYSLMOD  DD DISP=SHR,DSN=&LOADLIB(&MBR)
CNTL //SYSUT1   DD UNIT=(SYSDA,SEP=(SYSLMOD,SYSLIN)),
CNTL //         SPACE=(1024,(100,10),RLSE),DISP=(,DELETE)
CNTL // PEND
CNTL //*---------------------------------------------------------------------
CNTL //PBOFANUL EXEC PSBGEN,MBR=PBOFANUL
CNTL //PBO9LCOM EXEC PSBGEN,MBR=PBO9LCOM
CNTL //
CNTL //PBOECOCU EXEC PSBGEN,MBR=PBOECOCU
CNTL //PBOEOPCU EXEC PSBGEN,MBR=PBOEOPCU
CNTL //PBOFANOR EXEC PSBGEN,MBR=PBOFANOR
CNTL //PBOFANUL EXEC PSBGEN,MBR=PBOFANUL
CNTL //PBOFAPJV EXEC PSBGEN,MBR=PBOFAPJV
CNTL //PBOFCD01 EXEC PSBGEN,MBR=PBOFCD01
CNTL //PBOFCD04 EXEC PSBGEN,MBR=PBOFCD04
CNTL //PBOFCENR EXEC PSBGEN,MBR=PBOFCENR
CNTL //PBOFCHLI EXEC PSBGEN,MBR=PBOFCHLI
CNTL //PBOFIDSC EXEC PSBGEN,MBR=PBOFIDSC
CNTL //PBOFMBBO EXEC PSBGEN,MBR=PBOFMBBO
CNTL //PBOFMIBO EXEC PSBGEN,MBR=PBOFMIBO
CNTL //PBOFMOBO EXEC PSBGEN,MBR=PBOFMOBO
CNTL //PBOFM14O EXEC PSBGEN,MBR=PBOFM14O
CNTL //PBOFOENR EXEC PSBGEN,MBR=PBOFOENR
CNTL //PBOFOPPC EXEC PSBGEN,MBR=PBOFOPPC
CNTL //PBOFRCAC EXEC PSBGEN,MBR=PBOFRCAC
CNTL //PBOFREIB EXEC PSBGEN,MBR=PBOFREIB
CNTL //PBOFSI1C EXEC PSBGEN,MBR=PBOFSI1C
CNTL //PBOFSI3C EXEC PSBGEN,MBR=PBOFSI3C
CNTL //PBOFTDES EXEC PSBGEN,MBR=PBOFTDES
CNTL //PBOGANFI EXEC PSBGEN,MBR=PBOGANFI
CNTL //PBOGCLIQ EXEC PSBGEN,MBR=PBOGCLIQ
CNTL //PBOGLIPE EXEC PSBGEN,MBR=PBOGLIPE
CNTL //PBOGOPPL EXEC PSBGEN,MBR=PBOGOPPL
CNTL //PBOHCOLI EXEC PSBGEN,MBR=PBOHCOLI
CNTL //PBOHLIPE EXEC PSBGEN,MBR=PBOHLIPE
CNTL //PBOHLLIC EXEC PSBGEN,MBR=PBOHLLIC
CNTL //PBOHNSCL EXEC PSBGEN,MBR=PBOHNSCL
CNTL //PBOHOINC EXEC PSBGEN,MBR=PBOHOINC
CNTL //PBOIAPNU EXEC PSBGEN,MBR=PBOIAPNU
CNTL //PBOIAPSA EXEC PSBGEN,MBR=PBOIAPSA
CNTL //PBOIBOPA EXEC PSBGEN,MBR=PBOIBOPA
CNTL //PBOIDM14 EXEC PSBGEN,MBR=PBOIDM14
CNTL //PBOIGJOV EXEC PSBGEN,MBR=PBOIGJOV
CNTL //PBOIGLIQ EXEC PSBGEN,MBR=PBOIGLIQ
CNTL //PBOIOCPL EXEC PSBGEN,MBR=PBOIOCPL
CNTL //PBO1MCUM EXEC PSBGEN,MBR=PBO1MCUM
CNTL //PBO5GCRE EXEC PSBGEN,MBR=PBO5GCRE
CNTL //PBO9LCOM EXEC PSBGEN,MBR=PBO9LCOM
CNTL //PBO9LCVB EXEC PSBGEN,MBR=PBO9LCVB
CNTL //PBO9LIST EXEC PSBGEN,MBR=PBO9LIST
CNTL //PBO9LNOT EXEC PSBGEN,MBR=PBO9LNOT
CNTL //PBO9LVEI EXEC PSBGEN,MBR=PBO9LVEI
CNTL //PIFGCEOP EXEC PSBGEN,MBR=PIFGCEOP
CNTL //PIFGCNMV EXEC PSBGEN,MBR=PIFGCNMV
CNTL //PIN5GOPB EXEC PSBGEN,MBR=PIN5GOPB
CNTL //PIN7LCOB EXEC PSBGEN,MBR=PIN7LCOB
CNTL //PIN7LOPB EXEC PSBGEN,MBR=PIN7LOPB
CNTL //PIN8LCOB EXEC PSBGEN,MBR=PIN8LCOB
CNTL //PIN8LOPB EXEC PSBGEN,MBR=PIN8LOPB
CNTL //PIN9GOPB EXEC PSBGEN,MBR=PIN9GOPB
CNTL //PIVAL002 EXEC PSBGEN,MBR=PIVAL002
CNTL //PIVAL029 EXEC PSBGEN,MBR=PIVAL029
CNTL //PVAIECOG EXEC PSBGEN,MBR=PVAIECOG
CNTL //PVAIECOI EXEC PSBGEN,MBR=PVAIECOI
CNTL //PVAIECOR EXEC PSBGEN,MBR=PVAIECOR
CNTL //PVAOPE01 EXEC PSBGEN,MBR=PVAOPE01
CNTL //TBO1CAOR EXEC PSBGEN,MBR=TBO1CAOR
CNTL //TBO1COCU EXEC PSBGEN,MBR=TBO1COCU
CNTL MEMBER NAME  $SUB
CNTL //* PROC POUR SOUMETTRE UN JCL DANS L'INTERNAL READER
CNTL //SUB      PROC MBR=,BIB=MSOL.PDS.JCL
CNTL //SUBSTEP  EXEC PGM=IEBGENER
CNTL //SYSUT1   DD DISP=SHR,DSN=&BIB(&MBR)
CNTL //SYSUT2   DD SYSOUT=(A,INTRDR)
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SYSPRINT DD SYSOUT=*
CNTL // PEND
CNTL MEMBER NAME  C$C
CNTL //C$C      JOB MOVE,'COMPIL C',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //* EXEMPLE DE JCL DANS CBC.SCCNPRC
CNTL //*--------------------------------------------------< VARIABLES   >---
CNTL // SET SRCELIB=MSOL.PDS.COBOL
CNTL // SET LOADLIB=MSOL.PDS.LOAD
CNTL //*--------------------------------------------------< COMPILATION >---
CNTL //CC       PROC MBR=
CNTL //COMPILE  EXEC PGM=CCNDRVR,REGION=0M,
CNTL //    PARM='/SEARCH(''CEE.SCEEH.+'') NOOPT SO OBJ LIS XR LO'
CNTL //*USERLIB DD DSNAME=METAL.MALIB.H,DISP=SHR
CNTL //STEPLIB  DD DISP=SHR,DSNAME=CEE.SCEERUN
CNTL //         DD DISP=SHR,DSNAME=CEE.SCEERUN2
CNTL //*        DD DSNAME=SYSM.CBC.SCCNCMP,DISP=SHR
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SYSCPRT  DD SYSOUT=*
CNTL //SYSIN    DD DISP=SHR,DSN=&SRCELIB(&MBR)
CNTL //SYSLIN   DD DISP=(,PASS),DSN=&&LOADSET,
CNTL //         DCB=(RECFM=FB,LRECL=80,BLKSIZE=8000),
CNTL //         UNIT=SYSDA,SPACE=(TRK,(0,50),RLSE)
CNTL //*--------------------------------------------------< LINK EDIT   >---
CNTL //LKED     EXEC PGM=IEWL,
CNTL //         PARM='LIST,XREF,LET,MAP,AMODE(31),RMODE(ANY)'
CNTL //SYSLIB   DD DISP=SHR,DSN=CEE.SCEELKEX
CNTL //         DD DISP=SHR,DSN=TCPIP.SEZACMTX
CNTL //         DD DISP=SHR,DSN=CEE.SCEELKED
CNTL //         DD DISP=SHR,DSN=CEE.SCEECPP
CNTL //         DD DISP=SHR,DSN=SYS1.CSSLIB
CNTL //         DD DISP=SHR,DSN=GDDM.SADMMOD
CNTL //SYSLIN   DD DSNAME=&&LOADSET,DISP=(OLD,DELETE)
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSUDUMP DD SYSOUT=D,HOLD=YES
CNTL //SYSUT1   DD SPACE=(1024,(50,50)),UNIT=SYSDA
CNTL //SYSLMOD  DD DISP=SHR,DSN=&LOADLIB(&MBR)
CNTL // PEND
CNTL //*---------------------------------------------------------------------
CNTL //HELLOC   EXEC CC,MBR=HELLOC
CNTL MEMBER NAME  IEHLIST
CNTL //IEHLIST  JOB MOVE,'IEHLIST',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*---------------------------------------------------------------------
CNTL //* RECUPERE UN FICHIER CONTENANT LA LISTE DES MEMBRES D'UN PDS
CNTL //*---------------------------------------------------------------------
CNTL // SET SEQ=MSOL.LSTMBR NOM DU FICHIER DE SORTIE
CNTL //*---------------------------------------------------------------------
CNTL //DELETE   EXEC PGM=IEFBR14
CNTL //F0001    DD DSN=&SEQ,
CNTL //         DISP=(MOD,DELETE),SPACE=(TRK,0)
CNTL //*---------------------------------------------------------------------
CNTL //S0010    EXEC PGM=IEHLIST
CNTL //SYSPRINT DD DISP=(,PASS),DSN=&&LSTMBR,
CNTL //         DCB=(RECFM=FBA,LRECL=121,BLKSIZE=0),
CNTL //         UNIT=SYSDA,SPACE=(CYL,(1,1))
CNTL //VOL      DD DISP=OLD,UNIT=3390,VOL=SER=USR001
CNTL //SYSIN    DD *
CNTL   LISTPDS DSNAME=CECABANK.PDS.LOAD,VOL=3390=USR001
CNTL //*---------------------------------------------------------------------
CNTL //S0020    EXEC PGM=SORT
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SORTIN   DD DISP=(OLD,DELETE),DSN=&&LSTMBR
CNTL //SORTOUT  DD DISP=(NEW,CATLG),DSN=&SEQ,
CNTL //         DCB=(RECFM=FB,LRECL=8,BLKSIZE=8000),
CNTL //         VOL=SER=MSOL01,SPACE=(CYL,(1,1))
CNTL //SYSIN    DD *
CNTL   OPTION COPY,SKIPREC=5
CNTL   OUTREC FIELDS=(12,8)
CNTL   INCLUDE COND=(33,10,CH,NE,C'----OF THE')
CNTL MEMBER NAME  $$IMS
CNTL //IMS$INIT JOB MOVE,'TEST INIT IMS DB',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //********************************************************************
CNTL //*   CREATION DES BASES DE TEST D1 D2 D3 IMS                        *
CNTL //********************************************************************
CNTL //DBDGEN  PROC MBR=TEMPNAME
CNTL //C       EXEC PGM=ASMA90,REGION=0M,PARM='OBJECT,NODECK,NODBCS'
CNTL //SYSLIB    DD DISP=SHR,DSN=IMS1010.SDFSMAC
CNTL //SYSLIN    DD UNIT=SYSALLDA,DISP=(,PASS),
CNTL //             SPACE=(80,(100,100),RLSE),
CNTL //             DCB=(BLKSIZE=80,RECFM=F,LRECL=80)
CNTL //SYSPRINT  DD SYSOUT=*,DCB=BLKSIZE=1089,
CNTL //             SPACE=(121,(300,300),RLSE,,ROUND)
CNTL //SYSUT1    DD UNIT=SYSALLDA,DISP=(,DELETE),
CNTL //             SPACE=(CYL,(10,5))
CNTL //SYSIN     DD DISP=SHR,DSN=FMN810.SFMNSAM1(FMN1&MBR)
CNTL //*------------------------------------------------------------------*
CNTL //L       EXEC PGM=IEWL,PARM='XREF,LIST',
CNTL //             COND=(0,LT,C),REGION=0K
CNTL //SYSLIN    DD DSN=*.C.SYSLIN,DISP=(OLD,DELETE)
CNTL //SYSPRINT  DD SYSOUT=*,DCB=BLKSIZE=1089,
CNTL //             SPACE=(121,(90,90),RLSE)
CNTL //SYSLMOD   DD DISP=SHR,DSN=MSOL.IMSTEST.DBDLIB(D&MBR)
CNTL //SYSUT1    DD UNIT=(SYSALLDA,SEP=(SYSLMOD,SYSLIN)),
CNTL //             SPACE=(1024,(100,10),RLSE),DISP=(,DELETE)
CNTL //        PEND
CNTL //********************************************************************
CNTL //PSBGEN  PROC MBR=TEMPNAME
CNTL //C       EXEC PGM=ASMA90,REGION=0M,PARM='OBJECT,NODECK,NODBCS'
CNTL //SYSLIB    DD DISP=SHR,DSN=IMS1010.SDFSMAC
CNTL //SYSLIN    DD UNIT=SYSALLDA,DISP=(,PASS),
CNTL //             SPACE=(80,(100,100),RLSE),
CNTL //             DCB=(BLKSIZE=80,RECFM=F,LRECL=80)
CNTL //SYSPRINT  DD SYSOUT=*,DCB=BLKSIZE=1089,
CNTL //             SPACE=(121,(300,300),RLSE,,ROUND)
CNTL //SYSUT1    DD UNIT=SYSALLDA,DISP=(,DELETE),
CNTL //             SPACE=(CYL,(10,5))
CNTL //SYSIN     DD DISP=SHR,DSN=FMN810.SFMNSAM1(FMN1&MBR)
CNTL //*------------------------------------------------------------------*
CNTL //L       EXEC PGM=IEWL,PARM='XREF,LIST',
CNTL //             COND=(0,LT,C),REGION=0K
CNTL //SYSLIN    DD DSN=*.C.SYSLIN,DISP=(OLD,DELETE)
CNTL //SYSPRINT  DD SYSOUT=*,DCB=BLKSIZE=1089,
CNTL //             SPACE=(121,(90,90),RLSE)
CNTL //SYSLMOD   DD DISP=SHR,DSN=MSOL.IMSTEST.PSBLIB(P&MBR)
CNTL //SYSUT1    DD UNIT=(SYSALLDA,SEP=(SYSLMOD,SYSLIN)),
CNTL //             SPACE=(1024,(100,10),RLSE),DISP=(,DELETE)
CNTL //        PEND
CNTL //********************************************************************
CNTL //ASSEM  PROC MBR=TEMPNAME
CNTL //C      EXEC PGM=ASMA90,PARM='OBJECT,NODECK'
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSLIB   DD DISP=SHR,DSN=IMS1010.SDFSMAC
CNTL //*        DD DISP=SHR,DSN=IMS1010.GENLIBA
CNTL //*        DD DISP=SHR,DSN=IMS1010.GENLIBB
CNTL //         DD DISP=SHR,DSN=SYS1.MACLIB
CNTL //SYSLIN   DD UNIT=3390,DISP=(,PASS,DELETE),SPACE=(CYL,(1,1)),
CNTL //            DCB=(RECFM=F,LRECL=80,BLKSIZE=80)
CNTL //SYSUT1   DD UNIT=3390,DISP=(,DELETE,DELETE),SPACE=(CYL,(1,1))
CNTL //SYSUT2   DD UNIT=3390,DISP=(,DELETE,DELETE),SPACE=(CYL,(1,1))
CNTL //SYSUT3   DD UNIT=(3390,SEP=(SYSLIB,SYSUT1,SYSUT2)),
CNTL //            DISP=(,DELETE,DELETE),SPACE=(CYL,(1,1))
CNTL //SYSIN    DD DISP=SHR,DSN=FMN810.SFMNSAM1(FMN1&MBR.A)
CNTL //*------------------------------------------------------------------*
CNTL //L      EXEC PGM=IEWL,
CNTL //         PARM='XREF,LIST',COND=(0,LT,C)
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSLIN   DD DISP=(OLD,DELETE,DELETE),
CNTL //            DSN=*.C.SYSLIN,VOL=REF=*.C.SYSLIN
CNTL //         DD DDNAME=SYSIN
CNTL //RESLIB   DD DISP=SHR,DSN=IMS1010.SDFSRESL
CNTL //SYSLMOD  DD DISP=SHR,DSN=MSOL.IMSTEST.LOADLIB
CNTL //SYSUT1   DD UNIT=(3390,SEP=(SYSLMOD,SYSLIN)),
CNTL //            DISP=(,DELETE,DELETE),SPACE=(CYL,(1,1))
CNTL //SYSIN    DD DISP=SHR,DSN=FMN810.SFMNSAM1(FMN1&MBR.B)
CNTL //       PEND
CNTL //********************************************************************
CNTL //DBLOAD  PROC DB=
CNTL //LOAD    EXEC PGM=DFSRRC00,PARM='DLI,P&DB.A,P&DB.C,,,,,,,,,,,N,N'
CNTL //STEPLIB   DD DISP=SHR,DSN=IMS1010.SDFSRESL
CNTL //          DD DISP=SHR,DSN=MSOL.IMSTEST.LOADLIB
CNTL //DFSRESLB  DD DISP=SHR,DSN=IMS1010.SDFSRESL
CNTL //IMS       DD DISP=SHR,DSN=MSOL.IMSTEST.DBDLIB
CNTL //          DD DISP=SHR,DSN=MSOL.IMSTEST.PSBLIB
CNTL //PROCLIB   DD DISP=SHR,DSN=IMS1010.PROCLIB
CNTL //SYSOUT    DD SYSOUT=*
CNTL //SYSPRINT  DD SYSOUT=*
CNTL //IEFRDER   DD DUMMY
CNTL //DFSURWF1  DD DSN=MSOL.IMSTEST.DFSURF1.D&DB.E,DISP=(,CATLG),
CNTL //             DCB=(BLKSIZE=1008,LRECL=900,RECFM=VB),
CNTL //             VOL=SER=MSOL01,SPACE=(CYL,(2,2),RLSE),UNIT=3390
CNTL //DFSURCDS  DD DISP=SHR,DSN=MSOL.IMSTEST.RLCDS
CNTL //DFSVSAMP  DD DISP=SHR,DSN=FMN810.SFMNSAM1(FMN1IVPB)
CNTL //DFSCTL    DD DISP=SHR,DSN=FMN810.SFMNSAM1(FMN1IVPA)
CNTL //DATAIN    DD DISP=SHR,DSN=FMN810.SFMNSAM1(FMN1&DB.D)
CNTL // PEND
CNTL //********************************************************************
CNTL //*  Step  1: Allocate all Datasets neccessary for the IVP           *
CNTL //********************************************************************
CNTL //CLOUT   EXEC PGM=IDCAMS,COND=(0,NE)
CNTL //SYSPRINT  DD SYSOUT=*
CNTL //SYSIN     DD *
CNTL   DELETE MSOL.IMSTEST.DB.DJ1E       NONVSAM SCRATCH
CNTL   DELETE MSOL.IMSTEST.DB.DJ1F       CLUSTER PURGE
CNTL   DELETE MSOL.IMSTEST.DFSURF1.DJ1E  NONVSAM SCRATCH
CNTL
CNTL   DELETE MSOL.IMSTEST.DB.DJ2E       CLUSTER PURGE
CNTL   DELETE MSOL.IMSTEST.DB.DJ2F       CLUSTER PURGE
CNTL   DELETE MSOL.IMSTEST.DFSURF1.DJ2E  NONVSAM SCRATCH
CNTL
CNTL   DELETE MSOL.IMSTEST.DB.DJ3E       NONVSAM SCRATCH
CNTL   DELETE MSOL.IMSTEST.DB.DJ3F       CLUSTER PURGE
CNTL   DELETE MSOL.IMSTEST.DFSURF1.DJ3E  NONVSAM SCRATCH
CNTL
CNTL   DELETE MSOL.IMSTEST.RLCDS         NONVSAM SCRATCH
CNTL   DELETE MSOL.IMSTEST.DFSURF3       NONVSAM SCRATCH
CNTL   DELETE MSOL.IMSTEST.DFSURIDX      NONVSAM SCRATCH
CNTL   DELETE MSOL.IMSTEST.OUTIDX1       NONVSAM SCRATCH
CNTL
CNTL   DELETE MSOL.IMSTEST.LOADLIB       NONVSAM SCRATCH
CNTL   DELETE MSOL.IMSTEST.DBDLIB        NONVSAM SCRATCH
CNTL   DELETE MSOL.IMSTEST.PSBLIB        NONVSAM SCRATCH
CNTL
CNTL   SET MAXCC=0
CNTL /*
CNTL //********************************************************************
CNTL //CLDEF   EXEC PGM=IDCAMS,COND=(0,NE)
CNTL //SYSPRINT  DD SYSOUT=*
CNTL //SYSIN     DD *
CNTL  /* DATABASE J1 : ACCESS=(HIDAM,OSAM) */
CNTL           /* ALLOCATE OSAM */
CNTL   ALLOC   DSN('MSOL.IMSTEST.DB.DJ1E')                        -
CNTL               RECFM(F,B,S)    LRECL(4096)  BLKSIZE(4096)     -
CNTL               DSORG(PS)       NEW CATALOG  SPACE(1 1)  TRACK -
CNTL               VOL(MSOL01)     UNIT(3390)
CNTL
CNTL           /* ALLOCATE HIDAM */
CNTL   DEFINE  CL (NAME (MSOL.IMSTEST.DB.DJ1F)                    -
CNTL               IXD KEYS(20 5)  RECSZ(26,26)                   -
CNTL               TRK(1,1)        VOL(MSOL01)  FSPC(10,10)       -
CNTL               REUSE           SHR(3,3)     SPEED)            -
CNTL           DATA (CISZ(1024))
CNTL
CNTL  /* DATABASE J2 : ACCESS=(HIDAM,VSAM) */
CNTL           /* ALLOCATE VSAM */
CNTL   DEFINE  CL (NAME (MSOL.IMSTEST.DB.DJ2E)                    -
CNTL               NIXD            RECSZ(2041 2041)               -
CNTL               TRK(1,1)        VOL(MSOL01)  FSPC(10,10)       -
CNTL               REUSE           SHR(3,3)     SPEED        CISZ(2048))
CNTL           /* ALLOCATE HIDAM */
CNTL   DEFINE  CL (NAME (MSOL.IMSTEST.DB.DJ2F)                    -
CNTL               IXD KEYS(18 5)  RECSZ(24,24)                   -
CNTL               TRK(1,1)        VOL(MSOL01)  FSPC(10,10)       -
CNTL               REUSE           SHR(3,3)     SPEED)            -
CNTL           DATA (CISZ(1024))
CNTL
CNTL  /* DATABASE J3 : ACCESS=(HDAM,OSAM) */
CNTL           /* ALLOCATE OSAM DATASETS */
CNTL   ALLOC   DSN('MSOL.IMSTEST.DB.DJ3E')                        -
CNTL               RECFM(F,B,S)    LRECL(4096)  BLKSIZE(4096)     -
CNTL               DSORG(PS)       NEW CATALOG  SPACE(1 1)  CYL   -
CNTL               VOL(MSOL01)     UNIT(3390)
CNTL           /* ALLOCATE HDAM DATASETS */
CNTL   DEFINE  CL (NAME (MSOL.IMSTEST.DB.DJ3F)                    -
CNTL               IXD KEYS (28 1) RECSZ(58,58)                   -
CNTL               TRK(6,1)        VOL(MSOL01)  FSPC(10,10)       -
CNTL               REUSE           SHR(3,3)     SPEED)            -
CNTL           DATA (CISZ(2048))
CNTL
CNTL /*
CNTL //********************************************************************
CNTL //*       ALLOCATE PARTITIONED DATASETS                              *
CNTL //********************************************************************
CNTL //ALLOC8  EXEC PGM=IEFBR14,COND=(0,NE)
CNTL //LOADLIB   DD DSN=MSOL.IMSTEST.LOADLIB,
CNTL //             VOL=SER=MSOL01,DISP=(,CATLG),
CNTL //             DCB=(RECFM=U,BLKSIZE=6144),
CNTL //             UNIT=3390,SPACE=(TRK,(5,1,20))
CNTL //DBDLIB    DD DSN=MSOL.IMSTEST.DBDLIB,
CNTL //             VOL=SER=MSOL01,DISP=(,CATLG),
CNTL //             DCB=(RECFM=U,BLKSIZE=6144),
CNTL //             UNIT=3390,SPACE=(TRK,(5,1,20))
CNTL //PSB1IB    DD DSN=MSOL.IMSTEST.PSBLIB,
CNTL //             VOL=SER=MSOL01,DISP=(,CATLG),
CNTL //             DCB=(RECFM=U,BLKSIZE=6144),
CNTL //             UNIT=3390,SPACE=(TRK,(5,1,20))
CNTL //********************************************************************
CNTL //*  Step  1: Assemble load programs                                 *
CNTL //********************************************************************
CNTL //PJ1A    EXEC PROC=ASSEM,MBR=J1
CNTL //PJ2A    EXEC PROC=ASSEM,MBR=J2
CNTL //PJ3A    EXEC PROC=ASSEM,MBR=J3
CNTL //********************************************************************
CNTL //*  Step  2: DBDGEN                                                 *
CNTL //********************************************************************
CNTL //DJ1E    EXEC PROC=DBDGEN,MBR=J1E
CNTL //DJ1F    EXEC PROC=DBDGEN,MBR=J1F
CNTL //DJ1G    EXEC PROC=DBDGEN,MBR=J1G
CNTL //DJ2E    EXEC PROC=DBDGEN,MBR=J2E
CNTL //DJ2F    EXEC PROC=DBDGEN,MBR=J2F
CNTL //DJ2G    EXEC PROC=DBDGEN,MBR=J2G
CNTL //DJ3E    EXEC PROC=DBDGEN,MBR=J3E
CNTL //DJ3F    EXEC PROC=DBDGEN,MBR=J3F
CNTL //DJ3G    EXEC PROC=DBDGEN,MBR=J3G
CNTL //********************************************************************
CNTL //*  Step  3: PSBGEN                                                 *
CNTL //********************************************************************
CNTL //PUPA    EXEC PROC=PSBGEN,MBR=UPA
CNTL //PUPG    EXEC PROC=PSBGEN,MBR=UPG
CNTL //PUPP    EXEC PROC=PSBGEN,MBR=UPP
CNTL //PUPR    EXEC PROC=PSBGEN,MBR=UPR
CNTL //PJ1C    EXEC PROC=PSBGEN,MBR=J1C
CNTL //PJ2C    EXEC PROC=PSBGEN,MBR=J2C
CNTL //PJ3C    EXEC PROC=PSBGEN,MBR=J3C
CNTL //********************************************************************
CNTL //*  Step  5: DFSURPR0 - Pre-reorg utility,                          *
CNTL //*           Preparation for the resolve of Logical Relationship    *
CNTL //*           and Secondary Indexes                                  *
CNTL //********************************************************************
CNTL //PREREO  EXEC PGM=DFSRRC00,PARM='ULU,DFSURPR0',COND=(0,NE)
CNTL //STEPLIB   DD DISP=SHR,DSN=IMS1010.SDFSRESL
CNTL //DFSRESLB  DD DISP=SHR,DSN=IMS1010.SDFSRESL
CNTL //IMS       DD DISP=SHR,DSN=MSOL.IMSTEST.DBDLIB
CNTL //SYSPRINT  DD SYSOUT=*,DCB=BLKSIZE=1200
CNTL //DFSURCDS  DD DSN=MSOL.IMSTEST.RLCDS,DISP=(,CATLG),
CNTL //             UNIT=3390,VOL=SER=MSOL01,DCB=(BLKSIZE=1600),
CNTL //             SPACE=(CYL,1)
CNTL //SYSIN     DD *,DCB=BLKSIZE=80
CNTL DBIL=DJ1E
CNTL DBIL=DJ2E
CNTL DBIL=DJ3E
CNTL /*
CNTL //********************************************************************
CNTL //*  STEP  6: DBLOAD - Load DJ1E, DJ2E, DJ3E Databases               *
CNTL //********************************************************************
CNTL //J1LOAD  EXEC DBLOAD,DB=J1,COND=(0,NE)
CNTL //DJ1E      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ1E
CNTL //DJ1F      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ1F
CNTL //*-------------------------------------------------------------------
CNTL //J2LOAD  EXEC DBLOAD,DB=J2,COND=(0,NE)
CNTL //DJ2E      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ2E
CNTL //DJ2F      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ2F
CNTL //*-------------------------------------------------------------------
CNTL //J3LOAD  EXEC DBLOAD,DB=J3,COND=(0,NE)
CNTL //DJ3E      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ3E
CNTL //DJ3F      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ3F
CNTL //********************************************************************
CNTL //*  STEP  7: DFSURG10 - PREFIX RESOLUTION                           *
CNTL //*           DFSURWF3 is used as input to the Prefix Update Utility *
CNTL //*           DFSURIDX is used to build a Secondary Index by running *
CNTL //*           the HISAM Unload/Reload Utilities                      *
CNTL //********************************************************************
CNTL //PREFRES EXEC PGM=DFSURG10,COND=(0,NE)
CNTL //STEPLIB   DD DISP=SHR,DSN=IMS1010.SDFSRESL
CNTL //IMS       DD DISP=SHR,DSN=MSOL.IMSTEST.DBDLIB
CNTL //SYSUDUMP  DD SYSOUT=*
CNTL //SYSPRINT  DD SYSOUT=*,DCB=BLKSIZE=1200
CNTL //SYSOUT    DD SYSOUT=*
CNTL //SORTLIB   DD DISP=SHR,DSN=SYS1.SORTLIB
CNTL //SORTWK01  DD UNIT=SYSALLDA,SPACE=(CYL,5,,CONTIG)
CNTL //SORTIN    DD DISP=SHR,DSN=MSOL.IMSTEST.DFSURF1.DJ1E
CNTL //          DD DISP=SHR,DSN=MSOL.IMSTEST.DFSURF1.DJ2E
CNTL //          DD DISP=SHR,DSN=MSOL.IMSTEST.DFSURF1.DJ3E
CNTL //DFSURWF2  DD DSN=&&WF2,DISP=(,PASS),
CNTL //             DCB=(RECFM=VB,LRECL=900,BLKSIZE=1008),UNIT=3390,
CNTL //             VOL=SER=MSOL01,SPACE=(CYL,(5,2),,CONTIG)
CNTL //DFSURWF3  DD DSN=MSOL.IMSTEST.DFSURF3,DISP=(,CATLG),
CNTL //             DCB=(RECFM=VB,LRECL=900,BLKSIZE=1008),UNIT=3390,
CNTL //             VOL=SER=MSOL01,SPACE=(CYL,(5,2),RLSE,CONTIG)
CNTL //DFSURIDX  DD DSN=MSOL.IMSTEST.DFSURIDX,DISP=(,CATLG),
CNTL //             DCB=(RECFM=VB,LRECL=900,BLKSIZE=1008),UNIT=3390,
CNTL //             VOL=SER=MSOL01,SPACE=(CYL,(5,2),RLSE,CONTIG)
CNTL //DFSURCDS  DD DISP=SHR,DSN=MSOL.IMSTEST.RLCDS
CNTL //DJ1E      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ1E
CNTL //DJ1F      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ1F
CNTL //DJ2E      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ2E
CNTL //DJ2F      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ2F
CNTL //DJ3E      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ3E
CNTL //DJ3F      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ3F
CNTL //********************************************************************
CNTL //*  Step  8: DFSURGP0 - Prefix Update                               *
CNTL //*           Update the Logical Relationship Pointers               *
CNTL //********************************************************************
CNTL //PREFUPD EXEC PGM=DFSRRC00,PARM='ULU,DFSURGP0,,,1,,,,,,,,,N,N',
CNTL //             COND=(0,NE)
CNTL //STEPLIB   DD DISP=SHR,DSN=IMS1010.SDFSRESL
CNTL //IMS       DD DISP=SHR,DSN=MSOL.IMSTEST.DBDLIB
CNTL //SYSPRINT  DD SYSOUT=*
CNTL //SYSOUT    DD SYSOUT=*
CNTL //SYSUDUMP  DD SYSOUT=*
CNTL //DFSURWF3  DD DISP=SHR,DSN=MSOL.IMSTEST.DFSURF3
CNTL //DJ1E      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ1E
CNTL //DJ1F      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ1F
CNTL //DJ2E      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ2E
CNTL //DJ2F      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ2F
CNTL //DJ3E      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ3E
CNTL //DJ3F      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ3F
CNTL //DFSVSAMP  DD DISP=SHR,DSN=FMN810.SFMNSAM1(FMN1IVPB)
CNTL //********************************************************************
CNTL //*  Step  9: DFSURUL0 - HISAM Unload                                *
CNTL //*           Part 1 of Secondary Index creation.                    *
CNTL //*           Using work dataset passed from Prefix Resolution       *
CNTL //********************************************************************
CNTL //PREPIDX EXEC PGM=DFSRRC00,PARM='ULU,DFSURUL0,,,,,,,,,,,,N,N',
CNTL //             COND=(0,NE)
CNTL //STEPLIB   DD DISP=SHR,DSN=IMS1010.SDFSRESL
CNTL //IMS       DD DISP=SHR,DSN=MSOL.IMSTEST.DBDLIB
CNTL //SYSPRINT  DD SYSOUT=*,DCB=BLKSIZE=1330
CNTL //SYSOUT    DD SYSOUT=*
CNTL //DJ3E      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ3E
CNTL //DJ3F      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ3F
CNTL //OUTIDX1   DD DSN=MSOL.IMSTEST.OUTIDX1,DISP=(,CATLG),
CNTL //             UNIT=3390,VOL=SER=MSOL01,
CNTL //             SPACE=(CYL,(5,2),RLSE,CONTIG)
CNTL //DFSURIDX  DD DISP=SHR,DSN=MSOL.IMSTEST.DFSURIDX
CNTL //DFSVSAMP  DD DISP=SHR,DSN=FMN810.SFMNSAM1(FMN1IVPB)
CNTL //SYSIN     DD *
CNTL OPTIONS=(STAT)
CNTL X1MDJ3F     DJ3F     OUTIDX1           DFSURIDX  SECONDARY INDEX
CNTL /*
CNTL //********************************************************************
CNTL //*  Step 10: DFSURRL0 - HISAM Reload                                *
CNTL //*           Part 2 of Secondary Index creation.                    *
CNTL //*           Load Secondary Index                                   *
CNTL //********************************************************************
CNTL //CRE8IDX EXEC PGM=DFSRRC00,PARM='ULU,DFSURRL0,,,,,,,,,,,,N,N',
CNTL //             COND=(0,NE)
CNTL //STEPLIB   DD DISP=SHR,DSN=IMS1010.SDFSRESL
CNTL //IMS       DD DISP=SHR,DSN=MSOL.IMSTEST.DBDLIB
CNTL //SYSPRINT  DD SYSOUT=*,DCB=BLKSIZE=1330
CNTL //SYSOUT    DD SYSOUT=*
CNTL //DFSUIN01  DD DISP=SHR,DSN=MSOL.IMSTEST.OUTIDX1
CNTL //DJ3E      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ3E
CNTL //DJ3F      DD DISP=SHR,DSN=MSOL.IMSTEST.DB.DJ3F
CNTL //DFSVSAMP  DD DISP=SHR,DSN=FMN810.SFMNSAM1(FMN1IVPB)
CNTL //SYSIN     DD *
CNTL OPTIONS=(STAT)
CNTL /*
CNTL //********************************************************************
CNTL //*  Step 11: Cleanup work datasets                                  *
CNTL //********************************************************************
CNTL //CLEANUP EXEC PGM=IDCAMS,COND=(0,NE)
CNTL //SYSPRINT  DD SYSOUT=*
CNTL //SYSIN     DD *
CNTL   DELETE MSOL.IMSTEST.RLCDS         NONVSAM SCRATCH
CNTL   DELETE MSOL.IMSTEST.DFSURF1.DJ1E  NONVSAM SCRATCH
CNTL   DELETE MSOL.IMSTEST.DFSURF1.DJ2E  NONVSAM SCRATCH
CNTL   DELETE MSOL.IMSTEST.DFSURF1.DJ3E  NONVSAM SCRATCH
CNTL   DELETE MSOL.IMSTEST.DFSURF3       NONVSAM SCRATCH
CNTL   DELETE MSOL.IMSTEST.DFSURIDX      NONVSAM SCRATCH
CNTL   DELETE MSOL.IMSTEST.OUTIDX1       NONVSAM SCRATCH
CNTL /*
CNTL MEMBER NAME  C$BIND
CNTL //DB2$BIND JOB MOVE,'BIND DB2',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //********************************************************************
CNTL //*               BIND D'UN PROGRAMME COBOL DB2     CECABANK         *
CNTL //********************************************************************
CNTL //BIND     EXEC PGM=IKJEFT01,REGION=4096K
CNTL //STEPLIB  DD DISP=SHR,DSN=DSN910.SDSNLOAD
CNTL //         DD DISP=SHR,DSN=DSN910.DB9G.SDSNEXIT
CNTL //DBRMLIB  DD DISP=SHR,DSN=CECABANK.PDS.DBRMLIB(DB2TEST)
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSTSPRT DD SYSOUT=*
CNTL //SYSUDUMP DD SYSOUT=*
CNTL //SYSTSIN  DD *
CNTL  DSN SYSTEM (DB9G)
CNTL  BIND PLAN(DB2TEST) -
CNTL    QUAL(IBMUSER) -
CNTL    OWNER(IBMUSER) -
CNTL    MEM(DB2TEST) -
CNTL    LIB('CECABANK.PDS.DBRMLIB') -
CNTL    NODEFER(PREPARE) -
CNTL    VALID(R) -
CNTL    ISOL(CS) -
CNTL    CACHE(3072) -
CNTL    ACQ(U) -
CNTL    REL(C) -
CNTL    EXPL(N) -
CNTL    CURRENTD(N) -
CNTL    ACTION(REPLACE) -
CNTL    RETAIN -
CNTL    DEGREE(1) -
CNTL    SQLR(D) -
CNTL    DISC(E) -
CNTL    KEEPDYNAMIC(N) -
CNTL    REOPT(NONE) -
CNTL    DBPROTOCOL(D) -
CNTL    ENCODING(1047) -
CNTL    IMMEDWRITE(N)
CNTL  END;
CNTL MEMBER NAME  C$DLI
CNTL //C$COBDLI JOB MOVE,'COMPIL DLI',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*--------------------------------------------------< VARIABLES   >---
CNTL // SET SRCELIB=CECABANK.PDS.COBOL
CNTL // SET LOADLIB=CECABANK.PDS.LOAD
CNTL // SET COPYLIB=CECABANK.PDS.COPY
CNTL //*--------------------------------------------------< COMPILATION >---
CNTL //COBDLI   PROC MBR=
CNTL //C        EXEC PGM=IGYCRCTL,REGION=0M,
CNTL //   PARM=(NOSEQUENCE,APOST,RENT,'PGMNAME(LONGUPPER)',LIB,CICS,SQL,
CNTL //   'ARITH(EXTEND)',NUM,'OPTIMIZE(STD)')
CNTL //STEPLIB  DD DISP=SHR,DSN=IGY410.SIGYCOMP
CNTL //SYSIN    DD DISP=SHR,DSN=&SRCELIB(&MBR)
CNTL //SYSLIB   DD DISP=SHR,DSN=&COPYLIB
CNTL //         DD DISP=SHR,DSN=MSOL.PDS.COPY
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SYSUT1   DD UNIT=SYSDA,SPACE=(CYL,(1,1))
CNTL //SYSUT2   DD UNIT=SYSDA,SPACE=(CYL,(1,1))
CNTL //SYSUT3   DD UNIT=SYSDA,SPACE=(CYL,(1,1))
CNTL //SYSUT4   DD UNIT=SYSDA,SPACE=(CYL,(1,1))
CNTL //SYSUT5   DD UNIT=SYSDA,SPACE=(CYL,(1,1))
CNTL //SYSUT6   DD UNIT=SYSDA,SPACE=(CYL,(1,1))
CNTL //SYSUT7   DD UNIT=SYSDA,SPACE=(CYL,(1,1))
CNTL //SYSLIN   DD DSN=&&LIN,DISP=(MOD,PASS),UNIT=SYSDA,
CNTL //         DCB=(IMS1010.PROCLIB),
CNTL //         SPACE=(3520,(40,10),RLSE,,ROUND)
CNTL //*--------------------------------------------------< LINK EDIT   >---
CNTL //L        EXEC PGM=IEWL,REGION=4M,
CNTL //         PARM='LIST,XREF,LET,MAP,AMODE(31),RMODE(ANY)',
CNTL //*        PARM='XREF,LET,LIST',
CNTL //         COND=(8,LT,C)
CNTL //SYSLIB   DD DISP=SHR,DSN=CEE.SCEELKED
CNTL //SDFSRESL DD DSN=IMS1010.SDFSRESL,DISP=SHR
CNTL //SYSLIN   DD DSN=&&LIN,DISP=(OLD,DELETE),
CNTL //         VOL=REF=*.C.SYSLIN
CNTL //         DD DISP=SHR,DSN=IMS1010.PROCLIB(CBLTDLI)
CNTL //         DD DDNAME=SYSIN
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SYSUT1   DD UNIT=(SYSDA,SEP=(SYSLMOD,SYSLIN)),
CNTL //         DISP=(,DELETE),
CNTL //         SPACE=(3520,(100,10),RLSE,,ROUND)
CNTL //SYSLMOD  DD DISP=SHR,DSN=&LOADLIB(&MBR)
CNTL // PEND
CNTL //*--------------------------------------------------------------------
CNTL //PCOBDLI  EXEC COBDLI,MBR=PCOBDLI
CNTL //L.SYSIN DD *
CNTL   NAME PBOGLIPE(R)
CNTL MEMBER NAME  C$ASM
CNTL //C$ASM   JOB MOVE,'COMPILATION ASM',
CNTL //  CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*--------------------------------------------------< COMPILATION >---
CNTL //ASM      PROC MBR=,
CNTL //         SRCELIB=MSOL.PDS.ASM,
CNTL //         LOADLIB=MSOL.PDS.LOAD
CNTL //C        EXEC PGM=ASMA90
CNTL //SYSUT1   DD DSN=&&SYSUT1,SPACE=(4096,(120,120),,,ROUND),UNIT=VIO,
CNTL //         DCB=BUFNO=1
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSLIN   DD DSN=&&OBJ,SPACE=(3040,(40,40),,,ROUND),UNIT=VIO,
CNTL //         DCB=(BLKSIZE=3040,LRECL=80,RECFM=FBS,BUFNO=1),
CNTL //         DISP=(MOD,PASS)
CNTL //SYSLIB   DD DISP=SHR,DSN=SYS1.MACLIB
CNTL //         DD DISP=SHR,DSN=SYS1.MODGEN
CNTL //SYSIN    DD DISP=SHR,DSN=&SRCELIB(&MBR)
CNTL //*--------------------------------------------------< LINK EDIT   >---
CNTL //L        EXEC PGM=HEWL,PARM='MAP,LET,LIST,NCAL,REUS=RENT',
CNTL //         COND=(8,LT,C)
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSLIN   DD DSN=&&OBJ,DISP=(OLD,DELETE)
CNTL //         DD DDNAME=SYSIN
CNTL //SYSUT1   DD DSN=&&SYSUT1,SPACE=(1024,(120,120),,,ROUND),UNIT=VIO,
CNTL //         DCB=BUFNO=1
CNTL //SYSLMOD  DD DISP=SHR,DSN=&LOADLIB(&MBR)
CNTL // PEND
CNTL //*---------------------------------------------------------------------
CNTL //E35      EXEC ASM,MBR=E35
CNTL //*EFACTRT EXEC ASM,MBR=IEFACTRT
CNTL //*EFUJV   EXEC ASM,MBR=IEFUJV
CNTL //*EFUJI   EXEC ASM,MBR=IEFUJI
CNTL //*EFUTL   EXEC ASM,MBR=IEFUTL
CNTL //*EFUAV   EXEC ASM,MBR=IEFUAV
CNTL MEMBER NAME  TESTSORT
CNTL //SMFSORT  JOB MOVE,'TEST SORT EXIT',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*---------------------------------------------------------------------
CNTL //DELETE   EXEC PGM=IEFBR14
CNTL //F0001    DD DISP=(MOD,DELETE),SPACE=(TRK,0),DSN=MSOL.TEST.DFSORT
CNTL //*---------------------------------------------------------------------
CNTL //SORTSTEP EXEC PGM=SORT,REGION=0M,PARM='MSGDDN=E35MSG'
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SORTLIB  DD DISP=SHR,DSN=SYS1.SORTLIB
CNTL //EXITLIB  DD DISP=SHR,DSN=MSOL.PDS.LOAD
CNTL //SORTIN   DD *,DCB=(LRECL=80)
CNTL 00040002EEEEFFFF
CNTL 00030004ABCD1234EFGH
CNTL //SORTIN02 DD *,DCB=(LRECL=80)
CNTL 00010002EEEEFFFF
CNTL 00020004ABCD1234EFGH
CNTL //SORTWK01 DD UNIT=SYSDA,SPACE=(TRK,(50),,CONTIG)
CNTL //SORTWK02 DD UNIT=SYSDA,SPACE=(TRK,(50),,CONTIG)
CNTL //SORTWK03 DD UNIT=SYSDA,SPACE=(TRK,(50),,CONTIG)
CNTL //SORTOUT  DD DISP=(,CATLG,CATLG),DSN=MSOL.TEST.DFSORT,
CNTL //         SPACE=(CYL,(1,1)),VOL=SER=MSOL01,
CNTL //         DCB=(RECFM=FB,LRECL=80,BLKSIZE=12000)
CNTL //E35MSG   DD SYSOUT=*
CNTL //SYSIN    DD *
CNTL   SORT  FIELDS=(1,8,CH,A)
CNTL   MODS E15=(E15,80,EXITLIB,C)
CNTL   OPTION COBEXIT=COB2
CNTL //
CNTL   MODS  E15=(E15,80,EXITLIB,N),E35=(E35,80,EXITLIB,N)
CNTL   SORT  FIELDS=(1,20,A),FORMAT=CH,SIZE=E4000
CNTL   MODS  E15=(E15,80,EXITLIB,N)
CNTL   END
CNTL MEMBER NAME  SORTCOPY
CNTL //SMFSORT  JOB MOVE,'TEST SORT EXIT',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*---------------------------------------------------------------------
CNTL //DELETE   EXEC PGM=IEFBR14
CNTL //F0001    DD DISP=(MOD,DELETE),SPACE=(TRK,0),DSN=MSOL.XFER.IMAPROV
CNTL //*---------------------------------------------------------------------
CNTL //SORTSTEP EXEC PGM=SORT,REGION=0M
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SORTIN   DD DISP=SHR,DSN=MSOL.XFER
CNTL //SORTOUT  DD DISP=(,CATLG,CATLG),DSN=MSOL.XFER.IMAPROV,
CNTL //         SPACE=(TRK,(110,100),RLSE),VOL=SER=MSOL01,
CNTL //         DCB=(RECFM=VB,LRECL=1288,BLKSIZE=27998)
CNTL //E35MSG   DD SYSOUT=*
CNTL //SYSIN    DD *
CNTL   SORT  FIELDS=COPY
CNTL //
CNTL MEMBER NAME  IEB$GNR
CNTL //IEB$GNR  JOB MOVE,'IEBGENER',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*---------------------------------------------------------------------
CNTL //DELETE   EXEC PGM=IEFBR14
CNTL //F0001    DD DSN=MSOL.XFER.IMAPROV,
CNTL //         DISP=(MOD,DELETE),SPACE=(TRK,0)
CNTL //*---------------------------------------------------------------------
CNTL //IEBGENER EXEC PGM=IEBGENER
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSUT1   DD DISP=SHR,DSN=MSOL.XFER
CNTL //SYSUT2   DD DSN=MSOL.XFER.IMAPROV,
CNTL //         DISP=(NEW,CATLG),VOL=SER=MSOL01,
CNTL //         DCB=(RECFM=VB,LRECL=1288,BLKSIZE=27998),
CNTL //         SPACE=(TRK,(1000,500),RLSE)
CNTL //SYSIN    DD DUMMY
CNTL   GENERATE MAXFLDS=1
CNTL   RECORD FIELD=(1288,1,,1)
CNTL /*
CNTL MEMBER NAME  SORT
CNTL //SMFSORT  JOB MOVE,'TEST SORT EXIT',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*---------------------------------------------------------------------
CNTL //DELETE   EXEC PGM=IEFBR14
CNTL //F0001    DD DISP=(MOD,DELETE),SPACE=(TRK,0),DSN=MSOL.XFER.IMAPROV
CNTL //*---------------------------------------------------------------------
CNTL //SORTSTEP EXEC PGM=SORT,REGION=0M
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SORTIN   DD DISP=SHR,DSN=MSOL.XFER,
CNTL //         DCB=(RECFM=V,LRECL=1288,BLKSIZE=27998)
CNTL //SORTOUT  DD SYSOUT=*
CNTL //IMAPROV  DD DISP=(,CATLG,CATLG),DSN=MSOL.XFER.IMAPROV,
CNTL //         SPACE=(TRK,(110,100),RLSE),VOL=SER=MSOL01,
CNTL //         DCB=(RECFM=VB,LRECL=1288,BLKSIZE=27998)
CNTL //SYSIN    DD *
CNTL   SORT  FIELDS=COPY
CNTL //
CNTL MEMBER NAME  IEB$PTP
CNTL //IEB$PTP  JOB MOVE,'IEBPTPCH',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*---------------------------------------------------------------------
CNTL // SET BIB=FMN810.SFMNSAM1
CNTL // SET SEQ=MSOL.XFER.IEBPTPCH
CNTL //*---------------------------------------------------------------------
CNTL //DELETE   EXEC PGM=IEFBR14
CNTL //F0001    DD DSN=&SEQ,
CNTL //         DISP=(MOD,DELETE),SPACE=(TRK,0)
CNTL //*---------------------------------------------------------------------
CNTL //IEBPTPCH EXEC PGM=IEBPTPCH
CNTL //SYSPRINT DD SYSOUT=*
CNTL //* PDS CONTENANT LES SOURCES
CNTL //SYSUT1   DD DISP=SHR,DSN=&BIB
CNTL //* FICHIER SEQUENTIEL RESULTAT
CNTL //SYSUT2   DD DSN=&SEQ,
CNTL //         DISP=(NEW,CATLG),VOL=SER=MSOL01,
CNTL //         DCB=(RECFM=FB,LRECL=81),
CNTL //         SPACE=(TRK,(1000,500),RLSE)
CNTL //SYSIN    DD   *
CNTL   PUNCH TYPORG=PO,MAXFLDS=1
CNTL   RECORD FIELD=(80)
CNTL /*
CNTL MEMBER NAME  FM$VLM
CNTL //FM$VLM  JOB MOVE,'VIEW LOAD MODULE',
CNTL //  CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*--------------------------------------------------------------------
CNTL //* PERMET DE RECUPERE LA VERSION DU COMPILATEUR PAR MODULE
CNTL //*--------------------------------------------------------------------
CNTL //FM       EXEC PGM=FILEMGR
CNTL //STEPLIB  DD DISP=SHR,DSN=FMN810.SFMNMOD1
CNTL //SYSOUT   DD SYSOUT=*
CNTL //*YSPRINT DD SYSOUT=*
CNTL //SYSPRINT DD DISP=SHR,DSN=MSOL.FILEMGR.SYSPRINT
CNTL //SYSIN    DD *
CNTL $$FILEM VLM DSNIN=MSOL.PDS.LOAD,
CNTL $$FILEM DATEFORM=YYMMDD,
CNTL $$FILEM FUNCTION=LIST
CNTL $$FILEM EOJ
CNTL MEMBER NAME  TEST
CNTL //MSJCC    JOB MOVE,'COMPARE FILE',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*---------------------------------------------------------------------
CNTL //JOBLIB   DD DISP=SHR,DSN=MSOL.PDS.LOAD
CNTL //*---------------------------------------------------------------------
CNTL // SET AVANT=MSOL.TEST.COMPARE
CNTL // SET APRES=MSOL.TEST.COMPARE
CNTL // SET CPY=FB00081
CNTL //*---------------------------------------------------------------------
CNTL //* QDCB REXX RECUPERANT LE DCB SOUS FORME '*DCB=FB,80,400'
CNTL //*---------------------------------------------------------------------
CNTL //IKJ      EXEC PGM=IKJEFT1B,PARM=(QDCB,'&AVANT')
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSTSPRT DD DISP=(NEW,PASS),DSN=&&TEMP,
CNTL //         DCB=(RECFM=FB,LRECL=80,BLKSIZE=8000)
CNTL //SYSOUT   DD SYSOUT=*
CNTL //* PDS QUI CONTIENT 'QDCB'
CNTL //SYSEXEC  DD DISP=SHR,DSN=MSOL.PDS.JCL
CNTL //SYSTSIN  DD DUMMY
CNTL //*---------------------------------------------------------------------
CNTL //TEST     EXEC PGM=MSPCC
CNTL //SYSOUT   DD SYSOUT=*
CNTL //FCOPY    DD DISP=SHR,DSN=MSOL.PDS.COPY(&CPY)
CNTL //SYSUT1   DD DISP=SHR,DCB=(LRECL=32760,RECFM=U),DSN=&AVANT
CNTL //SYSUT2   DD DISP=SHR,DCB=(LRECL=32760,RECFM=U),DSN=&APRES
CNTL //SYSIN    DD DISP=(OLD,DELETE),DSN=&&TEMP
CNTL MEMBER NAME  QDCB
CNTL /* REXX */
CNTL /* RECUPERATION DU DCB D'UN FICHIER PASSE EN PARAMETRE */
CNTL /* RESULTAT AU FORMAT SYSIN DES OUTILS                 */
CNTL ARG DSN
CNTL DCB=SUBSTR(DSN,1,1)
CNTL FIC=SUBSTR(DSN,2,LENGTH(DSN) - 1)
CNTL X=LISTDSI(''''FIC'''')
CNTL IF X=0 THEN
CNTL DO
CNTL   SAY '*DCB'DCB'='SYSRECFM','SYSLRECL','SYSBLKSIZE
CNTL END
CNTL EXIT
CNTL MEMBER NAME  C$COB
CNTL //C$COB    JOB MOVE,'COMPIL COB CICS,SQL',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*--------------------------------------------------< COMPILATION >---
CNTL //COB2     PROC MBR=,
CNTL //         SRCELIB=MSOL.PDS.COBOL,
CNTL //         LOADLIB=MSOL.PDS.LOAD
CNTL //C        EXEC PGM=IGYCRCTL,REGION=0M,
CNTL //*  PARM=(NOSEQUENCE,APOST,RENT,LIB,NUM,TEST,
CNTL //   PARM=(NOSEQUENCE,APOST,RENT,LIB,NUM,
CNTL //   'ARITH(EXTEND),PGMNAME(LONGUPPER)')
CNTL //STEPLIB  DD DISP=SHR,DSN=DFH320.CICS.SDFHLOAD
CNTL //         DD DISP=SHR,DSN=IGY410.SIGYCOMP
CNTL //SYSIN    DD DISP=SHR,DSN=&SRCELIB(&MBR)
CNTL //SYSUT1   DD UNIT=SYSDA,SPACE=(CYL,(1,1),,CONTIG)
CNTL //SYSUT2   DD UNIT=SYSDA,SPACE=(CYL,(1,1),,CONTIG)
CNTL //SYSUT3   DD UNIT=SYSDA,SPACE=(CYL,(1,1),,CONTIG)
CNTL //SYSUT4   DD UNIT=SYSDA,SPACE=(CYL,(1,1),,CONTIG)
CNTL //SYSUT5   DD UNIT=SYSDA,SPACE=(CYL,(1,1),,CONTIG)
CNTL //SYSUT6   DD UNIT=SYSDA,SPACE=(CYL,(1,1),,CONTIG)
CNTL //SYSUT7   DD UNIT=SYSDA,SPACE=(CYL,(1,1),,CONTIG)
CNTL //SYSUT8   DD UNIT=SYSDA,SPACE=(CYL,(1,1),,CONTIG)
CNTL //SYSUT9   DD UNIT=SYSDA,SPACE=(CYL,(1,1),,CONTIG)
CNTL //SYSLIB   DD DISP=SHR,DSN=MSOL.PDS.COPY
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SYSLIN   DD DSNAME=&&LOADSET,UNIT=SYSDA,DISP=(,PASS),
CNTL //         SPACE=(TRK,(0,50),RLSE)
CNTL //*--------------------------------------------------< LINK EDIT   >---
CNTL //L        EXEC PGM=IEWL,
CNTL //         PARM='LIST,XREF,LET,MAP,AMODE(31),RMODE(ANY)',
CNTL //         COND=(8,LT,C)
CNTL //SYSLIB   DD DISP=SHR,DSN=MSOL.PDS.LOAD
CNTL //         DD DISP=SHR,DSN=CEE.SCEELKED
CNTL //         DD DISP=SHR,DSN=DSN910.SDSNLOAD
CNTL //*        DD DISP=SHR,DSN=IMSVS.RESLIB
CNTL //         DD DISP=SHR,DSN=DFH320.CICS.SDFHLOAD
CNTL //         DD DISP=SHR,DSN=ISP.SISPLOAD
CNTL //         DD DISP=SHR,DSN=GDDM.SADMMOD
CNTL //SYSLIN   DD DSN=&&LOADSET,DISP=(OLD,DELETE)
CNTL //         DD DDNAME=SYSIN
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSUDUMP DD SYSOUT=D,HOLD=YES
CNTL //SYSUT1   DD SPACE=(1024,(50,50)),UNIT=SYSDA
CNTL //SYSLMOD  DD DISP=SHR,DSN=&LOADLIB(&MBR)
CNTL // PEND
CNTL //*---------------------------------------------------------------------
CNTL //*MSLOGO  EXEC COB2,MBR=MSSLOGO
CNTL //*MSSOPT   EXEC COB2,MBR=MSSOPT
CNTL //*MSSCOPY  EXEC COB2,MBR=MSSCOPY
CNTL //*MSSHEXA  EXEC COB2,MBR=MSSHEXA
CNTL //*MSSFORM  EXEC COB2,MBR=MSSFORM
CNTL //MSPCC    EXEC COB2,MBR=MSPCC
CNTL MEMBER NAME  MSJCC
CNTL //MSJCC    JOB MOVE,'COMPARE FILE',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*---------------------------------------------------------------------
CNTL //* CE JCL PERMET DE COMPARER 2 FICHIERS EN MAPPANT LE COPY
CNTL //* LES ECARTS SONT DONNES PAR RUBRIQUE
CNTL //* LE COPY EST FACULTATIF
CNTL //* LES ECARTS SONT DONNES EN OFSET
CNTL //*---------------------------------------------------------------------
CNTL //JOBLIB   DD DISP=SHR,DSN=MSOL.PDS.LOAD
CNTL //*---------------------------------------------------------------------
CNTL // SET AVANT=MSOL.TEST.COMPARE.FB
CNTL // SET APRES=MSOL.TEST.COMPARE.VB
CNTL // SET CPY=FB00081
CNTL //*---------------------------------------------------------------------
CNTL //* QDCB REXX RECUPERANT LE DCB SOUS FORME '*DCB1=FB,80,400'
CNTL //*---------------------------------------------------------------------
CNTL //IKJ      EXEC PGM=IKJEFT1B,PARM=(QDCB,'1&AVANT')
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSTSPRT DD DISP=(NEW,PASS),DSN=&&TEMP1,
CNTL //         DCB=(RECFM=FB,LRECL=80,BLKSIZE=8000)
CNTL //SYSOUT   DD SYSOUT=*
CNTL //* PDS QUI CONTIENT 'QDCB'
CNTL //SYSEXEC  DD DISP=SHR,DSN=MSOL.PDS.JCL
CNTL //SYSTSIN  DD DUMMY
CNTL //*---------------------------------------------------------------------
CNTL //IKJ      EXEC PGM=IKJEFT1B,PARM=(QDCB,'2&APRES')
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSTSPRT DD DISP=(NEW,PASS),DSN=&&TEMP2,
CNTL //         DCB=(RECFM=FB,LRECL=80,BLKSIZE=8000)
CNTL //SYSOUT   DD SYSOUT=*
CNTL //* PDS QUI CONTIENT 'QDCB'
CNTL //SYSEXEC  DD DISP=SHR,DSN=MSOL.PDS.JCL
CNTL //SYSTSIN  DD DUMMY
CNTL //*---------------------------------------------------------------------
CNTL //TEST     EXEC PGM=MSPCC
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SYSPRINT DD SYSOUT=*
CNTL //*COPY    DD DISP=SHR,DSN=MSOL.PDS.COPY(&CPY)
CNTL //SYSUT1   DD DISP=SHR,DCB=(LRECL=32760,RECFM=U),DSN=&AVANT
CNTL //SYSUT2   DD DISP=SHR,DCB=(LRECL=32760,RECFM=U),DSN=&APRES
CNTL //SYSIN    DD DISP=(OLD,DELETE),DSN=&&TEMP1
CNTL //         DD DISP=(OLD,DELETE),DSN=&&TEMP2
CNTL //         DD *
CNTL *TITLE=COMPARAISON CHARLES BERTRAND
CNTL *DEBUG
CNTL *DETAIL
CNTL *REPORT
CNTL *MASK=01:3,IGNORE,TIME-STAMP
CNTL *MASK=05:3,IGNORE
CNTL *MASK=09:3,SIGNE
CNTL **ASK=13:3,SIGNE
CNTL **ASK=17:3,SIGNE
CNTL *MASK=21:3,SIGNE
CNTL **ASK=25:3,SIGNE
CNTL **ASK=29:3,SIGNE
CNTL *MASK=33:3,MINMAJ
CNTL MEMBER NAME  IDC$DDF
CNTL //IDC$DDF  JOB MOVE,'DELDEF VSAM REPRO',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*--------------------------------------------------------------------
CNTL //DELDEF   EXEC PGM=IDCAMS
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SYSIN    DD *
CNTL  DELETE (IBMUSER.KSDS.FDEPO) CLUSTER PURGE SCRATCH ERASE
CNTL  SET MAXCC=0
CNTL  DEFINE CLUSTER (                      -
CNTL    NAME    (IBMUSER.KSDS.FDEPO)        -
CNTL    CISZ    (8192)                      -
CNTL    KEYS    (11 0)                      -
CNTL    RECSZ   (37 37)                     -
CNTL    VOL     (MSOL01)                    -
CNTL    RECORD  (15000 5000)                -
CNTL    INDEXED                             -
CNTL    UNIQUE                              -
CNTL    SPEED                               -
CNTL    SHR     (2 3)                       -
CNTL    )                                   -
CNTL    DATA    (NAME (IBMUSER.KSDS.FDEPO.DATA))  -
CNTL    INDEX   (NAME (IBMUSER.KSDS.FDEPO.INDX))
CNTL //*--------------------------------------------------------------------
CNTL //REPRO    EXEC PGM=IDCAMS
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SYSIN    DD *
CNTL  REPRO -
CNTL    INDATASET  (IBMUSER.XFER.M01PHY)    -
CNTL    OUTDATASET (IBMUSER.KSDS.FDEPO)
CNTL MEMBER NAME  IDC$PRT
CNTL //IDC$PRT  JOB MOVE,'PRINT VSAM       ',
CNTL // CLASS=A,MSGCLASS=H,MSGLEVEL=1,NOTIFY=&SYSUID
CNTL //*---------------------------------------------------------------------
CNTL //IDCAMS   EXEC PGM=IDCAMS
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSOUT   DD SYSOUT=*
CNTL //ENTREE   DD DISP=SHR,DSN=IBMUSER.KSDS.FDEPO
CNTL //SORTIE   DD SYSOUT=*
CNTL //SYSIN    DD *
CNTL  PRINT INFILE(ENTREE) OUTFILE(SORTIE)
CNTL MEMBER NAME  C$BMS
CNTL //C$BMS    JOB MOVE,'COMPILATION BMS',
CNTL // CLASS=A,MSGCLASS=X,MSGLEVEL=(1,1),NOTIFY=&SYSUID
CNTL //*--------------------------------------------------< COMPILATION >---
CNTL //ASMBMS   PROC MBR=,
CNTL //         SRCELIB=MSOL.PDS.BMS,
CNTL //         LOADLIB=MSOL.PDS.LOAD,
CNTL //         COPYLIB=MSOL.PDS.COPY
CNTL //ASMCOMP  EXEC PGM=ASMA90,
CNTL // PARM='DECK,NOOBJECT,XREF(SHORT),SYSPARM(MAP),LIST'
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SYSIN    DD DISP=SHR,DSN=&SRCELIB(&MBR)
CNTL //SYSPUNCH DD DISP=(NEW,PASS),DSN=&&OBJ,
CNTL //   SPACE=(400,(50,10)),UNIT=VIO,
CNTL //   DCB=(RECFM=FB,LRECL=80,BLKSIZE=400)
CNTL //SYSLIB   DD DISP=SHR,DSN=DFH320.CICS.SDFHMAC
CNTL //         DD DISP=SHR,DSN=SYS1.MACLIB
CNTL //SYSUT1   DD UNIT=VIO
CNTL //SYSUT2   DD UNIT=VIO
CNTL //SYSUT3   DD UNIT=VIO
CNTL //*--------------------------------------------------< LINK EDIT   >---
CNTL //ASMLINK  EXEC PGM=IEWL,COND=(4,LT),PARM='LIST,LET,XREF'
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSLIN   DD DSN=&&OBJ,DISP=(OLD,DELETE)
CNTL //SYSLMOD  DD DSN=&LOADLIB(&MBR),DISP=SHR
CNTL //SYSUT1   DD UNIT=VIO
CNTL //*--------------------------------------------------< COPY COBOL >---
CNTL //ASMDSECT EXEC PGM=ASMA90,COND=(4,LT),
CNTL // PARM='DECK,NOOBJECT,XREF(SHORT),SYSPARM(DSECT),LIST'
CNTL //SYSPRINT DD SYSOUT=*
CNTL //SYSOUT   DD SYSOUT=*
CNTL //SYSIN    DD DISP=SHR,DSN=&SRCELIB(&MBR)
CNTL //SYSPUNCH DD DISP=SHR,DSN=&COPYLIB(&MBR)
CNTL //SYSLIB   DD DISP=SHR,DSN=DFH320.CICS.SDFHMAC
CNTL //         DD DISP=SHR,DSN=SYS1.MACLIB
CNTL //SYSUT1   DD UNIT=VIO
CNTL //SYSUT2   DD UNIT=VIO
CNTL //SYSUT3   DD UNIT=VIO
CNTL // PEND
CNTL //*--------------------------------------------------------------------
CNTL //BCOBCIC  EXEC ASMBMS,MBR=MTRACE1
COPY MEMBER NAME  MSCPICT
COPY       ******************************************************************
COPY       * DEFINITION FORMATE D'UN PICTURE COBOL                          *
COPY       ******************************************************************
COPY        01  W-MSCPICT.
COPY            05  W-PIC-SIGNE     PIC  X(01).
COPY            05  W-PIC-TYPE      PIC  X(01).
COPY            05  W-PIC-PARG1     PIC  X(01).
COPY            05  W-PIC-LG        PIC  9(04).
COPY            05  W-PIC-PARD1     PIC  X(01).
COPY            05  W-PIC-VIRG      PIC  X(01).
COPY            05  W-PIC-TYPE2     PIC  X(01).
COPY            05  W-PIC-PARG2     PIC  X(01).
COPY            05  W-PIC-NBV       PIC  9(02).
COPY            05  W-PIC-PARD2     PIC  X(01).
COPY            05  F               PIC  X(01).
COPY            05  W-PIC-COMP      PIC  X(06).
COPY MEMBER NAME  MSCCONST
COPY       ******************************************************************
COPY       *                     COPY  DES  CONSTANTES                      *
COPY       ******************************************************************
COPY       *----------------------------------------------------------------*
COPY       *                     CONSTANTES STANDARDS                       *
COPY       *----------------------------------------------------------------*
COPY        77  CST-OUI             PIC  X(01)  VALUE  'O'.
COPY        77  CST-NON             PIC  X(01)  VALUE  ' '.
COPY        77  C-OUI               PIC  X(01)  VALUE  'O'.
COPY        77  C-NON               PIC  X(01)  VALUE  ' '.
COPY        77  C-VRAI              PIC  X(01)  VALUE  'O'.
COPY        77  C-FAUX              PIC  X(01)  VALUE  ' '.
COPY        77  C-LECTURE           PIC  X(01)  VALUE  '0'.
COPY        77  C-ECRITURE          PIC  X(01)  VALUE  '1'.
COPY        77  C-FATAL             PIC  X(01)  VALUE  '0'.
COPY        77  C-WARNING           PIC  X(01)  VALUE  '1'.
COPY        77  C-INFO              PIC  X(01)  VALUE  '2'.
COPY        77  C-LISTE             PIC  X(01)  VALUE  '0'.
COPY        77  C-REGLE             PIC  X(01)  VALUE  '1'.
COPY        77  C-ANO99             PIC  X(01)  VALUE  '2'.
COPY        77  C-COMPTEUR          PIC  X(01)  VALUE  '3'.
COPY        77  R-COMP-3            PIC  X(01)  VALUE  '1'.
COPY        77  R-COMP              PIC  X(01)  VALUE  '2'.
COPY        77  R-SIGN-LEAD         PIC  X(01)  VALUE  '1'.
COPY        77  R-SIGN              PIC  X(01)  VALUE  '2'.
COPY        77  R-SIGN-TRAIL        PIC  X(01)  VALUE  '2'.
COPY        77  R-SIGN-LEAD-SEP     PIC  X(01)  VALUE  '3'.
COPY        77  R-SIGN-TRAIL-SEP    PIC  X(01)  VALUE  '4'.
COPY       *----------------------------------------------------------------*
COPY       *                     DIMENSION DES TABLEAUX                     *
COPY       *----------------------------------------------------------------*
COPY       *----------- LONGUEUR D'UN IDENTIFIANT
COPY        77  LG-IDT              PIC  9(04)  VALUE  0020.
COPY       *----------- NB DE CARACTERE DANS UNE LIGNE COBOL (65/80)
COPY        77  LG-LIG-COBOL        PIC  9(04)  VALUE  0065.
COPY       *----------- NB DE RUBRIQUE DANS UN COPY
COPY        77  MAX-RUB             PIC  9(04)  VALUE  1500.
COPY       *----------- MAX MOT DEFINITION COBOL D'UNE RUBRIQUE
COPY        77  MAX-MOT             PIC  9(04)  VALUE  0020.
COPY       *----------- MAX IDENTIFIANT D'UN PROG DE MIGRATION
COPY        77  MAX-IDT             PIC  9(04)  VALUE  0200.
COPY       *----------- MAX RECORD A EDITER
COPY        77  MAX-ENR             PIC  9(04)  VALUE  0300.
COPY       *----------- MAX LIGNE PAR PAGE D'EDITION
COPY        77  MAX-LIG             PIC  9(04)  VALUE  0060.
COPY       *----------- MAX PAGE D'EDITION
COPY        77  MAX-PAGE            PIC  9(04)  VALUE  0025.
COPY       *----------- LARGEUR MAXI D'UNE PAGE D'EDITION
COPY        77  MAX-COLN            PIC  9(04)  VALUE  0132.
COPY       *----------- MAX VALEUR POSSIBLE D'UNE RUBRIQUE A ANALYSER
COPY        77  MAX-VALEUR          PIC  9(04)  VALUE  0400.
COPY       *----------- MAX RUBRIQUE A ANALYSER
COPY        77  MAX-RUBRIQUE        PIC  9(04)  VALUE  0014.
COPY       *----------- MAX OPTION A CHARGER EN SYSIN
COPY        77  MAX-OPT             PIC  9(02)  VALUE  60.
COPY       *----------------------------------------------------------------*
COPY       *                        MOTS CLES                               *
COPY       *----------------------------------------------------------------*
COPY        77  C-LEADING           PIC  X(30)  VALUE  'LEADING'.
COPY        77  C-TRAILING          PIC  X(30)  VALUE  'TRAILING'.
COPY        77  C-SEPARATE          PIC  X(30)  VALUE  'SEPARATE'.
COPY        77  C-REDEFINES         PIC  X(30)  VALUE  'REDEFINES'.
COPY        77  C-OCCURS            PIC  X(30)  VALUE  'OCCURS'.
COPY        77  C-TO                PIC  X(30)  VALUE  'TO'.
COPY        77  C-DEPENDING         PIC  X(30)  VALUE  'DEPENDING'.
COPY        77  C-ON                PIC  X(30)  VALUE  'ON'.
COPY        77  C-PIC               PIC  X(30)  VALUE  'PIC'.
COPY        77  C-PICTURE           PIC  X(30)  VALUE  'PICTURE'.
COPY        77  C-COMPUTATIONAL-3   PIC  X(30)  VALUE  'COMPUTATIONAL-3'.
COPY        77  C-COMP-3            PIC  X(30)  VALUE  'COMP-3'.
COPY        77  C-COMPUTATIONAL     PIC  X(30)  VALUE  'COMPUTATIONAL'.
COPY        77  C-COMP              PIC  X(30)  VALUE  'COMP'.
COPY        77  C-NON-NUMERIQUE     PIC  X(15)  VALUE  'NON NUMERIQUE'.
COPY MEMBER NAME  MSCOPT
COPY       ******************************************************************
COPY       *  COPY DE CHARGEMENT DES OPTIONS D'UN PROGRAMME LU A PARTIR DE  *
COPY       *  LA SYSIN                                                      *
COPY       ******************************************************************
COPY        01  PARAM-OPT.
COPY            05  MX-OPT                  PIC  9(03) COMP VALUE 99.
COPY            05  NB-OPT                  PIC  9(03) COMP.
COPY            05  T-OPT.
COPY                06  FILLER OCCURS 99.
COPY                    10  OPT-MOTCLE      PIC  X(08).
COPY                    10  OPT-PARM        PIC  X(80).
COPY                    10  OPT-VALUE       PIC  9(18).
COPY MEMBER NAME  MSCHEXA
COPY        01  TABLE-ASCII.
COPY            05 F PIC X(16) VALUE X'000102030405060708090A0B0C0D0E0F'.
COPY            05 F PIC X(16) VALUE X'101112131415161718191A1B1C1D1E1F'.
COPY            05 F PIC X(16) VALUE X'202122232425262728292A2B2C2D2E2F'.
COPY            05 F PIC X(16) VALUE X'303132333435363738393A3B3C3D3E3F'.
COPY            05 F PIC X(16) VALUE X'404142434445464748494A4B4C4D4E4F'.
COPY            05 F PIC X(16) VALUE X'505152535455565758595A5B5C5D5E5F'.
COPY            05 F PIC X(16) VALUE X'606162636465666768696A6B6C6D6E6F'.
COPY            05 F PIC X(16) VALUE X'707172737475767778797A7B7C7D7E7F'.
COPY            05 F PIC X(16) VALUE X'808182838485868788898A8B8C8D8E8F'.
COPY            05 F PIC X(16) VALUE X'909192939495969798999A9B9C9D9E9F'.
COPY            05 F PIC X(16) VALUE X'A0A1A2A3A4A5A6A7A8A9AAABACADAEAF'.
COPY            05 F PIC X(16) VALUE X'B0B1B2B3B4B5B6B7B8B9BABBBCBDBEBF'.
COPY            05 F PIC X(16) VALUE X'C0C1C2C3C4C5C6C7C8C9CACBCCCDCECF'.
COPY            05 F PIC X(16) VALUE X'D0D1D2D3D4D5D6D7D8D9DADBDCDDDEDF'.
COPY            05 F PIC X(16) VALUE X'E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF'.
COPY            05 F PIC X(16) VALUE X'F0F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF'.
COPY        01  F REDEFINES TABLE-ASCII.
COPY            5 TA OCCURS 256 PIC X.
COPY        01  TABLE-HEXA PIC X(16) VALUE '0123456789ABCDEF'.
COPY        01  F REDEFINES TABLE-HEXA.
COPY            5 TH OCCURS 16 PIC X.
COPY MEMBER NAME  MSCCOPY
COPY       ******************************************************************
COPY       *  DESCRIPTION DU TABLEAU DES RUBRIQUES ANALYSEES                *
COPY       ******************************************************************
COPY        01  PARAM-MSSCOPY.
COPY            05  TOP-DEPENDING                PIC  X(01).
COPY            05  I-DEPENDING            COMP  PIC  9(05).
COPY            05  LG-COPY                COMP  PIC  9(05).
COPY            05  NB-RUB                 COMP  PIC  9(05).
COPY            05  I-RUB                  COMP  PIC  9(05).
COPY            05  T-RUB  OCCURS 2500.
COPY                10  RUB-TRI.
COPY                    15  RUB-NOM              PIC  X(30).
COPY                    15  RUB-OCCURS     COMP  PIC  9(05).
COPY                10  RUB-PICTURE              PIC  X(21).
COPY                10  RUB-POS            COMP  PIC  9(05).
COPY                10  RUB-LG             COMP  PIC  9(05).
COPY                10  RUB-N9             COMP  PIC  9(05).
COPY                10  RUB-NB-VIRG              PIC  9(04).
COPY                10  F  REDEFINES  RUB-NB-VIRG.
COPY                    15  F                    PIC  9(02).
COPY                    15  RUB-NB-VIRG2         PIC  9(02).
COPY                10  RUB-REDEF                PIC  X(01).
COPY                10  RUB-TYPE                 PIC  X(01).
COPY                10  RUB-SIGNE                PIC  X(01).
COPY                10  RUB-COMP                 PIC  X(01).
COPY                10  RUB-VIRG                 PIC  X(01).
COPY                10  RUB-DEPENDING            PIC  X(01).
COPY                10  RUB-NIVEAU               PIC  X(02).
COPY                10  RUB-TAG                  PIC  X(10).
COPY MEMBER NAME  MSCSIGN
COPY       ******************************************************************
COPY       * EQUIVALENCE DE CARACTERE CONTENANT UN SIGNE SI S9 OU S9 COMP-3 *
COPY       ******************************************************************
COPY        MSCSIGN-CORR-SIGNE.
COPY       *------------------*
COPY             EVALUATE MSCSIGN-CH
COPY              WHEN '{'    MOVE ZERO    TO MSCSIGN-CH
COPY              WHEN '}'    MOVE ZERO    TO MSCSIGN-CH
COPY
COPY              WHEN 'p'    MOVE ZERO    TO MSCSIGN-CH
COPY              WHEN 'q'    MOVE 'J'     TO MSCSIGN-CH
COPY              WHEN 'r'    MOVE 'K'     TO MSCSIGN-CH
COPY              WHEN 's'    MOVE 'L'     TO MSCSIGN-CH
COPY              WHEN 't'    MOVE 'M'     TO MSCSIGN-CH
COPY              WHEN 'u'    MOVE 'N'     TO MSCSIGN-CH
COPY              WHEN 'v'    MOVE 'O'     TO MSCSIGN-CH
COPY              WHEN 'w'    MOVE 'P'     TO MSCSIGN-CH
COPY              WHEN 'x'    MOVE 'Q'     TO MSCSIGN-CH
COPY              WHEN 'y'    MOVE 'R'     TO MSCSIGN-CH
COPY
COPY              WHEN ''    MOVE ZERO    TO MSCSIGN-CH
COPY              WHEN 'A'    MOVE '1'     TO MSCSIGN-CH
COPY              WHEN 'B'    MOVE '2'     TO MSCSIGN-CH
COPY              WHEN 'C'    MOVE '3'     TO MSCSIGN-CH
COPY              WHEN 'D'    MOVE '4'     TO MSCSIGN-CH
COPY              WHEN 'E'    MOVE '5'     TO MSCSIGN-CH
COPY              WHEN 'F'    MOVE '6'     TO MSCSIGN-CH
COPY              WHEN 'G'    MOVE '7'     TO MSCSIGN-CH
COPY              WHEN 'H'    MOVE '8'     TO MSCSIGN-CH
COPY              WHEN 'I'    MOVE '9'     TO MSCSIGN-CH
COPY
COPY              WHEN ''    MOVE ZERO    TO MSCSIGN-CH
COPY              WHEN x'0F'  MOVE x'0C'   TO MSCSIGN-CH
COPY              WHEN x'1F'  MOVE x'1C'   TO MSCSIGN-CH
COPY              WHEN x'2F'  MOVE x'2C'   TO MSCSIGN-CH
COPY              WHEN x'3F'  MOVE x'3C'   TO MSCSIGN-CH
COPY              WHEN x'4F'  MOVE x'4C'   TO MSCSIGN-CH
COPY              WHEN x'5F'  MOVE x'5C'   TO MSCSIGN-CH
COPY              WHEN x'6F'  MOVE x'6C'   TO MSCSIGN-CH
COPY              WHEN x'7F'  MOVE x'7C'   TO MSCSIGN-CH
COPY              WHEN x'8F'  MOVE x'8C'   TO MSCSIGN-CH
COPY              WHEN x'9F'  MOVE x'9C'   TO MSCSIGN-CH
COPY             END-EVALUATE.
COPY MEMBER NAME  FB00081
COPY        01  ENREG.
COPY            05 R1-C3           COMP-3   PIC S9(05).
COPY            05 FILLER                   PIC  X(01).
COPY            05 R2-C3           COMP-3   PIC  9(05).
COPY            05 FILLER                   PIC  X(01).
COPY            05 R3-C3           COMP-3   PIC S9(05).
COPY            05 FILLER                   PIC  X(01).
COPY            05 R1-S9                    PIC S9(03).
COPY            05 FILLER                   PIC  X(01).
COPY            05 R2-S9                    PIC S9(03).
COPY            05 FILLER                   PIC  X(01).
COPY            05 R3-S9                    PIC  9(03).
COPY            05 FILLER                   PIC  X(01).
COPY            05 R4-S9                    PIC S9(03).
COPY            05 FILLER                   PIC  X(01).
COPY            05 R5-S9                    PIC S9(03).
COPY            05 FILLER                   PIC  X(01).
COPY            05 R1-X                     PIC  X(03).
COPY MEMBER NAME  MSCFORM
COPY       ******************************************************************
COPY       *  PARAMETRE D'APPEL DU SOUS-PROGRAMME 'MSSFORM'                 *
COPY       *  FORMATTAGE D'UNE RUBRIQUE                                     *
COPY       ******************************************************************
COPY        01  PARAM-MSSFORM.
COPY       *--------------------------------< NUMERO DE LA RUBRIQUE
COPY            05  MSCFORM-RUB                       PIC  9(04).
COPY       *--------------------------------< TRANSFORMATION ZERO EN SPACE
COPY            05  MSCFORM-ZERO                      PIC  X(01).
COPY       *--------------------------------< VALEUR ZONE NUMERIQUE
COPY            05  MSCFORM-NUM                       PIC  9(18).
COPY            05  MSCFORM-NUM-V   REDEFINES MSCFORM-NUM PIC 9(16)V9(99).
COPY            05  MSCFORM-NUM-V01 REDEFINES MSCFORM-NUM PIC 9(17)V9(01).
COPY            05  MSCFORM-NUM-V02 REDEFINES MSCFORM-NUM PIC 9(16)V9(02).
COPY            05  MSCFORM-NUM-V03 REDEFINES MSCFORM-NUM PIC 9(15)V9(03).
COPY            05  MSCFORM-NUM-V04 REDEFINES MSCFORM-NUM PIC 9(14)V9(04).
COPY            05  MSCFORM-NUM-V05 REDEFINES MSCFORM-NUM PIC 9(13)V9(05).
COPY            05  MSCFORM-NUM-V06 REDEFINES MSCFORM-NUM PIC 9(12)V9(06).
COPY            05  MSCFORM-NUM-V07 REDEFINES MSCFORM-NUM PIC 9(11)V9(07).
COPY            05  MSCFORM-NUM-V08 REDEFINES MSCFORM-NUM PIC 9(10)V9(08).
COPY            05  MSCFORM-NUM-V09 REDEFINES MSCFORM-NUM PIC 9(09)V9(09).
COPY            05  MSCFORM-NUM-V10 REDEFINES MSCFORM-NUM PIC 9(08)V9(10).
COPY            05  MSCFORM-NUM-V11 REDEFINES MSCFORM-NUM PIC 9(07)V9(11).
COPY            05  MSCFORM-NUM-V12 REDEFINES MSCFORM-NUM PIC 9(06)V9(12).
COPY            05  MSCFORM-NUM-V13 REDEFINES MSCFORM-NUM PIC 9(05)V9(13).
COPY            05  MSCFORM-NUM-V14 REDEFINES MSCFORM-NUM PIC 9(04)V9(14).
COPY            05  MSCFORM-NUM-V15 REDEFINES MSCFORM-NUM PIC 9(03)V9(15).
COPY            05  MSCFORM-NUM-V16 REDEFINES MSCFORM-NUM PIC 9(02)V9(16).
COPY            05  MSCFORM-NUM-V17 REDEFINES MSCFORM-NUM PIC 9(01)V9(17).
COPY            05  MSCFORM-SIGNE                     PIC  X(01).
COPY            05  MSCFORM-VALEUR-HEXA               PIC  X(50).
COPY       *--------------------------------< VALEUR AFFICHABLE
COPY            05  MSCFORM-VALEUR.
COPY                10  V    OCCURS 50                PIC  X(01).
COPY            05  RS9C3-1  REDEFINES MSCFORM-VALEUR PIC S9(01) COMP-3.
COPY            05  RS9C3-2  REDEFINES MSCFORM-VALEUR PIC S9(02) COMP-3.
COPY            05  RS9C3-3  REDEFINES MSCFORM-VALEUR PIC S9(03) COMP-3.
COPY            05  RS9C3-4  REDEFINES MSCFORM-VALEUR PIC S9(04) COMP-3.
COPY            05  RS9C3-5  REDEFINES MSCFORM-VALEUR PIC S9(05) COMP-3.
COPY            05  RS9C3-6  REDEFINES MSCFORM-VALEUR PIC S9(06) COMP-3.
COPY            05  RS9C3-7  REDEFINES MSCFORM-VALEUR PIC S9(07) COMP-3.
COPY            05  RS9C3-8  REDEFINES MSCFORM-VALEUR PIC S9(08) COMP-3.
COPY            05  RS9C3-9  REDEFINES MSCFORM-VALEUR PIC S9(09) COMP-3.
COPY            05  RS9C3-10 REDEFINES MSCFORM-VALEUR PIC S9(10) COMP-3.
COPY            05  RS9C3-11 REDEFINES MSCFORM-VALEUR PIC S9(11) COMP-3.
COPY            05  RS9C3-12 REDEFINES MSCFORM-VALEUR PIC S9(12) COMP-3.
COPY            05  RS9C3-13 REDEFINES MSCFORM-VALEUR PIC S9(13) COMP-3.
COPY            05  RS9C3-14 REDEFINES MSCFORM-VALEUR PIC S9(14) COMP-3.
COPY            05  RS9C3-15 REDEFINES MSCFORM-VALEUR PIC S9(15) COMP-3.
COPY            05  RS9C3-16 REDEFINES MSCFORM-VALEUR PIC S9(16) COMP-3.
COPY            05  RS9C3-17 REDEFINES MSCFORM-VALEUR PIC S9(17) COMP-3.
COPY            05  RS9C3-18 REDEFINES MSCFORM-VALEUR PIC S9(18) COMP-3.
COPY            05  R9C3-1   REDEFINES MSCFORM-VALEUR PIC  9(01) COMP-3.
COPY            05  R9C3-2   REDEFINES MSCFORM-VALEUR PIC  9(02) COMP-3.
COPY            05  R9C3-3   REDEFINES MSCFORM-VALEUR PIC  9(03) COMP-3.
COPY            05  R9C3-4   REDEFINES MSCFORM-VALEUR PIC  9(04) COMP-3.
COPY            05  R9C3-5   REDEFINES MSCFORM-VALEUR PIC  9(05) COMP-3.
COPY            05  R9C3-6   REDEFINES MSCFORM-VALEUR PIC  9(06) COMP-3.
COPY            05  R9C3-7   REDEFINES MSCFORM-VALEUR PIC  9(07) COMP-3.
COPY            05  R9C3-8   REDEFINES MSCFORM-VALEUR PIC  9(08) COMP-3.
COPY            05  R9C3-9   REDEFINES MSCFORM-VALEUR PIC  9(09) COMP-3.
COPY            05  R9C3-10  REDEFINES MSCFORM-VALEUR PIC  9(10) COMP-3.
COPY            05  R9C3-11  REDEFINES MSCFORM-VALEUR PIC  9(11) COMP-3.
COPY            05  R9C3-12  REDEFINES MSCFORM-VALEUR PIC  9(12) COMP-3.
COPY            05  R9C3-13  REDEFINES MSCFORM-VALEUR PIC  9(13) COMP-3.
COPY            05  R9C3-14  REDEFINES MSCFORM-VALEUR PIC  9(14) COMP-3.
COPY            05  R9C3-15  REDEFINES MSCFORM-VALEUR PIC  9(15) COMP-3.
COPY            05  R9C3-16  REDEFINES MSCFORM-VALEUR PIC  9(16) COMP-3.
COPY            05  R9C3-17  REDEFINES MSCFORM-VALEUR PIC  9(17) COMP-3.
COPY            05  R9C3-18  REDEFINES MSCFORM-VALEUR PIC  9(18) COMP-3.
COPY            05  RS9C-1   REDEFINES MSCFORM-VALEUR PIC S9(01) COMP.
COPY            05  RS9C-2   REDEFINES MSCFORM-VALEUR PIC S9(02) COMP.
COPY            05  RS9C-3   REDEFINES MSCFORM-VALEUR PIC S9(03) COMP.
COPY            05  RS9C-4   REDEFINES MSCFORM-VALEUR PIC S9(04) COMP.
COPY            05  RS9C-5   REDEFINES MSCFORM-VALEUR PIC S9(05) COMP.
COPY            05  RS9C-6   REDEFINES MSCFORM-VALEUR PIC S9(06) COMP.
COPY            05  RS9C-7   REDEFINES MSCFORM-VALEUR PIC S9(07) COMP.
COPY            05  RS9C-8   REDEFINES MSCFORM-VALEUR PIC S9(08) COMP.
COPY            05  RS9C-9   REDEFINES MSCFORM-VALEUR PIC S9(09) COMP.
COPY            05  RS9C-10  REDEFINES MSCFORM-VALEUR PIC S9(10) COMP.
COPY            05  RS9C-11  REDEFINES MSCFORM-VALEUR PIC S9(11) COMP.
COPY            05  RS9C-12  REDEFINES MSCFORM-VALEUR PIC S9(12) COMP.
COPY            05  RS9C-13  REDEFINES MSCFORM-VALEUR PIC S9(13) COMP.
COPY            05  RS9C-14  REDEFINES MSCFORM-VALEUR PIC S9(14) COMP.
COPY            05  RS9C-15  REDEFINES MSCFORM-VALEUR PIC S9(15) COMP.
COPY            05  RS9C-16  REDEFINES MSCFORM-VALEUR PIC S9(16) COMP.
COPY            05  RS9C-17  REDEFINES MSCFORM-VALEUR PIC S9(17) COMP.
COPY            05  RS9C-18  REDEFINES MSCFORM-VALEUR PIC S9(18) COMP.
COPY            05  R9C-1    REDEFINES MSCFORM-VALEUR PIC  9(01) COMP.
COPY            05  R9C-2    REDEFINES MSCFORM-VALEUR PIC  9(02) COMP.
COPY            05  R9C-3    REDEFINES MSCFORM-VALEUR PIC  9(03) COMP.
COPY            05  R9C-4    REDEFINES MSCFORM-VALEUR PIC  9(04) COMP.
COPY            05  R9C-5    REDEFINES MSCFORM-VALEUR PIC  9(05) COMP.
COPY            05  R9C-6    REDEFINES MSCFORM-VALEUR PIC  9(06) COMP.
COPY            05  R9C-7    REDEFINES MSCFORM-VALEUR PIC  9(07) COMP.
COPY            05  R9C-8    REDEFINES MSCFORM-VALEUR PIC  9(08) COMP.
COPY            05  R9C-9    REDEFINES MSCFORM-VALEUR PIC  9(09) COMP.
COPY            05  R9C-10   REDEFINES MSCFORM-VALEUR PIC  9(10) COMP.
COPY            05  R9C-11   REDEFINES MSCFORM-VALEUR PIC  9(11) COMP.
COPY            05  R9C-12   REDEFINES MSCFORM-VALEUR PIC  9(12) COMP.
COPY            05  R9C-13   REDEFINES MSCFORM-VALEUR PIC  9(13) COMP.
COPY            05  R9C-14   REDEFINES MSCFORM-VALEUR PIC  9(14) COMP.
COPY            05  R9C-15   REDEFINES MSCFORM-VALEUR PIC  9(15) COMP.
COPY            05  R9C-16   REDEFINES MSCFORM-VALEUR PIC  9(16) COMP.
COPY            05  R9C-17   REDEFINES MSCFORM-VALEUR PIC  9(17) COMP.
COPY            05  R9C-18   REDEFINES MSCFORM-VALEUR PIC  9(18) COMP.
COPY            05  RS9-1    REDEFINES MSCFORM-VALEUR PIC S9(01).
COPY            05  RS9-2    REDEFINES MSCFORM-VALEUR PIC S9(02).
COPY            05  RS9-3    REDEFINES MSCFORM-VALEUR PIC S9(03).
COPY            05  RS9-4    REDEFINES MSCFORM-VALEUR PIC S9(04).
COPY            05  RS9-5    REDEFINES MSCFORM-VALEUR PIC S9(05).
COPY            05  RS9-6    REDEFINES MSCFORM-VALEUR PIC S9(06).
COPY            05  RS9-7    REDEFINES MSCFORM-VALEUR PIC S9(07).
COPY            05  RS9-8    REDEFINES MSCFORM-VALEUR PIC S9(08).
COPY            05  RS9-9    REDEFINES MSCFORM-VALEUR PIC S9(09).
COPY            05  RS9-10   REDEFINES MSCFORM-VALEUR PIC S9(10).
COPY            05  RS9-11   REDEFINES MSCFORM-VALEUR PIC S9(11).
COPY            05  RS9-12   REDEFINES MSCFORM-VALEUR PIC S9(12).
COPY            05  RS9-13   REDEFINES MSCFORM-VALEUR PIC S9(13).
COPY            05  RS9-14   REDEFINES MSCFORM-VALEUR PIC S9(14).
COPY            05  RS9-15   REDEFINES MSCFORM-VALEUR PIC S9(15).
COPY            05  RS9-16   REDEFINES MSCFORM-VALEUR PIC S9(16).
COPY            05  RS9-17   REDEFINES MSCFORM-VALEUR PIC S9(17).
COPY            05  RS9-18   REDEFINES MSCFORM-VALEUR PIC S9(18).
COPY            05  RSL9-1   REDEFINES MSCFORM-VALEUR PIC S9(01) LEADING.
COPY            05  RSL9-2   REDEFINES MSCFORM-VALEUR PIC S9(02) LEADING.
COPY            05  RSL9-3   REDEFINES MSCFORM-VALEUR PIC S9(03) LEADING.
COPY            05  RSL9-4   REDEFINES MSCFORM-VALEUR PIC S9(04) LEADING.
COPY            05  RSL9-5   REDEFINES MSCFORM-VALEUR PIC S9(05) LEADING.
COPY            05  RSL9-6   REDEFINES MSCFORM-VALEUR PIC S9(06) LEADING.
COPY            05  RSL9-7   REDEFINES MSCFORM-VALEUR PIC S9(07) LEADING.
COPY            05  RSL9-8   REDEFINES MSCFORM-VALEUR PIC S9(08) LEADING.
COPY            05  RSL9-9   REDEFINES MSCFORM-VALEUR PIC S9(09) LEADING.
COPY            05  RSL9-10  REDEFINES MSCFORM-VALEUR PIC S9(10) LEADING.
COPY            05  RSL9-11  REDEFINES MSCFORM-VALEUR PIC S9(11) LEADING.
COPY            05  RSL9-12  REDEFINES MSCFORM-VALEUR PIC S9(12) LEADING.
COPY            05  RSL9-13  REDEFINES MSCFORM-VALEUR PIC S9(13) LEADING.
COPY            05  RSL9-14  REDEFINES MSCFORM-VALEUR PIC S9(14) LEADING.
COPY            05  RSL9-15  REDEFINES MSCFORM-VALEUR PIC S9(15) LEADING.
COPY            05  RSL9-16  REDEFINES MSCFORM-VALEUR PIC S9(16) LEADING.
COPY            05  RSL9-17  REDEFINES MSCFORM-VALEUR PIC S9(17) LEADING.
COPY            05  RSL9-18  REDEFINES MSCFORM-VALEUR PIC S9(18) LEADING.
COPY            05  RSLS9-1  REDEFINES MSCFORM-VALEUR PIC S9(01) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-2  REDEFINES MSCFORM-VALEUR PIC S9(02) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-3  REDEFINES MSCFORM-VALEUR PIC S9(03) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-4  REDEFINES MSCFORM-VALEUR PIC S9(04) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-5  REDEFINES MSCFORM-VALEUR PIC S9(05) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-6  REDEFINES MSCFORM-VALEUR PIC S9(06) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-7  REDEFINES MSCFORM-VALEUR PIC S9(07) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-8  REDEFINES MSCFORM-VALEUR PIC S9(08) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-9  REDEFINES MSCFORM-VALEUR PIC S9(09) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-10 REDEFINES MSCFORM-VALEUR PIC S9(10) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-11 REDEFINES MSCFORM-VALEUR PIC S9(11) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-12 REDEFINES MSCFORM-VALEUR PIC S9(12) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-13 REDEFINES MSCFORM-VALEUR PIC S9(13) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-14 REDEFINES MSCFORM-VALEUR PIC S9(14) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-15 REDEFINES MSCFORM-VALEUR PIC S9(15) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-16 REDEFINES MSCFORM-VALEUR PIC S9(16) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-17 REDEFINES MSCFORM-VALEUR PIC S9(17) LEADING
COPY                         SEPARATE.
COPY            05  RSLS9-18 REDEFINES MSCFORM-VALEUR PIC S9(18) LEADING
COPY                         SEPARATE.
COPY            05  RSTS9-1  REDEFINES MSCFORM-VALEUR PIC S9(01) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-2  REDEFINES MSCFORM-VALEUR PIC S9(02) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-3  REDEFINES MSCFORM-VALEUR PIC S9(03) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-4  REDEFINES MSCFORM-VALEUR PIC S9(04) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-5  REDEFINES MSCFORM-VALEUR PIC S9(05) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-6  REDEFINES MSCFORM-VALEUR PIC S9(06) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-7  REDEFINES MSCFORM-VALEUR PIC S9(07) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-8  REDEFINES MSCFORM-VALEUR PIC S9(08) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-9  REDEFINES MSCFORM-VALEUR PIC S9(09) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-10 REDEFINES MSCFORM-VALEUR PIC S9(10) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-11 REDEFINES MSCFORM-VALEUR PIC S9(11) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-12 REDEFINES MSCFORM-VALEUR PIC S9(12) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-13 REDEFINES MSCFORM-VALEUR PIC S9(13) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-14 REDEFINES MSCFORM-VALEUR PIC S9(14) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-15 REDEFINES MSCFORM-VALEUR PIC S9(15) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-16 REDEFINES MSCFORM-VALEUR PIC S9(16) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-17 REDEFINES MSCFORM-VALEUR PIC S9(17) TRAILING
COPY                         SEPARATE.
COPY            05  RSTS9-18 REDEFINES MSCFORM-VALEUR PIC S9(18) TRAILING
COPY                         SEPARATE.
COPY            05  R9-1     REDEFINES MSCFORM-VALEUR PIC  9(01).
COPY            05  R9-2     REDEFINES MSCFORM-VALEUR PIC  9(02).
COPY            05  R9-3     REDEFINES MSCFORM-VALEUR PIC  9(03).
COPY            05  R9-4     REDEFINES MSCFORM-VALEUR PIC  9(04).
COPY            05  R9-5     REDEFINES MSCFORM-VALEUR PIC  9(05).
COPY            05  R9-6     REDEFINES MSCFORM-VALEUR PIC  9(06).
COPY            05  R9-7     REDEFINES MSCFORM-VALEUR PIC  9(07).
COPY            05  R9-8     REDEFINES MSCFORM-VALEUR PIC  9(08).
COPY            05  R9-9     REDEFINES MSCFORM-VALEUR PIC  9(09).
COPY            05  R9-10    REDEFINES MSCFORM-VALEUR PIC  9(10).
COPY            05  R9-11    REDEFINES MSCFORM-VALEUR PIC  9(11).
COPY            05  R9-12    REDEFINES MSCFORM-VALEUR PIC  9(12).
COPY            05  R9-13    REDEFINES MSCFORM-VALEUR PIC  9(13).
COPY            05  R9-14    REDEFINES MSCFORM-VALEUR PIC  9(14).
COPY            05  R9-15    REDEFINES MSCFORM-VALEUR PIC  9(15).
COPY            05  R9-16    REDEFINES MSCFORM-VALEUR PIC  9(16).
COPY            05  R9-17    REDEFINES MSCFORM-VALEUR PIC  9(17).
COPY            05  R9-18    REDEFINES MSCFORM-VALEUR PIC  9(18).
COPY       *--------------------------------< ZONE POUR DEPACKER
COPY            05  V9-1                              PIC  9(01).
COPY            05  V9-2                              PIC  9(02).
COPY            05  V9-3                              PIC  9(03).
COPY            05  V9-4                              PIC  9(04).
COPY            05  V9-5                              PIC  9(05).
COPY            05  V9-6                              PIC  9(06).
COPY            05  V9-7                              PIC  9(07).
COPY            05  V9-8                              PIC  9(08).
COPY            05  V9-9                              PIC  9(09).
COPY            05  V9-10                             PIC  9(10).
COPY            05  V9-11                             PIC  9(11).
COPY            05  V9-12                             PIC  9(12).
COPY            05  V9-13                             PIC  9(13).
COPY            05  V9-14                             PIC  9(14).
COPY            05  V9-15                             PIC  9(15).
COPY            05  V9-16                             PIC  9(16).
COPY            05  V9-17                             PIC  9(17).
COPY            05  V9-18                             PIC  9(18).
COPY MEMBER NAME  BCOBCIC
COPY        01  BCOBCICI.
COPY            02  FILLER PIC X(12).
COPY            02  CHOIXL    COMP  PIC  S9(4).
COPY            02  CHOIXF    PICTURE X.
COPY            02  FILLER REDEFINES CHOIXF.
COPY              03 CHOIXA    PICTURE X.
COPY            02  CHOIXI  PIC X(2).
COPY            02  SSCHOIXL    COMP  PIC  S9(4).
COPY            02  SSCHOIXF    PICTURE X.
COPY            02  FILLER REDEFINES SSCHOIXF.
COPY              03 SSCHOIXA    PICTURE X.
COPY            02  SSCHOIXI  PIC X(1).
COPY        01  BCOBCICO REDEFINES BCOBCICI.
COPY            02  FILLER PIC X(12).
COPY            02  FILLER PICTURE X(3).
COPY            02  CHOIXO  PIC X(2).
COPY            02  FILLER PICTURE X(3).
COPY            02  SSCHOIXO  PIC X(1).
COPY MEMBER NAME  MTRACE1
COPY        01  MTRACE1I.
COPY            02  FILLER PIC X(12).
COPY            02  RESULTL    COMP  PIC  S9(4).
COPY            02  RESULTF    PICTURE X.
COPY            02  FILLER REDEFINES RESULTF.
COPY              03 RESULTA    PICTURE X.
COPY            02  RESULTI  PIC X(80).
COPY        01  MTRACE1O REDEFINES MTRACE1I.
COPY            02  FILLER PIC X(12).
COPY            02  FILLER PICTURE X(3).
COPY            02  RESULTO  PIC X(80).
COBOL MEMBER NAME  PCOBCIC
COBOL 000100 IDENTIFICATION DIVISION.
COBOL 000200 PROGRAM-ID. PCOBCIC.
COBOL 000300 AUTHOR. MOVE SOLUTIONS.
COBOL 000400 DATE-WRITTEN.  MAY 2016.
COBOL 000500 DATE-COMPILED.
COBOL 000600 ENVIRONMENT DIVISION.
COBOL 000700 DATA DIVISION.
COBOL 000800 WORKING-STORAGE SECTION.
COBOL 000900     COPY BCOBCIC.
COBOL 001000 LINKAGE SECTION.
COBOL 001100 01  DFHCOMMAREA                  PIC X.
COBOL 001300 PROCEDURE DIVISION.
COBOL 010500     EXEC CICS SEND
COBOL 010510        MAP('BCOBCIC')
COBOL 010600        MAPSET('BCOBCIC')
COBOL 010700        FROM(BCOBCICO)
COBOL 010800        NOHANDLE
COBOL 010900        END-EXEC.
COBOL 011400     EXEC CICS RETURN END-EXEC.
COBOL 011900     GOBACK.
COBOL MEMBER NAME  HELLOC
COBOL include <stdint.h>
COBOL include <stdio.h>
COBOL include <string.h>
COBOL include <stdlib.h>
COBOL
COBOL int main(int argc, char** argv) 
COBOL   printf("hello, worldn");
COBOL 
COBOL
COBOL void conv(char* buffer, char* value, int size) 
COBOL     int i;
COBOL
COBOL     for (i=0; i<size; i++) 
COBOL         bufferi~ = valuesize-i-1~;
COBOL     
COBOL 
COBOL
COBOL void toBigEndian(char* dest, char* src, int size) 
COBOL     memcpy(dest, src, size);
COBOL 
COBOL
COBOL void fromBigEndian(char* dest, char* src, int size) 
COBOL     conv(dest, src, size);
COBOL 
COBOL
COBOL int16_t fromCOMP4(int16_t* from) 
COBOL     int16_t to;
COBOL
COBOL     fromBigEndian((char*) &to,(char*) from, 2);
COBOL     return to;
COBOL 
COBOL
COBOL int32_t fromCOMP4_32(int32_t* from) 
COBOL     int32_t to;
COBOL
COBOL     fromBigEndian((char*) &to,(char*) from, 4);
COBOL     return to;
COBOL 
COBOL
COBOL int64_t fromCOMP4_64(int64_t* from) 
COBOL     int64_t to;
COBOL
COBOL     fromBigEndian((char*) &to,(char*) from, 8);
COBOL     return to;
COBOL 
COBOL
COBOL int16_t toCOMP4(int16_t from) 
COBOL     int16_t to;
COBOL
COBOL     toBigEndian((char*) &to, (char*) &from, 2);
COBOL     return to;
COBOL 
COBOL
COBOL int32_t toCOMP4_32(int32_t from) 
COBOL     int32_t to;
COBOL
COBOL     toBigEndian((char*) &to, (char*) &from, 4);
COBOL     return to;
COBOL 
COBOL
COBOL int64_t toCOMP4_64(int64_t from) 
COBOL     int64_t to;
COBOL
COBOL     toBigEndian((char*) &to, (char*) &from, 8);
COBOL     return to;
COBOL 
COBOL
COBOL
COBOL int64_t round64(int64_t n, int16_t ne, char* factorStr) 
COBOL   /* n : le nombre a arrondir */
COBOL   /* ne : la puissance de 10 du nombre a arrondir */
COBOL   /* f : la facteur d'arrondi */
COBOL   /* fe : la puissance de 10 du facteur d'arrondi */
COBOL
COBOL   printf(">>> round64n");
COBOL
COBOL
COBOL   if (strncmp(factorStr, "FACTOR=", 7) = 0) 
COBOL     printf("Mode d'arrondi non supportee : %sn", factorStr);
COBOL     return n;
COBOL   
COBOL
COBOL   char strstrlen(factorStr)~;
COBOL   char* p = factorStr + 7;
COBOL   char* p2 = str;
COBOL
COBOL   int16_t fe = 1;
COBOL
COBOL   while (p0~ = 0 && p0~ = ' ') 
COBOL     if (p0~ == '.') 
COBOL       p++;
COBOL       fe = 0;
COBOL      else 
COBOL       if (fe <= 0) fe--;
COBOL       p20~ = p0~;
COBOL       p++;
COBOL       p2++;
COBOL     
COBOL   
COBOL
COBOL   p20~ = 0;
COBOL   if (fe == 1) fe = 0;
COBOL
COBOL /* Cette instruction peut poser probleme */
COBOL /* avec un compilateur sizeof(long) = 8 */
COBOL   int64_t f = atol(str);
COBOL   if (f == 0) return n;
COBOL
COBOL   /* Alignement des puissances de 10 de f et n */
COBOL    while (ne < fe) 
COBOL       f *= 10;
COBOL       fe--;
COBOL    
COBOL    while (ne > fe) 
COBOL       f /= 10;
COBOL       fe++;
COBOL    
COBOL
COBOL    /* Ajout de la moitie de la valeur f a n */
COBOL    /* (ou soustraction si n < 0) pour avoir l'arrondi voulu */
COBOL    /* en supprimant le reste de la division entiere de n par f.*/
COBOL    if (f = 0) 
COBOL       int halff = f >> 1;
COBOL
COBOL       if (n > 0) 
COBOL          n += halff;
COBOL        else 
COBOL          n -= halff;
COBOL       
COBOL       n -= n % f;
COBOL    
COBOL   printf("<<< round64n");
COBOL
COBOL   return n;
COBOL 
COBOL
COBOL void MSOL_ROUND(int64_t* _n, int32_t* _ne, char* factorStr) 
COBOL   int64_t n = fromCOMP4_64(_n);
COBOL   int16_t ne = fromCOMP4_32(_ne);
COBOL   char* fct = factorStr;
COBOL
COBOL   char* ptr = fct;
COBOL   while (1) 
COBOL     if (ptr0~ == ' ') 
COBOL         ptr0~ = 0;
COBOL     
COBOL     if (ptr0~ == 0) break;
COBOL     ptr++;
COBOL   
COBOL
COBOL   printf("ne=%dn", ne);
COBOL   printf("fct=%sn", fct);
COBOL   n = round64(n, -ne, factorStr);
COBOL
COBOL   *_n = toCOMP4_64(n);
COBOL 
COBOL void MSOL_ROUND64(int64_t* n, int64_t* _ne, char* factorStr) 
COBOL   int16_t ne = *_ne;
COBOL   *n = round64(*n, -ne, factorStr);
COBOL 
COBOL
COBOL
COBOL void MSOL_CHAR_TO_HEX(char* str, int32_t* _lstr, char* hex) 
COBOL   char tab16~ = "0123456789ABCDEF";
COBOL
COBOL   int32_t lstr = fromCOMP4_32(_lstr);
COBOL   char* str2 = malloc(lstr + 1);
COBOL   memcpy(str2, str, lstr);
COBOL   str2lstr~ = 0;
COBOL
COBOL   printf(">>> msol_char_to_hex, str %s~, length %d~ n", str2, lstr);
COBOL
COBOL   int ind = 0;
COBOL   int indt = 0;
COBOL
COBOL   while (ind < lstr) 
COBOL     int val = str2ind~;
COBOL     int left = val / 16;
COBOL     int right = val % 16;
COBOL     hexindt~ = tableft~;
COBOL     indt++;
COBOL     hexindt~ = tabright~;
COBOL     indt++;
COBOL     ind++;
COBOL   
COBOL
COBOL   int32_t lhex = lstr*2;
COBOL   char* hex2 = malloc(lhex + 1);
COBOL   memcpy(hex2, hex, lhex);
COBOL   hex2lhex~ = 0;
COBOL   printf(">>> msol_char_to_hex, str %s~ , hex %s~n",str2, hex2);
COBOL
COBOL
COBOL   free(str2);
COBOL   free(hex2);
COBOL
COBOL 
COBOL MEMBER NAME  E35
COBOL        IDENTIFICATION DIVISION.
COBOL        PROGRAM-ID.  E35.
COBOL        DATA DIVISION.
COBOL        WORKING-STORAGE SECTION.
COBOL        01  WS-SUB                 PIC S9(9) COMP VALUE 0.
COBOL        01  WS-START-POS           PIC S9(9) COMP VALUE 0.
COBOL
COBOL        LINKAGE SECTION.
COBOL        01  LS-RECORD-FLAGS        PIC S9(8) COMP.
COBOL        01  LS-DFSORT-RECORD.
COBOL            05 LS-NUM-ENTRIES      PIC 9(4).
COBOL            05 LS-FLD-LENGTH       PIC 9(4).
COBOL            05 LS-FLD-REC          PIC X(72).
COBOL
COBOL        01  LS-RETURN-RECORD       PIC X(80).
COBOL
COBOL        PROCEDURE DIVISION USING LS-RECORD-FLAGS
COBOL                                 LS-DFSORT-RECORD
COBOL                                 LS-RETURN-RECORD.
COBOL            DISPLAY '---------------------------------AVANT-'
COBOL                ' (' WS-SUB ':' WS-START-POS ')'
COBOL            DISPLAY ' LS-RECORD-FLAGS =' LS-RECORD-FLAGS
COBOL            DISPLAY ' LS-DFSORT-RECORD=' LS-DFSORT-RECORD
COBOL            DISPLAY ' LS-RETURN-RECORD=' LS-RETURN-RECORD
COBOL            DISPLAY '---------------------------------------'
COBOL            DISPLAY ' '
COBOL            IF LS-RECORD-FLAGS = 8
COBOL               MOVE 8               TO RETURN-CODE
COBOL            ELSE
COBOL               PERFORM 1000-MOVE-DATA
COBOL            END-IF
COBOL            DISPLAY '---------------------------------APRES-'
COBOL            DISPLAY ' LS-RECORD-FLAGS =' LS-RECORD-FLAGS
COBOL            DISPLAY ' LS-DFSORT-RECORD=' LS-DFSORT-RECORD
COBOL            DISPLAY ' LS-RETURN-RECORD=' LS-RETURN-RECORD
COBOL            DISPLAY '---------------------------------------'
COBOL                    ' RC=' RETURN-CODE
COBOL            DISPLAY ' '
COBOL            GOBACK
COBOL            .
COBOL
COBOL        1000-MOVE-DATA.
COBOL
COBOL            COMPUTE WS-START-POS  = ( WS-SUB * LS-FLD-LENGTH ) + 1
COBOL            MOVE  LS-FLD-REC (WS-START-POS : LS-FLD-LENGTH)
COBOL                                    TO LS-RETURN-RECORD
COBOL            MOVE 12                 TO RETURN-CODE
COBOL            ADD +1                  TO WS-SUB
COBOL            IF WS-SUB >  LS-NUM-ENTRIES
COBOL               MOVE 4               TO RETURN-CODE
COBOL               MOVE 0               TO WS-SUB
COBOL                                       WS-START-POS
COBOL            END-IF.
COBOL MEMBER NAME  E15
COBOL        IDENTIFICATION DIVISION.
COBOL       *-----------------------------------------------------------------
COBOL        PROGRAM-ID. E15.
COBOL        AUTHOR. MOVE SOLUTIONS.
COBOL        DATE-WRITTEN.  MAY 2016.
COBOL        DATE-COMPILED.
COBOL       *-----------------------------------------------------------------
COBOL        ENVIRONMENT DIVISION.
COBOL        DATA DIVISION.
COBOL        WORKING-STORAGE SECTION.
COBOL        77  WNO PIC 9(5) VALUE ZERO.
COBOL        LINKAGE SECTION.
COBOL       *01  RECORD-FLAGS       PIC 9(8) BINARY.
COBOL       *       88  FIRST-REC            VALUE 00.
COBOL       *       88  MIDDLE-REC           VALUE 04.
COBOL       *       88  END-REC              VALUE 08.
COBOL       *01  NEW-REC            PIC X(100).
COBOL       *01  RETURN-REC         PIC X(100).
COBOL       *01  UNUSED1            PIC 9(8) BINARY.
COBOL       *01  UNUSED2            PIC 9(8) BINARY.
COBOL       *01  UNUSED3            PIC 9(8) BINARY.
COBOL       *01  UNUSED4            PIC 9(8) BINARY.
COBOL       *01  UNUSED5            PIC 9(8) BINARY.
COBOL       *01  EXITAREA-LEN       PIC 9(4) BINARY.
COBOL       *01  EXITAREA.
COBOL       *    05  EAREA   OCCURS 1 TO 256 TIMES
COBOL       *            DEPENDING ON EXITAREA-LEN   PIC X.
COBOL        01 A01 PIC S9(8) COMP.
COBOL        01 A02 PIC X(100).
COBOL        01 A03 PIC X(100).
COBOL        01 A04 PIC 9(8) BINARY.
COBOL        01 A05 PIC 9(8) BINARY.
COBOL        01 A06 PIC 9(8) BINARY.
COBOL        01 A07 PIC 9(8) BINARY.
COBOL        01 A08 PIC 9(8) BINARY.
COBOL        01 A09 PIC 9(4) BINARY.
COBOL        01 A10 PIC X(256).
COBOL       *-----------------------------------------------------------------
COBOL        PROCEDURE DIVISION USING A01 A02 A03 A04 A05 A06 A07 A08 A09 A10.
COBOL
COBOL            ADD 1 TO WNO
COBOL            DISPLAY '-------------------------------- ' WNO
COBOL            IF ADDRESS OF A01 NOT = NULL
COBOL               DISPLAY 'A01=' A01
COBOL            END-IF
COBOL            IF ADDRESS OF A02 NOT = NULL
COBOL               DISPLAY 'A02=' A02
COBOL            END-IF
COBOL            IF ADDRESS OF A03 NOT = NULL
COBOL               DISPLAY 'A03=' A03
COBOL            END-IF
COBOL            IF ADDRESS OF A04 NOT = NULL
COBOL               DISPLAY 'A04=' A04
COBOL            END-IF
COBOL            IF ADDRESS OF A05 NOT = NULL
COBOL               DISPLAY 'A05=' A05
COBOL            END-IF
COBOL            IF ADDRESS OF A06 NOT = NULL
COBOL               DISPLAY 'A06=' A06
COBOL            END-IF
COBOL            IF ADDRESS OF A07 NOT = NULL
COBOL               DISPLAY 'A07=' A07
COBOL            END-IF
COBOL            IF ADDRESS OF A08 NOT = NULL
COBOL               DISPLAY 'A08=' A08
COBOL            END-IF
COBOL            IF ADDRESS OF A09 NOT = NULL
COBOL               DISPLAY 'A09=' A09
COBOL            END-IF
COBOL            IF ADDRESS OF A10 NOT = NULL
COBOL               DISPLAY 'A10=' A10
COBOL            END-IF
COBOL
COBOL            IF A01 = ZERO
COBOL            AND ADDRESS OF A09 NOT = NULL
COBOL            AND ADDRESS OF A10 NOT = NULL
COBOL              MOVE 256  TO A09
COBOL              MOVE 'CHARLES ' TO A10
COBOL            END-IF
COBOL
COBOL            IF A01 = 8
COBOL              MOVE 8    TO RETURN-CODE
COBOL            ELSE
COBOL              MOVE ZERO TO RETURN-CODE
COBOL            END-IF
COBOL
COBOL            GOBACK.
COBOL MEMBER NAME  E32
COBOL        IDENTIFICATION DIVISION.
COBOL       *-----------------------------------------------------------------
COBOL        PROGRAM-ID. E32.
COBOL        AUTHOR. MOVE SOLUTIONS.
COBOL        DATE-WRITTEN.  MAY 2016.
COBOL        DATE-COMPILED.
COBOL       *-----------------------------------------------------------------
COBOL        ENVIRONMENT DIVISION.
COBOL        DATA DIVISION.
COBOL        WORKING-STORAGE SECTION.
COBOL        77  WNO PIC 9(5) VALUE ZERO.
COBOL        LINKAGE SECTION.
COBOL       *01  RECORD-FLAGS       PIC 9(8) BINARY.
COBOL       *       88  FIRST-REC            VALUE 00.
COBOL       *       88  MIDDLE-REC           VALUE 04.
COBOL       *       88  END-REC              VALUE 08.
COBOL       *01  NEW-REC            PIC X(100).
COBOL       *01  RETURN-REC         PIC X(100).
COBOL       *01  UNUSED1            PIC 9(8) BINARY.
COBOL       *01  UNUSED2            PIC 9(8) BINARY.
COBOL       *01  UNUSED3            PIC 9(8) BINARY.
COBOL       *01  UNUSED4            PIC 9(8) BINARY.
COBOL       *01  UNUSED5            PIC 9(8) BINARY.
COBOL       *01  EXITAREA-LEN       PIC 9(4) BINARY.
COBOL       *01  EXITAREA.
COBOL       *    05  EAREA   OCCURS 1 TO 256 TIMES
COBOL       *            DEPENDING ON EXITAREA-LEN   PIC X.
COBOL        01 A01 PIC S9(8) COMP.
COBOL        01 A02 PIC X(100).
COBOL        01 A03 PIC X(100).
COBOL        01 A04 PIC 9(8) BINARY.
COBOL        01 A05 PIC 9(8) BINARY.
COBOL        01 A06 PIC 9(8) BINARY.
COBOL        01 A07 PIC 9(8) BINARY.
COBOL        01 A08 PIC 9(8) BINARY.
COBOL        01 A09 PIC 9(4) BINARY.
COBOL        01 A10 PIC X(256).
COBOL       *-----------------------------------------------------------------
COBOL        PROCEDURE DIVISION USING A01 A02 A03 A04 A05 A06 A07 A08 A09 A10.
COBOL
COBOL            ADD 1 TO WNO
COBOL            DISPLAY '-------------------------------- ' WNO
COBOL            IF ADDRESS OF A01 NOT = NULL
COBOL               DISPLAY 'A01=' A01
COBOL            END-IF
COBOL            IF ADDRESS OF A02 NOT = NULL
COBOL               DISPLAY 'A02=' A02
COBOL            END-IF
COBOL            IF ADDRESS OF A03 NOT = NULL
COBOL               DISPLAY 'A03=' A03
COBOL            END-IF
COBOL            IF ADDRESS OF A04 NOT = NULL
COBOL               DISPLAY 'A04=' A04
COBOL            END-IF
COBOL            IF ADDRESS OF A05 NOT = NULL
COBOL               DISPLAY 'A05=' A05
COBOL            END-IF
COBOL            IF ADDRESS OF A06 NOT = NULL
COBOL               DISPLAY 'A06=' A06
COBOL            END-IF
COBOL            IF ADDRESS OF A07 NOT = NULL
COBOL               DISPLAY 'A07=' A07
COBOL            END-IF
COBOL            IF ADDRESS OF A08 NOT = NULL
COBOL               DISPLAY 'A08=' A08
COBOL            END-IF
COBOL            IF ADDRESS OF A09 NOT = NULL
COBOL               DISPLAY 'A09=' A09
COBOL            END-IF
COBOL            IF ADDRESS OF A10 NOT = NULL
COBOL               DISPLAY 'A10=' A10
COBOL            END-IF
COBOL
COBOL            IF A01 = ZERO
COBOL            AND ADDRESS OF A09 NOT = NULL
COBOL            AND ADDRESS OF A10 NOT = NULL
COBOL              MOVE 256  TO A09
COBOL              MOVE 'CHARLES ' TO A10
COBOL            END-IF
COBOL
COBOL            IF A01 = 8
COBOL              MOVE 8    TO RETURN-CODE
COBOL            ELSE
COBOL            IF A01 = 16
COBOL              MOVE 16   TO RETURN-CODE
COBOL            ELSE
COBOL              MOVE ZERO TO RETURN-CODE
COBOL            END-IF.
COBOL
COBOL            GOBACK.
COBOL MEMBER NAME  TEST
COBOL        IDENTIFICATION DIVISION.
COBOL **************************************************************************
COBOL        PROGRAM-ID. TTEST.
COBOL **************************************************************************
COBOL        AUTHOR. MOVE SOLUTIONS.
COBOL        ENVIRONMENT DIVISION.
COBOL        CONFIGURATION SECTION.
COBOL        SOURCE-COMPUTER. IBM-370.
COBOL        OBJECT-COMPUTER. IBM-370.
COBOL        SPECIAL-NAMES.
COBOL       *    DECIMAL-POINT IS COMMA.
COBOL
COBOL        INPUT-OUTPUT SECTION.
COBOL       *=====================
COBOL        FILE-CONTROL.
COBOL            SELECT F-TRAV   ASSIGN TO  TRAV.
COBOL **************************************************************************
COBOL        DATA DIVISION.
COBOL       *==============
COBOL        FILE SECTION.
COBOL       *=============
COBOL        FD  F-TRAV
COBOL            RECORDING MODE IS V
COBOL            BLOCK 0 RECORDS.
COBOL        01  REG-TRAV.
COBOL            05  TRAV-LG       PIC 9(8) COMP.
COBOL            05  TRAV-DATA.
COBOL                10 FILLER PIC X OCCURS 76 DEPENDING ON TRAV-LG.
COBOL **************************************************************************
COBOL        WORKING-STORAGE SECTION.
COBOL        77 ZZ           PIC --9V,999999999.
COBOL        77 AA-1-8       PIC S9(1)V9(8) COMP-3.
COBOL        77 BB-2-7       PIC S9(2)V9(7) COMP-3.
COBOL        77 CC-2-7       PIC S9(2)V9(7) COMP-3.
COBOL **************************************************************************
COBOL        PROCEDURE DIVISION.
COBOL            DISPLAY  "CREATION FICHIER TRAV EN VARIABLE"
COBOL            OPEN OUTPUT F-TRAV
COBOL            MOVE 11 TO TRAV-LG
COBOL            MOVE "1234567890 "                 TO TRAV-DATA
COBOL            WRITE REG-TRAV
COBOL            MOVE 27 TO TRAV-LG
COBOL            MOVE "ABCDEFGHIJKLMNOPQRSTUVWXYZ " TO TRAV-DATA
COBOL            WRITE REG-TRAV
COBOL            CLOSE F-TRAV.
COBOL
COBOL            DISPLAY  "***=****,123456789***"
COBOL
COBOL            COMPUTE AA-1-8 = 1.12345672
COBOL            COMPUTE BB-2-7 = AA-1-8
COBOL            MOVE BB-2-7 TO ZZ
COBOL            DISPLAY "01 = " ZZ
COBOL
COBOL            COMPUTE AA-1-8 = 1.12345675
COBOL            COMPUTE BB-2-7 = AA-1-8
COBOL            MOVE BB-2-7 TO ZZ
COBOL            DISPLAY "01 = " ZZ
COBOL
COBOL            COMPUTE AA-1-8 = 1.12345678
COBOL            COMPUTE BB-2-7 = AA-1-8
COBOL            MOVE BB-2-7 TO ZZ
COBOL            DISPLAY "01 = " ZZ
COBOL
COBOL            COMPUTE AA-1-8 = 1.12345672
COBOL            COMPUTE BB-2-7 ROUNDED = AA-1-8
COBOL            MOVE BB-2-7 TO ZZ
COBOL            DISPLAY "01R= " ZZ
COBOL
COBOL            COMPUTE AA-1-8 = 1.12345675
COBOL            COMPUTE BB-2-7 ROUNDED = AA-1-8
COBOL            MOVE BB-2-7 TO ZZ
COBOL            DISPLAY "01R= " ZZ
COBOL
COBOL            COMPUTE AA-1-8 = 1.12345678
COBOL            COMPUTE BB-2-7 ROUNDED = AA-1-8
COBOL            MOVE BB-2-7 TO ZZ
COBOL            DISPLAY "01R= " ZZ
COBOL
COBOL            GOBACK.
COBOL MEMBER NAME  MSSOPT
COBOL        IDENTIFICATION DIVISION.
COBOL       ******************************************************************
COBOL       * MSOL                                                       IBM *
COBOL       ******************************************************************
COBOL       * CHARGEMENT DES PARAMETRES CONTENUS EN SYSIN                    *
COBOL       * UN DISPLAY DE LA SYSIN CHARGE EST EFFECTUE                     *
COBOL       *                                                                *
COBOL       * STRUCTURE DE LA SYSIN                                          *
COBOL       *                                                                *
COBOL       * COLONNE 1   : '*'                                              *
COBOL       * COLONNE 2-9 : MOT CLE SUR 8 CARACTERES MAXIMUM                 *
COBOL       * COLONNE 10  : '='                                              *
COBOL       * COLONNE 11- : VALEUR DU PARAMETRE                              *
COBOL       *                                                                *
COBOL       * REMARQUE :                                                     *
COBOL       *   LA POSITION DU '=' N'EST PAS OBLIGATOIREMENT EN POSITION 10  *
COBOL       *   LES BLANCS SUIVANTS LE '=' NE SONT PAS PRIS EN CONSIDERATION *
COBOL       ******************************************************************
COBOL        PROGRAM-ID.   MSSOPT.
COBOL        AUTHOR.       MSOL.
COBOL       ******************************************************************
COBOL        ENVIRONMENT DIVISION.
COBOL        CONFIGURATION SECTION.
COBOL        SOURCE-COMPUTER. IBM-3090.
COBOL        OBJECT-COMPUTER. IBM-3090.
COBOL       ******************************************************************
COBOL        INPUT-OUTPUT SECTION.
COBOL        FILE-CONTROL.
COBOL       ******************************************************************
COBOL        DATA DIVISION.
COBOL       ******************************************************************
COBOL        FILE SECTION.
COBOL       ******************************************************************
COBOL        WORKING-STORAGE SECTION.
COBOL       ******************************************************************
COBOL        01  K-OUI                        PIC  X(01) VALUE 'O'.
COBOL        01  ZONES-ALPHA.
COBOL            05  W-FIN-SYSIN              PIC  X(01).
COBOL                88  FIN-SYSIN VALUE 'O'.
COBOL            05  W-DATE-COMPILED.
COBOL                10  WC-HH                PIC  X(02).
COBOL                10  F                    PIC  X(01).
COBOL                10  WC-MN                PIC  X(02).
COBOL                10  F                    PIC  X(01).
COBOL                10  WC-SC                PIC  X(02).
COBOL                10  WC-MMM               PIC  X(03).
COBOL                10  F                    PIC  X(01).
COBOL                10  WC-JJ                PIC  X(02).
COBOL                10  F                    PIC  X(02).
COBOL                10  WC-SSAA              PIC  X(04).
COBOL            05  W-MOT-CLE                PIC  X(08).
COBOL            05  W-PARM1                  PIC  X(80).
COBOL            05  W-PARM2                  PIC  X(80).
COBOL            05  W-PARM3                  PIC  X(80).
COBOL            05  W-SYSIN                  PIC  X(80).
COBOL            05  F   REDEFINES  W-SYSIN.
COBOL                10  W-SYSIN-1            PIC  X(01).
COBOL                10  W-SYSIN-RESTE        PIC  X(79).
COBOL            05  W-MOT.
COBOL                10  W-M    OCCURS  80    PIC  X(01).
COBOL            05  F   REDEFINES  W-MOT.
COBOL                10  W-9    OCCURS  80    PIC  9(01).
COBOL       ******************************************************************
COBOL        01  W-SYSIN-COLONNE.
COBOL            05  FILLER                   PIC  X(31).
COBOL            05  SYSIN-COL  OCCURS 0 TO 41
COBOL                DEPENDING ON  I          PIC  X(01).
COBOL            05  SYSIN-NOM                PIC  X(74).
COBOL       ******************************************************************
COBOL        01  ZONES-NUMERIQUES.
COBOL            05  NB-SYSIN                 PIC  9(02).
COBOL            05  I                        PIC  9(04).
COBOL            05  J                        PIC  9(04).
COBOL            05  K                        PIC  9(04).
COBOL       ******************************************************************
COBOL            COPY  MSCCONST  SUPPRESS.
COBOL       ******************************************************************
COBOL        LINKAGE SECTION.
COBOL            COPY  MSCOPT    SUPPRESS.
COBOL       ******************************************************************
COBOL        PROCEDURE  DIVISION  USING  PARAM-OPT.
COBOL            PERFORM  INITIALISATION.
COBOL            PERFORM  ACCEPT-SYSIN
COBOL              UNTIL  FIN-SYSIN
COBOL                 OR (NB-OPT >= MX-OPT).
COBOL            DISPLAY ' '.
COBOL            DISPLAY '** > ----+----1----+----2----+----3----+----4'
COBOL                         '----+----5----+----6----+----7----+----8'.
COBOL            DISPLAY ' '.
COBOL        STOP-RUN.
COBOL       **********
COBOL            GOBACK.
COBOL       ******************************************************************
COBOL        INITIALISATION.
COBOL
COBOL            MOVE  SPACE                   TO  ZONES-ALPHA.
COBOL            MOVE  ZERO                    TO  ZONES-NUMERIQUES.
COBOL            MOVE  ZERO                    TO  T-OPT.
COBOL            MOVE  ZERO                    TO  NB-OPT.
COBOL            MOVE  WHEN-COMPILED           TO  W-DATE-COMPILED.
COBOL
COBOL            DISPLAY ' '.
COBOL            DISPLAY '     CHARGEMENT DES OPTIONS EN MEMOIRE'.
COBOL            DISPLAY ' '.
COBOL            DISPLAY '** > ----+----1----+----2----+----3----+----4'
COBOL                         '----+----5----+----6----+----7----+----8'.
COBOL            DISPLAY ' '.
COBOL
COBOL       ******************************************************************
COBOL        ACCEPT-SYSIN.
COBOL            ADD   1                       TO  NB-SYSIN.
COBOL            MOVE  SPACE                   TO  W-SYSIN.
COBOL            ACCEPT  W-SYSIN             FROM  SYSIN.
COBOL
COBOL            IF (W-SYSIN = SPACE OR '/*') OR (I > MX-OPT)
COBOL                MOVE K-OUI                TO  W-FIN-SYSIN
COBOL            ELSE
COBOL            IF  (W-SYSIN-1 = '*')
COBOL            AND (NB-OPT < MAX-OPT)
COBOL                PERFORM DECOUPAGE-EN-MOT-CLE
COBOL                DISPLAY NB-SYSIN ' > ' W-SYSIN
COBOL            ELSE
COBOL                DISPLAY NB-SYSIN ' * ' W-SYSIN.
COBOL       *****************************************************************
COBOL        DECOUPAGE-EN-MOT-CLE.
COBOL            UNSTRING W-SYSIN-RESTE DELIMITED BY '='
COBOL            INTO W-MOT-CLE W-PARM1 W-PARM2 W-PARM3.
COBOL            IF  W-PARM1  NOT =  SPACE
COBOL                ADD 1                     TO NB-OPT
COBOL                MOVE W-MOT-CLE            TO OPT-MOTCLE(NB-OPT)
COBOL                MOVE W-PARM1              TO OPT-PARM  (NB-OPT)
COBOL                MOVE ZERO                 TO OPT-VALUE (NB-OPT)
COBOL                MOVE W-PARM1              TO W-MOT
COBOL                PERFORM BOUCLE-CALCUL
COBOL                VARYING I FROM 1 BY 1
COBOL                  UNTIL (I > 18)
COBOL                     OR (W-M(I) NOT NUMERIC).
COBOL       *****************************************************************
COBOL        BOUCLE-CALCUL.
COBOL            COMPUTE OPT-VALUE(NB-OPT) = 10 * OPT-VALUE(NB-OPT) + W-9(I).
COBOL       *******< FIN DU SOURCE : MSSOPT >*********************************
COBOL MEMBER NAME  MSSHEXA
COBOL        IDENTIFICATION DIVISION.
COBOL       ******************************************************************
COBOL       * MSOL                                                       IBM *
COBOL       ******************************************************************
COBOL       * TRANSFORMATION D'UNE VALEUR EN HEXA (MAX 50C DE LONG)          *
COBOL       ******************************************************************
COBOL        PROGRAM-ID.   MSSHEXA.
COBOL        AUTHOR.       MSOL.
COBOL       ******************************************************************
COBOL        ENVIRONMENT DIVISION.
COBOL        CONFIGURATION SECTION.
COBOL        SOURCE-COMPUTER. IBM-3090.
COBOL        OBJECT-COMPUTER. IBM-3090.
COBOL       ******************************************************************
COBOL        INPUT-OUTPUT SECTION.
COBOL        FILE-CONTROL.
COBOL       ******************************************************************
COBOL        DATA DIVISION.
COBOL       ******************************************************************
COBOL        FILE SECTION.
COBOL       ******************************************************************
COBOL        WORKING-STORAGE SECTION.
COBOL       *-----------------------*
COBOL        01  ZONES-TECHNIQUE.
COBOL            05  W-VALEUR.
COBOL                10  V  OCCURS 150      PIC  X(01).
COBOL            05  W-VALEUR-HEXA.
COBOL                10  VH OCCURS 300      PIC  X(01).
COBOL            05  I                      PIC  9(05) COMP VALUE ZERO.
COBOL            05  J                      PIC  9(05) COMP VALUE ZERO.
COBOL            05  K                      PIC  9(05) COMP VALUE ZERO.
COBOL            05  Q                      PIC  9(05) COMP VALUE ZERO.
COBOL            05  R                      PIC  9(05) COMP VALUE ZERO.
COBOL            05  II                     PIC  9(05) COMP VALUE ZERO.
COBOL       *----------------------------------------------------------------*
COBOL            COPY  MSCHEXA.
COBOL       ******************************************************************
COBOL        LINKAGE SECTION.
COBOL       *---------------*
COBOL        01  L-VALEUR                   PIC  X(150).
COBOL        01  L-VALEUR-HEXA              PIC  X(300).
COBOL        01  L-LONGUEUR                 PIC  9(005) COMP.
COBOL       ******************************************************************
COBOL        PROCEDURE DIVISION  USING  L-VALEUR
COBOL                                   L-VALEUR-HEXA
COBOL                                   L-LONGUEUR.
COBOL            IF  L-LONGUEUR = ZERO OR > LENGTH OF L-VALEUR
COBOL                NEXT SENTENCE
COBOL            ELSE
COBOL                PERFORM  FORMATE-VALEUR-HEXA.
COBOL            GOBACK.
COBOL       ******************************************************************
COBOL        FORMATE-VALEUR-HEXA.
COBOL       *-------------------*
COBOL            MOVE  ZERO               TO  J.
COBOL            MOVE  L-VALEUR           TO  W-VALEUR.
COBOL            PERFORM  TRANSFORME-OCTET
COBOL            VARYING  I  FROM  1  BY  1
COBOL              UNTIL  (I > L-LONGUEUR).
COBOL            MOVE  W-VALEUR-HEXA      TO  L-VALEUR-HEXA.
COBOL       ******************************************************************
COBOL        TRANSFORME-OCTET.
COBOL       *----------------*
COBOL            PERFORM  BOUCLE
COBOL            VARYING  II  FROM  1  BY  1
COBOL              UNTIL  (II > 255)
COBOL                 OR  (V(I) = TA(II)).
COBOL            COMPUTE II = II - 1.
COBOL            DIVIDE  II  BY  16  GIVING  Q  REMAINDER  R.
COBOL            ADD   1                  TO  Q R.
COBOL            ADD   1                  TO  J.
COBOL            MOVE  TH(Q)              TO  VH(J).
COBOL            ADD   1                  TO  J.
COBOL            MOVE  TH(R)              TO  VH(J).
COBOL       ******************************************************************
COBOL        BOUCLE.   EXIT.
COBOL       *******< FIN DU SOURCE : MSSHEXA >********************************
COBOL MEMBER NAME  MSSCOPY
COBOL        IDENTIFICATION DIVISION.
COBOL       ******************************************************************
COBOL       * MSOL                                                       IBM *
COBOL       ******************************************************************
COBOL       * EVOLUTION DU 10/01/2002                                        *
COBOL       * -----------------------                                        *
COBOL       * SI A L APPEL DE MSSCOPY LE PARAMETRE COMMENCE PAR              *
COBOL       * "COPY=XXXXXXXX"                                                *
COBOL       * LE MODULE NE LIT PAS LE FICHIER "FCOPY" MAIS LE MEMBRE         *
COBOL       * "XXXXXXXX" DU PDS CORRESPONDANT AU DDNAME "PDS"                *
COBOL       ******************************************************************
COBOL       * SOUS-PROGRAMME D'ANALYSE D'UN COPY                             *
COBOL       *                                                                *
COBOL       * LIMITE                                                         *
COBOL       * ------                                                         *
COBOL       * 1500 RUBRIQUES DIFFERENTES (Y COMPRIS LES OCCURS)              *
COBOL       *  ATTENTION  POUR MODIFIER LE NOMBRE DE RUBRIQUES         *
COBOL       * POSSIBLES ILF FAUT : AGRANDIR LE TABLEAU DANS MSCCOPY          *
COBOL       *                      MODIFIER LA LIMITE DANS MSCCONST          *
COBOL       *                      AJUSTER LE TABLEAU W-OCC-OCCURS           *
COBOL       *                      DANS CE PROGRAMME.                        *
COBOL       *----------------------------------------------------------------*
COBOL       * FICHIER                                                        *
COBOL       * -------                                                        *
COBOL       * FCOPY        COPY COBOL A ANALYSER                             *
COBOL       ******************************************************************
COBOL        PROGRAM-ID.   MSSCOPY.
COBOL        AUTHOR.       MSOL.
COBOL       ******************************************************************
COBOL        ENVIRONMENT DIVISION.
COBOL        CONFIGURATION SECTION.
COBOL        SOURCE-COMPUTER. IBM-3090.
COBOL        OBJECT-COMPUTER. IBM-3090.
COBOL       ******************************************************************
COBOL        INPUT-OUTPUT SECTION.
COBOL        FILE-CONTROL.
COBOL            SELECT  F-COPY  ASSIGN TO  FCOPY
COBOL               FILE STATUS FS.
COBOL       *****************************************************************
COBOL        DATA DIVISION.
COBOL       *****************************************************************
COBOL        FILE SECTION.
COBOL        FD  F-COPY    LABEL RECORD IS STANDARD
COBOL            BLOCK CONTAINS 0 RECORDS.
COBOL        01  F-COPY-ENR           PIC  X(0080).
COBOL
COBOL       ******************************************************************
COBOL        WORKING-STORAGE SECTION.
COBOL            COPY  MSCCONST.
COBOL            COPY  MSCPICT.
COBOL       ******************************************************************
COBOL        01  ZONES-ALPHA.
COBOL            05  FS                     PIC  X(02).
COBOL            05  W-CHAR                 PIC  X(01).
COBOL            05  W-NUMERIQUE            PIC  X(01).
COBOL                88  TOP-NUMERIQUE    VALUE  'O'.
COBOL            05  W-NOUVEAU              PIC  X(01).
COBOL                88  TOP-NOUVEAU      VALUE  'O'.
COBOL            05  W-REDEFINES            PIC  X(01).
COBOL                88  TOP-REDEFINES    VALUE  'O'.
COBOL            05  W-DEPEND               PIC  X(01).
COBOL                88  TOP-DEPEND       VALUE  'O'.
COBOL            05  W-OCCURS               PIC  X(01).
COBOL                88  TOP-OCCURS       VALUE  'O'.
COBOL            05  W-FIN                  PIC  X(01).
COBOL                88  FIN-FICHIER      VALUE  'O'.
COBOL            05  W-MOT-PIC              PIC  X(01).
COBOL                88  MOT-PIC          VALUE  'O'.
COBOL            05  W-MOT-LEADING          PIC  X(01).
COBOL                88  MOT-LEADING      VALUE  'O'.
COBOL            05  W-MOT-TRAILING         PIC  X(01).
COBOL                88  MOT-TRAILING     VALUE  'O'.
COBOL            05  W-MOT-SEPARATE         PIC  X(01).
COBOL                88  MOT-SEPARATE     VALUE  'O'.
COBOL            05  W-MOT-COMP             PIC  X(01).
COBOL                88  MOT-COMP         VALUE  'O'.
COBOL            05  W-MOT-OCCURS           PIC  X(01).
COBOL                88  MOT-OCCURS       VALUE  'O'.
COBOL            05  W-MOT-REDEFINES        PIC  X(01).
COBOL                88  MOT-REDEFINES    VALUE  'O'.
COBOL            05  W-MOT-DEPENDING        PIC  X(01).
COBOL                88  MOT-DEPENDING    VALUE  'O'.
COBOL            05  W-NOM-DEPENDING        PIC  X(30).
COBOL            05  LIGNE-COBOL.
COBOL                10 L-NO                PIC  X(06).
COBOL                10 L-COMMENT           PIC  X(01).
COBOL                   88 COMMENTAIRE    VALUE '*'.
COBOL                   88 SUITE-VALUE    VALUE '-'.
COBOL                   88 LIGNE-OK       VALUE '/' ' '.
COBOL                10 L-RESTE.
COBOL                   15 L  OCCURS 65     PIC  X(01).
COBOL                10 F                   PIC  X(08).
COBOL            05  W-MOT.
COBOL                10  W-M  OCCURS 30     PIC  X(01).
COBOL            05  T-MOT.
COBOL                10  T    OCCURS 20     PIC  X(30).
COBOL            05  TT-MOT.
COBOL                10  TT   OCCURS 20     PIC  X(30).
COBOL            05  W-OCC-OCCURS-G.
COBOL                10  W-OCC-OCCURS       PIC X OCCURS 1500.
COBOL       ******************************************************************
COBOL        01  ZONES-NUMERIQUES.
COBOL            05  W-DATE                 PIC  9(06).
COBOL            05  II                     PIC  9(05).
COBOL            05  I                      PIC  9(05).
COBOL            05  J                      PIC  9(05).
COBOL            05  K                      PIC  9(05).
COBOL            05  Q                      PIC  9(05).
COBOL            05  R                      PIC  9(05).
COBOL            05  LG-OCC                 PIC  9(05).
COBOL            05  NB-OCC                 PIC  9(04).
COBOL            05  I-OCC                  PIC  9(04).
COBOL            05  W-POS                  PIC  9(05).
COBOL            05  W-LG                   PIC  9(05).
COBOL            05  W-LG-OCC               PIC  9(05).
COBOL            05  W-NB-VIRG              PIC  9(04).
COBOL            05  W-IRUB                 PIC  9(04).
COBOL            05  W-FRUB                 PIC  9(04).
COBOL            05  I-LEVEL-OCCURS         PIC  9(01).
COBOL            05  I-LEVEL-REDEF          PIC  9(01).
COBOL            05  W-PIL-OCCURS           OCCURS 5.
COBOL                10  W-POS-OCCURS           PIC  9(05).
COBOL                10  W-NBO-OCCURS           PIC  9(04).
COBOL                10  W-IRU-OCCURS           PIC  9(04).
COBOL                10  W-DEP-OCCURS           PIC  X.
COBOL                10  W-NIV-OCCURS           PIC  9(02).
COBOL            05  W-POS-REDEF            PIC  9(05)  OCCURS 5.
COBOL            05  W-NIV-REDEF            PIC  9(02)  OCCURS 5.
COBOL            05  W-NIVEAU               PIC  9(02).
COBOL            05  N1-2  REDEFINES  W-NIVEAU.
COBOL                10  N1  PIC  X.
COBOL                10  N2  PIC  X.
COBOL       ******************************************************************
COBOL        LINKAGE SECTION.
COBOL            COPY  MSCCOPY.
COBOL       ******************************************************************
COBOL        PROCEDURE DIVISION  USING  PARAM-MSSCOPY.
COBOL
COBOL            PERFORM  INITIALISATION.
COBOL
COBOL            MOVE  CST-NON             TO  W-FIN.
COBOL            PERFORM  ANALYSE-COPY
COBOL              UNTIL  FIN-FICHIER.
COBOL
COBOL            IF  TOP-REDEFINES
COBOL                PERFORM DEPILE-REDEF
COBOL                  UNTIL (I-LEVEL-REDEF = 1).
COBOL            COMPUTE  LG-COPY = W-POS - 1.
COBOL
COBOL            IF  TOP-DEPENDING = CST-OUI
COBOL                MOVE  1               TO  I
COBOL                PERFORM  AVANCE
COBOL                  UNTIL  I > NB-RUB
COBOL                     OR  RUB-NOM(I) = W-NOM-DEPENDING
COBOL                IF  I NOT > NB-RUB
COBOL                    MOVE  I           TO  I-DEPENDING
COBOL                ELSE
COBOL                    MOVE  CST-NON     TO  TOP-DEPENDING
COBOL                    MOVE  8           TO  RETURN-CODE
COBOL                    DISPLAY 'MSSCOPY: PB OCCURS DEPENDING - '
COBOL                            'RUBRIQUE MAITRE NON TROUVEE'.
COBOL
COBOL            PERFORM LONGUEUR-RUB-SANS-PICTURE
COBOL            VARYING I FROM 1 BY 1
COBOL              UNTIL I > NB-RUB.
COBOL
COBOL        STOP-RUN.
COBOL       **********
COBOL            PERFORM  FERMETURE-FICHIER.
COBOL            GOBACK.
COBOL       *****************************************************************
COBOL        INITIALISATION.
COBOL            INITIALIZE PARAM-MSSCOPY.
COBOL            MOVE  ZERO                TO  ZONES-NUMERIQUES.
COBOL            MOVE  SPACE               TO  ZONES-ALPHA.
COBOL            MOVE  SPACE               TO  W-MSCPICT.
COBOL            MOVE  CST-NON             TO  TOP-DEPENDING.
COBOL            MOVE  1                   TO  W-POS.
COBOL            MOVE  1                   TO  I-LEVEL-OCCURS
COBOL            MOVE  1                   TO  I-LEVEL-REDEF
COBOL            ACCEPT W-DATE           FROM  DATE.
COBOL            OPEN  INPUT   F-COPY.
COBOL            IF (FS NOT = ZERO)
COBOL               DISPLAY 'MSSCOPY: OUVERTURE COPY IMPOSSIBLE ' FS
COBOL               MOVE 12                TO RETURN-CODE
COBOL               GOBACK
COBOL            END-IF.
COBOL       *****************************************************************
COBOL        FERMETURE-FICHIER.
COBOL            CLOSE  F-COPY.
COBOL       *****************************************************************
COBOL        LIRE-COPY.
COBOL            READ  F-COPY  INTO  LIGNE-COBOL
COBOL            AT END
COBOL                MOVE  CST-OUI         TO  W-FIN.
COBOL            MOVE ZERO                 TO  I.
COBOL            INSPECT LIGNE-COBOL TALLYING I FOR ALL ' SKIP'.
COBOL            INSPECT LIGNE-COBOL TALLYING I FOR ALL ' EJECT'.
COBOL            IF  I > ZERO
COBOL                MOVE SPACE            TO  LIGNE-COBOL.
COBOL       *****************************************************************
COBOL        ANALYSE-COPY.
COBOL            PERFORM  LIRE-COPY.
COBOL            IF  NOT FIN-FICHIER
COBOL            AND LIGNE-OK
COBOL            AND (L-RESTE NOT = SPACE)
COBOL                MOVE  SPACE           TO  T-MOT W-MOT
COBOL                MOVE  1               TO  I J K
COBOL                PERFORM  DECOUPAGE-EN-MOT
COBOL                  UNTIL  (J > MAX-MOT)
COBOL                     OR  (L(I) = '.')
COBOL                     OR  FIN-FICHIER
COBOL                PERFORM  FORMATE-NIVEAU
COBOL                PERFORM  RE-POSITIONNEMENT-DES-MOTS
COBOL                IF  (W-NIVEAU  NUMERIC)
COBOL                AND (W-NIVEAU NOT = 66 AND 88)
COBOL                    PERFORM  TRAITE-LIGNE-COPY
COBOL                ELSE NEXT SENTENCE
COBOL            ELSE
COBOL            IF  FIN-FICHIER  AND  TOP-OCCURS
COBOL                PERFORM DUPLIQUE-OCCURS UNTIL NOT TOP-OCCURS.
COBOL       *****************************************************************
COBOL        TRAITE-LIGNE-COPY.
COBOL            IF  W-NIVEAU = 01 OR 77
COBOL                MOVE 1                TO W-POS.
COBOL            IF  NB-RUB  NOT <  MAX-RUB
COBOL                DISPLAY 'MSSCOPY: DEBORDEMENT TABLEAU RUBRIQUE - '
COBOL                        MAX-RUB
COBOL                MOVE  8               TO  RETURN-CODE
COBOL                GO TO STOP-RUN.
COBOL            IF  TOP-OCCURS
COBOL            AND (W-NIVEAU  NOT >  W-NIV-OCCURS(1))
COBOL                PERFORM DUPLIQUE-OCCURS UNTIL NOT TOP-OCCURS
COBOL                   OR (W-NIVEAU > W-NIV-OCCURS(1)).
COBOL            IF  TOP-REDEFINES
COBOL                PERFORM DEPILE-REDEF
COBOL                  UNTIL (I-LEVEL-REDEF = 1)
COBOL                     OR (W-NIVEAU > W-NIV-REDEF(1)).
COBOL            IF  MOT-DEPENDING
COBOL                MOVE  CST-OUI         TO  W-DEPEND.
COBOL            IF  MOT-OCCURS
COBOL                PERFORM EMPILE-OCCURS
COBOL                MOVE  W-POS           TO  W-POS-OCCURS(1)
COBOL                MOVE  CST-OUI         TO  W-OCCURS
COBOL       *        MOVE  CST-NON         TO  W-NOUVEAU
COBOL                MOVE  W-NIVEAU        TO  W-NIV-OCCURS(1)
COBOL                COMPUTE  W-IRUB = NB-RUB + 1
COBOL                MOVE  W-IRUB          TO  W-IRU-OCCURS(1)
COBOL                MOVE  1               TO  RUB-OCCURS(W-IRUB)
COBOL                PERFORM  CALCULE-NB-OCC
COBOL                MOVE  NB-OCC          TO  W-NBO-OCCURS(1)
COBOL                MOVE  W-DEPEND        TO  W-DEP-OCCURS(1)
COBOL                IF  MOT-DEPENDING
COBOL                    MOVE  CST-OUI     TO  RUB-DEPENDING(W-IRUB).
COBOL            IF  MOT-REDEFINES
COBOL                PERFORM  EMPILE-REDEF
COBOL                PERFORM  RECHERCHE-POSITION
COBOL                MOVE  CST-NON         TO  W-NOUVEAU
COBOL                MOVE  CST-OUI         TO  W-REDEFINES
COBOL                MOVE  W-NIVEAU        TO  W-NIV-REDEF(1).
COBOL            IF  MOT-PIC
COBOL                PERFORM  ANALYSE-RUBRIQUE
COBOL            ELSE
COBOL                ADD   1               TO  NB-RUB
COBOL                MOVE  W-POS           TO  RUB-POS(NB-RUB)
COBOL                MOVE  T(1)            TO  RUB-NOM(NB-RUB)
COBOL                MOVE  W-NIVEAU        TO  RUB-NIVEAU(NB-RUB)
COBOL                .
COBOL       *        IF  TOP-REDEFINES  AND  TOP-NOUVEAU
COBOL       *        AND (W-NIVEAU  NOT >  W-NIV-REDEF(1))
COBOL       *            PERFORM DEPILE-REDEF
COBOL       *            IF  I-LEVEL-REDEF = 1
COBOL       *                MOVE  CST-NON TO  W-REDEFINES.
COBOL            IF  TOP-REDEFINES
COBOL                MOVE  'R'             TO  RUB-REDEF(NB-RUB)
COBOL            ELSE
COBOL                MOVE  ' '             TO  RUB-REDEF(NB-RUB).
COBOL            IF  TOP-OCCURS
COBOL                MOVE  1               TO  RUB-OCCURS(NB-RUB).
COBOL            IF  TOP-DEPEND
COBOL                MOVE  CST-OUI         TO  RUB-DEPENDING(NB-RUB).
COBOL            MOVE  CST-OUI             TO  W-NOUVEAU.
COBOL       *    IF  MOT-PIC AND MOT-REDEFINES
COBOL       *        PERFORM DEPILE-REDEF
COBOL       *        IF  I-LEVEL-REDEF = 1
COBOL       *            MOVE CST-NON      TO  W-REDEFINES.
COBOL       *****************************************************************
COBOL        DECOUPAGE-EN-MOT.
COBOL
COBOL       *> RECHERCHE PREMIER CARACTERE NON BLANC SUR LA LIGNE
COBOL            PERFORM  AVANCE
COBOL              UNTIL  (I > LG-LIG-COBOL)
COBOL                 OR  (L(I) NOT = SPACE).
COBOL
COBOL       *> DECOUPAGE DES MOTS DE LA LIGNE
COBOL            PERFORM  DECOUPAGE
COBOL              UNTIL  (L(I) = '.')
COBOL                 OR  (I > LG-LIG-COBOL)
COBOL                 OR  (J > MAX-MOT).
COBOL
COBOL            IF  L(I) = '.'
COBOL                MOVE  W-MOT           TO  T(J).
COBOL
COBOL       *> S'IL N'Y A PAS DE POINT SUR LA LIGNE, LECTURE LIGNES SUIVANTES
COBOL            IF  (I > LG-LIG-COBOL)
COBOL                PERFORM  LIRE-COPY
COBOL                PERFORM  LIRE-COPY
COBOL                  UNTIL  FIN-FICHIER
COBOL                     OR (L-RESTE NOT = SPACE AND NOT COMMENTAIRE)
COBOL                MOVE  SPACE           TO  W-MOT
COBOL                MOVE  1               TO  I.
COBOL
COBOL       *> DEBORDEMENT TABLEAU DES MOTS
COBOL            IF  J > MAX-MOT
COBOL                DISPLAY 'MSSCOPY: $$ERR  TROP DE MOT DANS UNE PHRASE'
COBOL                        T-MOT
COBOL                MOVE  12              TO  RETURN-CODE
COBOL                STOP  RUN.
COBOL       *****************************************************************
COBOL        AVANCE.
COBOL            ADD  1                    TO  I.
COBOL       *****************************************************************
COBOL        DECOUPAGE.
COBOL            IF  L(I) = SPACE OR '.'
COBOL                MOVE  W-MOT           TO  T(J)
COBOL                MOVE  SPACE           TO  W-MOT
COBOL                MOVE  1               TO  K
COBOL                ADD   1               TO  J
COBOL                PERFORM  AVANCE
COBOL                  UNTIL  (I > LG-LIG-COBOL)
COBOL                     OR  (L(I) NOT = SPACE)
COBOL            ELSE
COBOL                MOVE  L(I)            TO  W-M(K)
COBOL                ADD   1               TO  K
COBOL                ADD   1               TO  I.
COBOL       *****************************************************************
COBOL        ANALYSE-RUBRIQUE.
COBOL       *    IF  TOP-REDEFINES  AND  TOP-NOUVEAU
COBOL       *    AND (W-NIVEAU NOT > W-NIV-REDEF(1))
COBOL       *        PERFORM DEPILE-REDEF
COBOL       *        IF  I-LEVEL-REDEF = 1
COBOL       *            MOVE  CST-NON     TO  W-REDEFINES.
COBOL       *> SUITE ANALYSE
COBOL            ADD   1                   TO  NB-RUB.
COBOL            MOVE  W-POS               TO  RUB-POS(NB-RUB)
COBOL            MOVE  T(1)                TO  RUB-NOM(NB-RUB).
COBOL            MOVE  W-NIVEAU            TO  RUB-NIVEAU(NB-RUB).
COBOL            IF  MOT-PIC
COBOL                MOVE  T(3)            TO  W-MOT
COBOL                PERFORM  ANALYSE-PICTURE
COBOL                MOVE  W-LG            TO  RUB-LG(NB-RUB).
COBOL            IF  TOP-OCCURS
COBOL                MOVE  1               TO  RUB-OCCURS(NB-RUB).
COBOL            IF  TOP-DEPEND
COBOL                MOVE  CST-OUI         TO  RUB-DEPENDING(NB-RUB).
COBOL            ADD   W-LG                TO  W-POS.
COBOL            PERFORM  FORMATE-PICTURE.
COBOL       *****************************************************************
COBOL        FORMATE-NIVEAU.
COBOL            MOVE  T(1)                TO  N1-2.
COBOL            IF  N2 = SPACE
COBOL                MOVE  N1              TO  N2
COBOL                MOVE  ZERO            TO  N1.
COBOL       *****************************************************************
COBOL        CALCULE-NB-OCC.
COBOL            MOVE  1                   TO  I.
COBOL            MOVE  ZERO                TO  K.
COBOL            MOVE  T(9)                TO  W-MOT.
COBOL            PERFORM  EXTRACTION
COBOL              UNTIL  W-M(I) = SPACE.
COBOL            MOVE  K                   TO  NB-OCC.
COBOL       *****************************************************************
COBOL        DUPLIQUE-OCCURS.
COBOL                IF  TOP-REDEFINES
COBOL                AND (W-NIV-REDEF(1) > W-NIV-OCCURS(1))
COBOL                    PERFORM DEPILE-REDEF
COBOL                        UNTIL (I-LEVEL-REDEF = 1)
COBOL                        OR NOT (W-NIV-REDEF(1) > W-NIV-OCCURS(1)).
COBOL                MOVE  NB-RUB          TO  W-FRUB
COBOL                MOVE  ZERO            TO  W-LG-OCC
COBOL                COMPUTE  LG-OCC = W-POS - W-POS-OCCURS(1)
COBOL                PERFORM  DUPLIQUE-ZONES-OCCURS
COBOL                VARYING  I  FROM  2  BY  1
COBOL                  UNTIL  I  >  W-NBO-OCCURS(1)
COBOL                PERFORM DEPILE-OCCURS.
COBOL       *****************************************************************
COBOL        DUPLIQUE-ZONES-OCCURS.
COBOL            ADD  LG-OCC               TO  W-LG-OCC.
COBOL            PERFORM  DUPLIQUE-RUBRIQUE
COBOL            VARYING  J  FROM  W-IRU-OCCURS(1)  BY  1
COBOL              UNTIL  J  >  W-FRUB.
COBOL            ADD  LG-OCC               TO  W-POS.
COBOL       *****************************************************************
COBOL        DUPLIQUE-RUBRIQUE.
COBOL            IF  NB-RUB  NOT <  MAX-RUB
COBOL                DISPLAY 'MSSCOPY: DEBORDEMENT TABLEAU RUBRIQUE - '
COBOL                        MAX-RUB
COBOL                MOVE  8               TO  RETURN-CODE
COBOL                GO TO STOP-RUN.
COBOL            IF  RUB-PICTURE(J)  NOT =  SPACE  AND  ZERO
COBOL                ADD   1               TO  NB-RUB
COBOL                MOVE  T-RUB(J)        TO  T-RUB(NB-RUB)
COBOL                MOVE  I               TO  I-OCC
COBOL                COMPUTE RUB-POS(NB-RUB) = RUB-POS(J) + W-LG-OCC
COBOL                MOVE 'X'              TO  W-OCC-OCCURS(NB-RUB)
COBOL                IF  W-OCC-OCCURS(J) = ' '
COBOL                    MOVE  I-OCC           TO  RUB-OCCURS(NB-RUB).
COBOL            IF I = W-NBO-OCCURS(1)
COBOL                MOVE 'X'              TO  W-OCC-OCCURS(J).
COBOL       *****************************************************************
COBOL        ANALYSE-PICTURE.
COBOL            MOVE  1                   TO  I.
COBOL            MOVE  1                   TO  W-LG.
COBOL            MOVE  CST-NON             TO  RUB-SIGNE(NB-RUB).
COBOL            MOVE  CST-NON             TO  RUB-VIRG (NB-RUB).
COBOL            MOVE  CST-NON             TO  RUB-COMP (NB-RUB).
COBOL       *> DETERMINATION SI LA ZONE EST SIGNEE
COBOL            IF  W-M(1)  =  'S'
COBOL                MOVE  R-SIGN          TO  RUB-SIGNE(NB-RUB)
COBOL                MOVE  2               TO  I
COBOL                IF  MOT-LEADING AND MOT-SEPARATE
COBOL                    MOVE  R-SIGN-LEAD-SEP  TO  RUB-SIGNE(NB-RUB)
COBOL                ELSE IF  MOT-TRAILING AND MOT-SEPARATE
COBOL                    MOVE  R-SIGN-TRAIL-SEP TO  RUB-SIGNE(NB-RUB)
COBOL                ELSE IF  MOT-LEADING
COBOL                    MOVE  R-SIGN-LEAD      TO  RUB-SIGNE(NB-RUB)
COBOL                ELSE IF  MOT-TRAILING
COBOL                    MOVE  R-SIGN-TRAIL     TO  RUB-SIGNE(NB-RUB).
COBOL       *> TYPE DE LA ZONE '9' OU 'X' OU 'A'
COBOL            MOVE  W-M(I)              TO  RUB-TYPE (NB-RUB).
COBOL            IF  W-M(I) = 'V'
COBOL                MOVE  '9'             TO  RUB-TYPE (NB-RUB)
COBOL                MOVE  ZERO            TO  W-LG
COBOL            ELSE
COBOL                ADD   1               TO  I.
COBOL       *> EXTRACTION DE LA LONGUEUR
COBOL            IF  W-M(I)  = '('
COBOL                ADD   1               TO  I
COBOL                MOVE  ZERO            TO  K
COBOL                PERFORM  EXTRACTION
COBOL                  UNTIL  W-M(I) = ')'
COBOL                MOVE  K               TO  W-LG
COBOL       *> COMPTAGE DE LA LONGUEUR
COBOL            ELSE
COBOL            IF  W-M(I)  =  RUB-TYPE(NB-RUB)
COBOL                PERFORM  COMPTAGE
COBOL                  UNTIL (W-M(I)  =  SPACE  OR  'V').
COBOL       *> LA ZONE COMPORTE-T-ELLE UNE VIRGULE
COBOL            IF  RUB-TYPE(NB-RUB) = '9'
COBOL                MOVE  1               TO  I
COBOL                PERFORM  AVANCE
COBOL                  UNTIL  (I > 20)
COBOL                     OR  (W-M(I) = SPACE OR 'V')
COBOL                IF  W-M(I) = 'V'
COBOL                    MOVE  CST-OUI     TO  RUB-VIRG(NB-RUB)
COBOL                    MOVE  ZERO        TO  RUB-NB-VIRG(NB-RUB)
COBOL                    ADD   1           TO  I
COBOL                    COMPUTE  J  =  I + 1
COBOL                    IF  W-M(J)  =  '9'
COBOL                        PERFORM  COMPTAGE-VIRGULE
COBOL                          UNTIL  W-M(I)  NOT =  '9'
COBOL                    ELSE  IF  W-M(J) = '('
COBOL                        ADD   2       TO  I
COBOL                        MOVE  ZERO    TO  K
COBOL                        PERFORM  EXTRACTION
COBOL                          UNTIL  W-M(I) = ')'
COBOL                        MOVE  K       TO  RUB-NB-VIRG(NB-RUB)
COBOL                        ADD   K       TO  W-LG
COBOL                    ELSE  IF  W-M(I) = SPACE
COBOL                        MOVE  CST-NON TO  RUB-VIRG(NB-RUB)
COBOL                    ELSE
COBOL                        MOVE  1       TO  RUB-NB-VIRG(NB-RUB)
COBOL                        ADD   1       TO  W-LG.
COBOL            MOVE  W-LG                TO  RUB-N9(NB-RUB).
COBOL            IF  MOT-SEPARATE
COBOL                ADD  1                TO  W-LG.
COBOL       *> DETERMINATION SI LA ZONE EST EN COMP
COBOL            IF  T(4) = C-COMP-3 OR C-COMPUTATIONAL-3
COBOL                MOVE  R-COMP-3        TO  RUB-COMP(NB-RUB)
COBOL                PERFORM  CALCULE-LG-COMP-3
COBOL            ELSE
COBOL            IF  T(4) = C-COMP OR C-COMPUTATIONAL
COBOL                MOVE  R-COMP          TO  RUB-COMP(NB-RUB)
COBOL                PERFORM  CALCULE-LG-COMP.
COBOL       *****************************************************************
COBOL        EXTRACTION.
COBOL            MOVE  W-M(I)              TO  J.
COBOL            COMPUTE  K  =  10 * K  +  J.
COBOL            ADD   1              TO  I.
COBOL       *****************************************************************
COBOL        COMPTAGE.
COBOL            ADD   1                   TO  W-LG.
COBOL            ADD   1                   TO  I.
COBOL       *****************************************************************
COBOL        COMPTAGE-VIRGULE.
COBOL            ADD   1                   TO  W-LG.
COBOL            ADD   1                   TO  I.
COBOL            ADD   1                   TO  RUB-NB-VIRG(NB-RUB).
COBOL       *****************************************************************
COBOL        CALCULE-LG-COMP-3.
COBOL       *$$  IF  RUB-SIGNE(NB-RUB) = CST-OUI
COBOL                ADD   1               TO  W-LG.
COBOL            DIVIDE  W-LG  BY  2  GIVING  Q  REMAINDER  R.
COBOL            COMPUTE  W-LG  =  Q  +  R.
COBOL       *****************************************************************
COBOL        CALCULE-LG-COMP.
COBOL            IF  W-LG  <  5
COBOL                MOVE  2               TO  W-LG
COBOL            ELSE
COBOL            IF  W-LG  <  10
COBOL                MOVE  4               TO  W-LG
COBOL            ELSE
COBOL                MOVE  8               TO  W-LG.
COBOL       *****************************************************************
COBOL        EMPILE-REDEF.
COBOL            ADD   1                   TO  I-LEVEL-REDEF.
COBOL            MOVE  W-POS-REDEF(1)      TO  W-POS-REDEF(I-LEVEL-REDEF).
COBOL            MOVE  W-NIV-REDEF(1)      TO  W-NIV-REDEF(I-LEVEL-REDEF).
COBOL       *****************************************************************
COBOL        DEPILE-REDEF.
COBOL            MOVE  W-POS-REDEF(1)             TO W-POS
COBOL            MOVE  W-POS-REDEF(I-LEVEL-REDEF) TO W-POS-REDEF(1).
COBOL            MOVE  W-NIV-REDEF(I-LEVEL-REDEF) TO W-NIV-REDEF(1).
COBOL            SUBTRACT 1              FROM  I-LEVEL-REDEF.
COBOL            IF  I-LEVEL-REDEF = 1
COBOL                MOVE CST-NON                 TO W-REDEFINES.
COBOL       *****************************************************************
COBOL        EMPILE-OCCURS.
COBOL            ADD   1                   TO  I-LEVEL-OCCURS.
COBOL            MOVE  W-PIL-OCCURS(1)     TO  W-PIL-OCCURS(I-LEVEL-OCCURS).
COBOL       *****************************************************************
COBOL        DEPILE-OCCURS.
COBOL            MOVE  W-PIL-OCCURS(I-LEVEL-OCCURS) TO W-PIL-OCCURS(1).
COBOL            SUBTRACT 1              FROM  I-LEVEL-OCCURS.
COBOL            IF  I-LEVEL-OCCURS = 1
COBOL                MOVE SPACE                   TO W-OCC-OCCURS-G
COBOL                MOVE CST-NON                 TO W-OCCURS
COBOL                MOVE CST-NON                 TO W-DEPEND
COBOL            ELSE
COBOL                MOVE W-DEP-OCCURS(1)         TO W-DEPEND.
COBOL       *****************************************************************
COBOL        FORMATE-PICTURE.
COBOL            MOVE  SPACE               TO  W-MSCPICT.
COBOL            MOVE  '('                 TO  W-PIC-PARG1.
COBOL            MOVE  ')'                 TO  W-PIC-PARD1.
COBOL            IF  RUB-TYPE(NB-RUB) = 'X'
COBOL                MOVE  'X'             TO  W-PIC-TYPE
COBOL                MOVE  RUB-LG(NB-RUB)  TO  W-PIC-LG
COBOL            ELSE
COBOL                PERFORM  FORMATE-PIC-9.
COBOL            MOVE  W-MSCPICT           TO  RUB-PICTURE(NB-RUB).
COBOL       *****************************************************************
COBOL        FORMATE-PIC-9.
COBOL            MOVE  '9'                 TO  W-PIC-TYPE.
COBOL            IF  RUB-SIGNE(NB-RUB) NOT = CST-NON
COBOL                MOVE  'S'             TO  W-PIC-SIGNE.
COBOL            IF  RUB-COMP(NB-RUB)  = R-COMP-3
COBOL                MOVE  C-COMP-3        TO  W-PIC-COMP
COBOL            ELSE
COBOL            IF  RUB-COMP(NB-RUB)  = R-COMP
COBOL                MOVE  C-COMP          TO  W-PIC-COMP
COBOL            ELSE
COBOL            IF  RUB-SIGNE(NB-RUB) = R-SIGN-LEAD
COBOL                MOVE  'LEAD'          TO  W-PIC-COMP
COBOL            ELSE
COBOL            IF  RUB-SIGNE(NB-RUB) = R-SIGN-LEAD-SEP
COBOL                MOVE  'LS'            TO  W-PIC-COMP
COBOL            ELSE
COBOL            IF  RUB-SIGNE(NB-RUB) = R-SIGN-TRAIL-SEP
COBOL                MOVE  'TS'            TO  W-PIC-COMP.
COBOL            IF  RUB-VIRG(NB-RUB)  = CST-OUI
COBOL                MOVE  '9'             TO  W-PIC-TYPE2
COBOL                MOVE  '('             TO  W-PIC-PARG2
COBOL                MOVE  ')'             TO  W-PIC-PARD2
COBOL                MOVE  'V'             TO  W-PIC-VIRG
COBOL                MOVE  RUB-NB-VIRG2(NB-RUB)  TO  W-PIC-NBV
COBOL                COMPUTE  II = RUB-N9(NB-RUB) - RUB-NB-VIRG(NB-RUB)
COBOL            ELSE
COBOL                MOVE  RUB-N9(NB-RUB)  TO  II.
COBOL            MOVE  II                  TO  W-PIC-LG.
COBOL       *****************************************************************
COBOL        RECHERCHE-POSITION.
COBOL            MOVE  W-POS               TO  W-POS-REDEF(1).
COBOL            MOVE  1                   TO  I.
COBOL            PERFORM  AVANCE
COBOL              UNTIL  (I > NB-RUB)
COBOL                 OR  (RUB-NOM(I) = T(6)).
COBOL            IF  I  >  NB-RUB
COBOL                DISPLAY  'MSSCOPY: PB REDEFINES - ' T(6)
COBOL                GO TO  STOP-RUN
COBOL            ELSE
COBOL                MOVE  RUB-POS(I)      TO  W-POS.
COBOL       *****************************************************************
COBOL        LONGUEUR-RUB-SANS-PICTURE.
COBOL            IF  RUB-PICTURE(I) = SPACE OR ZERO
COBOL                MOVE  SPACE           TO  RUB-PICTURE(I)
COBOL                MOVE  CST-NON         TO  RUB-SIGNE(I)
COBOL                MOVE  ZERO            TO  RUB-OCCURS(I)
COBOL                MOVE  'X'             TO  RUB-TYPE(I)
COBOL            IF  RUB-NIVEAU(I) = 01
COBOL                MOVE  LG-COPY         TO  RUB-LG(I)
COBOL            ELSE
COBOL                MOVE  ZERO            TO  RUB-LG(I)
COBOL                MOVE  I               TO  J
COBOL                ADD   1               TO  J
COBOL                MOVE  RUB-POS(J)      TO  RUB-POS(I)
COBOL                PERFORM CUMUL-LG-NIVEAU-INFERIEUR
COBOL                  UNTIL (J > NB-RUB)
COBOL                     OR (RUB-NIVEAU(J) NOT > RUB-NIVEAU(I)).
COBOL       *****************************************************************
COBOL        CUMUL-LG-NIVEAU-INFERIEUR.
COBOL            IF  RUB-REDEF(I) = RUB-REDEF(J)
COBOL                ADD RUB-LG(J)         TO RUB-LG(I).
COBOL            ADD 1                     TO J.
COBOL       *****************************************************************
COBOL        RECHERCHE-MOT-CLE.
COBOL            ADD   1                   TO  J.
COBOL            ADD   1                   TO  K.
COBOL            IF  TT(I) = C-PIC OR C-PICTURE
COBOL                MOVE  CST-OUI         TO  W-MOT-PIC
COBOL                MOVE  C-PIC           TO  T(2)
COBOL                IF  TT(J) = C-COMP OR C-COMP-3
COBOL                OR C-COMPUTATIONAL OR C-COMPUTATIONAL-3
COBOL                    MOVE  TT(K)       TO  T(3)
COBOL                ELSE
COBOL                    MOVE  TT(J)       TO  T(3)
COBOL            ELSE
COBOL            IF  TT(I) = C-COMP       OR C-COMPUTATIONAL
COBOL                MOVE  CST-OUI         TO  W-MOT-COMP
COBOL                MOVE  C-COMP          TO  T(4)
COBOL            ELSE
COBOL            IF  TT(I) = C-COMP-3 OR C-COMPUTATIONAL-3
COBOL                MOVE  CST-OUI         TO  W-MOT-COMP
COBOL                MOVE  C-COMP-3        TO  T(4)
COBOL            ELSE
COBOL            IF  TT(I) = C-REDEFINES
COBOL                MOVE  CST-OUI         TO  W-MOT-REDEFINES
COBOL                MOVE  C-REDEFINES     TO  T(5)
COBOL                MOVE  TT(J)           TO  T(6)
COBOL            ELSE
COBOL            IF  TT(I) = C-OCCURS
COBOL                MOVE  CST-OUI         TO  W-MOT-OCCURS
COBOL                MOVE  C-OCCURS        TO  T(7)
COBOL                MOVE  TT(J)           TO  T(8)
COBOL                MOVE  TT(J)           TO  T(9)
COBOL            ELSE
COBOL            IF  TT(I) = C-LEADING
COBOL                MOVE  CST-OUI         TO  W-MOT-LEADING
COBOL            ELSE
COBOL            IF  TT(I) = C-TRAILING
COBOL                MOVE  CST-OUI         TO  W-MOT-TRAILING
COBOL            ELSE
COBOL            IF  TT(I) = C-SEPARATE
COBOL                MOVE  CST-OUI         TO  W-MOT-SEPARATE
COBOL            ELSE
COBOL            IF  TT(I) = C-TO
COBOL                MOVE  TT(J)           TO  T(9)
COBOL            ELSE
COBOL            IF  TT(I) = C-DEPENDING
COBOL                MOVE  CST-OUI         TO  W-MOT-DEPENDING
COBOL                MOVE  CST-OUI         TO  TOP-DEPENDING
COBOL                MOVE  C-DEPENDING     TO  T(10)
COBOL                IF  TT(J) = C-ON
COBOL                    MOVE  TT(K)       TO  W-NOM-DEPENDING
COBOL                    MOVE  TT(K)       TO  T(11)
COBOL                ELSE
COBOL                    MOVE  TT(J)       TO  W-NOM-DEPENDING
COBOL                    MOVE  TT(J)       TO  T(11).
COBOL       *****************************************************************
COBOL        RE-POSITIONNEMENT-DES-MOTS.
COBOL            MOVE  CST-NON             TO  W-MOT-PIC.
COBOL            MOVE  CST-NON             TO  W-MOT-OCCURS.
COBOL            MOVE  CST-NON             TO  W-MOT-REDEFINES.
COBOL            MOVE  CST-NON             TO  W-MOT-DEPENDING.
COBOL            MOVE  CST-NON             TO  W-MOT-COMP.
COBOL            MOVE  CST-NON             TO  W-MOT-LEADING.
COBOL            MOVE  CST-NON             TO  W-MOT-TRAILING.
COBOL            MOVE  CST-NON             TO  W-MOT-SEPARATE.
COBOL            MOVE  3                   TO  J.
COBOL            MOVE  4                   TO  K.
COBOL            MOVE  T-MOT               TO  TT-MOT.
COBOL            MOVE  SPACE               TO  T-MOT.
COBOL            MOVE  TT(2)               TO  T(1).
COBOL            PERFORM  RECHERCHE-MOT-CLE
COBOL            VARYING  I  FROM  3  BY  1
COBOL              UNTIL (I  >  MAX-MOT)
COBOL                 OR (TT(I) = SPACE).
COBOL       *    DISPLAY '==> ' T-MOT.
COBOL       *    DISPLAY 'PIC ' W-MOT-PIC.
COBOL       *    DISPLAY 'OCC ' W-MOT-OCCURS.
COBOL       *    DISPLAY 'RED ' W-MOT-REDEFINES.
COBOL       *    DISPLAY 'DEP ' W-MOT-DEPENDING.
COBOL       *    DISPLAY 'CMP ' W-MOT-COMP.
COBOL       *******< FIN DU SOURCE : MSSCOPY >*******************************
COBOL MEMBER NAME  MSSFORM
COBOL        IDENTIFICATION DIVISION.
COBOL       ******************************************************************
COBOL       * MSOL                                                       IBM *
COBOL       ******************************************************************
COBOL       * SOUS-PROGRAMME DE MISE EN FORME D'UNE RUBRIQUE                 *
COBOL       ******************************************************************
COBOL        PROGRAM-ID.   MSSFORM.
COBOL        AUTHOR.       MSOL.
COBOL       ******************************************************************
COBOL        ENVIRONMENT DIVISION.
COBOL        CONFIGURATION SECTION.
COBOL        SOURCE-COMPUTER. IBM-3090.
COBOL        OBJECT-COMPUTER. IBM-3090.
COBOL       ******************************************************************
COBOL        INPUT-OUTPUT SECTION.
COBOL        FILE-CONTROL.
COBOL       ******************************************************************
COBOL        DATA DIVISION.
COBOL       ******************************************************************
COBOL        FILE SECTION.
COBOL       ******************************************************************
COBOL        WORKING-STORAGE SECTION.
COBOL       ******************************************************************
COBOL            COPY  MSCCONST.
COBOL            COPY  MSCHEXA.
COBOL       *----------------------------------------------------------------*
COBOL        01  ZONES-ALPHA.
COBOL            05  W-NUMERIQUE            PIC  X(01).
COBOL                88  TOP-NUMERIQUE  VALUE  'O'.
COBOL            05  W-NOUVEAU              PIC  X(01).
COBOL                88  TOP-NOUVEAU    VALUE  'O'.
COBOL       *----------------------------------------------------------------*
COBOL        01  ZONES-NUMERIQUES.
COBOL            05  W-POS                  PIC  9(04).
COBOL            05  W-LG                   PIC  9(04).
COBOL            05  WW-POS                 PIC  9(05).
COBOL            05  WW-LG                  PIC  9(05).
COBOL            05  I                      PIC  9(04).
COBOL            05  J                      PIC  9(04).
COBOL            05  K                      PIC  9(04).
COBOL       ******************************************************************
COBOL        LINKAGE SECTION.
COBOL            COPY  MSCCOPY.
COBOL            COPY  MSCFORM.
COBOL        01  UT1-REC PIC X(32760).
COBOL
COBOL       ******************************************************************
COBOL        PROCEDURE DIVISION  USING  PARAM-MSSCOPY
COBOL                                   PARAM-MSSFORM
COBOL                                   UT1-REC.
COBOL
COBOL            IF  RUB-PICTURE(MSCFORM-RUB)  NOT = SPACE   AND  ZERO
COBOL                PERFORM INITIALISATION
COBOL                PERFORM FORMATE-VALEUR.
COBOL            GOBACK.
COBOL
COBOL       ******************************************************************
COBOL        INITIALISATION.
COBOL            MOVE ZERO                        TO ZONES-NUMERIQUES.
COBOL            MOVE SPACE                       TO ZONES-ALPHA.
COBOL            MOVE MSCFORM-RUB                 TO K.
COBOL
COBOL       ******************************************************************
COBOL        FORMATE-VALEUR.
COBOL            MOVE CST-NON                     TO W-NUMERIQUE.
COBOL            IF (RUB-TYPE(K) = '9')
COBOL               PERFORM TEST-NUMERICITE
COBOL               IF TOP-NUMERIQUE
COBOL                  PERFORM TEST-SIGNE
COBOL                  PERFORM TRANSFORME-FORMAT
COBOL                  PERFORM MISE-EN-FORME
COBOL                  IF MSCFORM-ZERO = CST-OUI
COBOL                     PERFORM TRANSFORME-ZERO-EN-SPACE
COBOL                     VARYING I FROM 1 BY 1
COBOL                       UNTIL I > 18
COBOL                          OR V(I) = SPACE
COBOL                  ELSE NEXT SENTENCE
COBOL               ELSE
COBOL                  PERFORM FORMATE-VALEUR-HEXA
COBOL                  MOVE C-NON-NUMERIQUE       TO MSCFORM-VALEUR
COBOL            ELSE
COBOL               IF MSCFORM-VALEUR = SPACE
COBOL                  MOVE 'ESPACE'              TO MSCFORM-VALEUR-HEXA
COBOL               ELSE
COBOL                  PERFORM FORMATE-VALEUR-HEXA
COBOL               END-IF
COBOL            END-IF.
COBOL
COBOL       ******************************************************************
COBOL        FORMATE-VALEUR-HEXA.
COBOL            MOVE ZERO                        TO J.
COBOL
COBOL       ******************************************************************
COBOL        MISE-EN-FORME.
COBOL            MOVE RUB-N9(K)                   TO W-LG.
COBOL            IF  RUB-SIGNE(K)  NOT = CST-NON
COBOL                MOVE W-LG                    TO I
COBOL                MOVE 1                       TO W-POS
COBOL                PERFORM DECALAGE
COBOL                  UNTIL  I  <  W-POS
COBOL                ADD   1                      TO W-LG
COBOL                MOVE MSCFORM-SIGNE           TO V(1).
COBOL
COBOL            IF  RUB-VIRG(K) = CST-OUI
COBOL                MOVE W-LG                    TO I
COBOL                COMPUTE  W-POS = 1 + W-LG - RUB-NB-VIRG(K)
COBOL                PERFORM DECALAGE
COBOL                  UNTIL  I  <  W-POS
COBOL                MOVE ','                     TO V(W-POS).
COBOL
COBOL       ******************************************************************
COBOL        TRANSFORME-ZERO-EN-SPACE.
COBOL            COMPUTE  J = I - 1.
COBOL            COMPUTE  K = I + 1.
COBOL            IF  (V(I) = '0')
COBOL            AND ((J = 0) OR (V(J) = ' ' OR '-' OR '+'))
COBOL            AND (V(K) NOT = SPACE AND ',' AND '.')
COBOL                MOVE SPACE                   TO V(I).
COBOL
COBOL       ******************************************************************
COBOL        DECALAGE.
COBOL            COMPUTE  J = I + 1.
COBOL            MOVE V(I)                        TO V(J).
COBOL            COMPUTE  I = I - 1.
COBOL
COBOL       ******************************************************************
COBOL        TEST-NUMERICITE.
COBOL            MOVE ZERO                        TO MSCFORM-NUM.
COBOL            IF  (RUB-SIGNE(K) = CST-NON)
COBOL            AND (RUB-COMP(K) = CST-NON)
COBOL                PERFORM TEST-9
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = R-SIGN)
COBOL            AND (RUB-COMP(K) = CST-NON)
COBOL                PERFORM TEST-S9
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K)  NOT = CST-NON)
COBOL            AND (RUB-COMP(K) = R-COMP-3)
COBOL                PERFORM TEST-S9C3
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = CST-NON)
COBOL            AND (RUB-COMP(K) = R-COMP-3)
COBOL                PERFORM TEST-9C3
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K)  NOT = CST-NON)
COBOL            AND (RUB-COMP(K) = R-COMP)
COBOL                PERFORM TEST-S9C
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = CST-NON)
COBOL            AND (RUB-COMP(K) = R-COMP)
COBOL                PERFORM TEST-9C
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = R-SIGN-LEAD)
COBOL            AND (RUB-COMP(K) = CST-NON)
COBOL                PERFORM TEST-SL9
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = R-SIGN-LEAD-SEP)
COBOL            AND (RUB-COMP(K) = CST-NON)
COBOL                PERFORM TEST-SLS9
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = R-SIGN-TRAIL-SEP)
COBOL            AND (RUB-COMP(K) = CST-NON)
COBOL                PERFORM TEST-STS9.
COBOL       ******************************************************************
COBOL        TEST-SIGNE.
COBOL            IF  (RUB-SIGNE(K)  NOT = CST-NON)
COBOL            IF  (RUB-COMP(K) = R-COMP-3)
COBOL                PERFORM SIGNE-S9C3
COBOL            ELSE
COBOL            IF  (RUB-COMP(K) = R-COMP)
COBOL                PERFORM SIGNE-S9C
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = R-SIGN)
COBOL                PERFORM SIGNE-S9
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = R-SIGN-LEAD)
COBOL                PERFORM SIGNE-SL9
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = R-SIGN-LEAD-SEP)
COBOL                PERFORM SIGNE-SLS9
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = R-SIGN-TRAIL-SEP)
COBOL                PERFORM SIGNE-STS9.
COBOL       ******************************************************************
COBOL        TRANSFORME-FORMAT.
COBOL            IF  (RUB-SIGNE(K)  NOT = CST-NON)
COBOL            AND (RUB-COMP(K) = R-COMP-3)
COBOL                PERFORM FORMAT-S9C3
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = CST-NON)
COBOL            AND (RUB-COMP(K) = R-COMP-3)
COBOL                PERFORM FORMAT-9C3
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K)  NOT = CST-NON)
COBOL            AND (RUB-COMP(K) = R-COMP)
COBOL                PERFORM FORMAT-S9C
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = CST-NON)
COBOL            AND (RUB-COMP(K) = R-COMP)
COBOL                PERFORM FORMAT-9C
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = CST-NON)
COBOL            AND (RUB-COMP(K) = CST-NON)
COBOL                PERFORM FORMAT-9
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = R-SIGN)
COBOL            AND (RUB-COMP(K) = CST-NON)
COBOL                PERFORM FORMAT-S9
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = R-SIGN-LEAD)
COBOL            AND (RUB-COMP(K) = CST-NON)
COBOL                PERFORM FORMAT-SL9
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = R-SIGN-LEAD-SEP)
COBOL            AND (RUB-COMP(K) = CST-NON)
COBOL                PERFORM FORMAT-SLS9
COBOL            ELSE
COBOL            IF  (RUB-SIGNE(K) = R-SIGN-TRAIL-SEP)
COBOL            AND (RUB-COMP(K) = CST-NON)
COBOL                PERFORM FORMAT-STS9.
COBOL       ******************************************************************
COBOL        TEST-S9C3.
COBOL            IF  ((RUB-N9(K) = 1) AND (RS9C3-1   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 2) AND (RS9C3-2   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 3) AND (RS9C3-3   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 4) AND (RS9C3-4   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 5) AND (RS9C3-5   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 6) AND (RS9C3-6   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 7) AND (RS9C3-7   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 8) AND (RS9C3-8   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 9) AND (RS9C3-9   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 10) AND (RS9C3-10 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 11) AND (RS9C3-11 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 12) AND (RS9C3-12 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 13) AND (RS9C3-13 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 14) AND (RS9C3-14 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 15) AND (RS9C3-15 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 16) AND (RS9C3-16 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 17) AND (RS9C3-17 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 18) AND (RS9C3-18 NUMERIC))
COBOL                MOVE CST-OUI            TO W-NUMERIQUE.
COBOL       ******************************************************************
COBOL        TEST-9C3.
COBOL            IF  ((RUB-N9(K) = 1) AND (R9C3-1   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 2) AND (R9C3-2   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 3) AND (R9C3-3   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 4) AND (R9C3-4   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 5) AND (R9C3-5   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 6) AND (R9C3-6   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 7) AND (R9C3-7   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 8) AND (R9C3-8   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 9) AND (R9C3-9   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 10) AND (R9C3-10 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 11) AND (R9C3-11 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 12) AND (R9C3-12 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 13) AND (R9C3-13 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 14) AND (R9C3-14 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 15) AND (R9C3-15 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 16) AND (R9C3-16 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 17) AND (R9C3-17 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 18) AND (R9C3-18 NUMERIC))
COBOL                MOVE CST-OUI            TO W-NUMERIQUE.
COBOL       ******************************************************************
COBOL        TEST-S9C.
COBOL                MOVE CST-OUI            TO W-NUMERIQUE.
COBOL       ******************************************************************
COBOL        TEST-9C.
COBOL                MOVE CST-OUI            TO W-NUMERIQUE.
COBOL       ******************************************************************
COBOL        TEST-S9.
COBOL            IF  ((RUB-N9(K) = 1) AND (RS9-1   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 2) AND (RS9-2   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 3) AND (RS9-3   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 4) AND (RS9-4   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 5) AND (RS9-5   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 6) AND (RS9-6   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 7) AND (RS9-7   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 8) AND (RS9-8   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 9) AND (RS9-9   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 10) AND (RS9-10 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 11) AND (RS9-11 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 12) AND (RS9-12 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 13) AND (RS9-13 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 14) AND (RS9-14 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 15) AND (RS9-15 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 16) AND (RS9-16 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 17) AND (RS9-17 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 18) AND (RS9-18 NUMERIC))
COBOL                MOVE CST-OUI            TO W-NUMERIQUE.
COBOL       ******************************************************************
COBOL        TEST-SL9.
COBOL            IF  ((RUB-N9(K) = 1) AND (RSL9-1   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 2) AND (RSL9-2   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 3) AND (RSL9-3   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 4) AND (RSL9-4   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 5) AND (RSL9-5   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 6) AND (RSL9-6   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 7) AND (RSL9-7   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 8) AND (RSL9-8   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 9) AND (RSL9-9   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 10) AND (RSL9-10 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 11) AND (RSL9-11 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 12) AND (RSL9-12 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 13) AND (RSL9-13 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 14) AND (RSL9-14 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 15) AND (RSL9-15 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 16) AND (RSL9-16 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 17) AND (RSL9-17 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 18) AND (RSL9-18 NUMERIC))
COBOL                MOVE CST-OUI            TO W-NUMERIQUE.
COBOL       ******************************************************************
COBOL        TEST-SLS9.
COBOL            IF  ((RUB-N9(K) = 1) AND (RSLS9-1   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 2) AND (RSLS9-2   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 3) AND (RSLS9-3   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 4) AND (RSLS9-4   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 5) AND (RSLS9-5   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 6) AND (RSLS9-6   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 7) AND (RSLS9-7   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 8) AND (RSLS9-8   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 9) AND (RSLS9-9   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 10) AND (RSLS9-10 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 11) AND (RSLS9-11 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 12) AND (RSLS9-12 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 13) AND (RSLS9-13 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 14) AND (RSLS9-14 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 15) AND (RSLS9-15 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 16) AND (RSLS9-16 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 17) AND (RSLS9-17 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 18) AND (RSLS9-18 NUMERIC))
COBOL                MOVE CST-OUI            TO W-NUMERIQUE.
COBOL       ******************************************************************
COBOL        TEST-STS9.
COBOL            IF  ((RUB-N9(K) = 1) AND (RSTS9-1   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 2) AND (RSTS9-2   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 3) AND (RSTS9-3   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 4) AND (RSTS9-4   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 5) AND (RSTS9-5   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 6) AND (RSTS9-6   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 7) AND (RSTS9-7   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 8) AND (RSTS9-8   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 9) AND (RSTS9-9   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 10) AND (RSTS9-10 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 11) AND (RSTS9-11 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 12) AND (RSTS9-12 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 13) AND (RSTS9-13 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 14) AND (RSTS9-14 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 15) AND (RSTS9-15 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 16) AND (RSTS9-16 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 17) AND (RSTS9-17 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 18) AND (RSTS9-18 NUMERIC))
COBOL                MOVE CST-OUI            TO W-NUMERIQUE.
COBOL       ******************************************************************
COBOL        TEST-9.
COBOL            IF  ((RUB-N9(K) = 1) AND (R9-1   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 2) AND (R9-2   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 3) AND (R9-3   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 4) AND (R9-4   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 5) AND (R9-5   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 6) AND (R9-6   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 7) AND (R9-7   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 8) AND (R9-8   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 9) AND (R9-9   NUMERIC))
COBOL            OR  ((RUB-N9(K) = 10) AND (R9-10 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 11) AND (R9-11 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 12) AND (R9-12 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 13) AND (R9-13 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 14) AND (R9-14 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 15) AND (R9-15 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 16) AND (R9-16 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 17) AND (R9-17 NUMERIC))
COBOL            OR  ((RUB-N9(K) = 18) AND (R9-18 NUMERIC))
COBOL                MOVE CST-OUI            TO W-NUMERIQUE.
COBOL       ******************************************************************
COBOL        SIGNE-S9C3.
COBOL            IF  ((RUB-N9(K) = 1) AND (RS9C3-1   < ZERO))
COBOL            OR  ((RUB-N9(K) = 2) AND (RS9C3-2   < ZERO))
COBOL            OR  ((RUB-N9(K) = 3) AND (RS9C3-3   < ZERO))
COBOL            OR  ((RUB-N9(K) = 4) AND (RS9C3-4   < ZERO))
COBOL            OR  ((RUB-N9(K) = 5) AND (RS9C3-5   < ZERO))
COBOL            OR  ((RUB-N9(K) = 6) AND (RS9C3-6   < ZERO))
COBOL            OR  ((RUB-N9(K) = 7) AND (RS9C3-7   < ZERO))
COBOL            OR  ((RUB-N9(K) = 8) AND (RS9C3-8   < ZERO))
COBOL            OR  ((RUB-N9(K) = 9) AND (RS9C3-9   < ZERO))
COBOL            OR  ((RUB-N9(K) = 10) AND (RS9C3-10 < ZERO))
COBOL            OR  ((RUB-N9(K) = 11) AND (RS9C3-11 < ZERO))
COBOL            OR  ((RUB-N9(K) = 12) AND (RS9C3-12 < ZERO))
COBOL            OR  ((RUB-N9(K) = 13) AND (RS9C3-13 < ZERO))
COBOL            OR  ((RUB-N9(K) = 14) AND (RS9C3-14 < ZERO))
COBOL            OR  ((RUB-N9(K) = 15) AND (RS9C3-15 < ZERO))
COBOL            OR  ((RUB-N9(K) = 16) AND (RS9C3-16 < ZERO))
COBOL            OR  ((RUB-N9(K) = 17) AND (RS9C3-17 < ZERO))
COBOL            OR  ((RUB-N9(K) = 18) AND (RS9C3-18 < ZERO))
COBOL                MOVE '-'                TO MSCFORM-SIGNE
COBOL            ELSE
COBOL                MOVE '+'                TO MSCFORM-SIGNE.
COBOL       ******************************************************************
COBOL        SIGNE-S9C.
COBOL            IF  ((RUB-N9(K) = 1) AND (RS9C-1   < ZERO))
COBOL            OR  ((RUB-N9(K) = 2) AND (RS9C-2   < ZERO))
COBOL            OR  ((RUB-N9(K) = 3) AND (RS9C-3   < ZERO))
COBOL            OR  ((RUB-N9(K) = 4) AND (RS9C-4   < ZERO))
COBOL            OR  ((RUB-N9(K) = 5) AND (RS9C-5   < ZERO))
COBOL            OR  ((RUB-N9(K) = 6) AND (RS9C-6   < ZERO))
COBOL            OR  ((RUB-N9(K) = 7) AND (RS9C-7   < ZERO))
COBOL            OR  ((RUB-N9(K) = 8) AND (RS9C-8   < ZERO))
COBOL            OR  ((RUB-N9(K) = 9) AND (RS9C-9   < ZERO))
COBOL            OR  ((RUB-N9(K) = 10) AND (RS9C-10 < ZERO))
COBOL            OR  ((RUB-N9(K) = 11) AND (RS9C-11 < ZERO))
COBOL            OR  ((RUB-N9(K) = 12) AND (RS9C-12 < ZERO))
COBOL            OR  ((RUB-N9(K) = 13) AND (RS9C-13 < ZERO))
COBOL            OR  ((RUB-N9(K) = 14) AND (RS9C-14 < ZERO))
COBOL            OR  ((RUB-N9(K) = 15) AND (RS9C-15 < ZERO))
COBOL            OR  ((RUB-N9(K) = 16) AND (RS9C-16 < ZERO))
COBOL            OR  ((RUB-N9(K) = 17) AND (RS9C-17 < ZERO))
COBOL            OR  ((RUB-N9(K) = 18) AND (RS9C-18 < ZERO))
COBOL                MOVE '-'                TO MSCFORM-SIGNE
COBOL            ELSE
COBOL                MOVE '+'                TO MSCFORM-SIGNE.
COBOL       ******************************************************************
COBOL        SIGNE-S9.
COBOL            IF  ((RUB-N9(K) = 1) AND (RS9-1   < ZERO))
COBOL            OR  ((RUB-N9(K) = 2) AND (RS9-2   < ZERO))
COBOL            OR  ((RUB-N9(K) = 3) AND (RS9-3   < ZERO))
COBOL            OR  ((RUB-N9(K) = 4) AND (RS9-4   < ZERO))
COBOL            OR  ((RUB-N9(K) = 5) AND (RS9-5   < ZERO))
COBOL            OR  ((RUB-N9(K) = 6) AND (RS9-6   < ZERO))
COBOL            OR  ((RUB-N9(K) = 7) AND (RS9-7   < ZERO))
COBOL            OR  ((RUB-N9(K) = 8) AND (RS9-8   < ZERO))
COBOL            OR  ((RUB-N9(K) = 9) AND (RS9-9   < ZERO))
COBOL            OR  ((RUB-N9(K) = 10) AND (RS9-10 < ZERO))
COBOL            OR  ((RUB-N9(K) = 11) AND (RS9-11 < ZERO))
COBOL            OR  ((RUB-N9(K) = 12) AND (RS9-12 < ZERO))
COBOL            OR  ((RUB-N9(K) = 13) AND (RS9-13 < ZERO))
COBOL            OR  ((RUB-N9(K) = 14) AND (RS9-14 < ZERO))
COBOL            OR  ((RUB-N9(K) = 15) AND (RS9-15 < ZERO))
COBOL            OR  ((RUB-N9(K) = 16) AND (RS9-16 < ZERO))
COBOL            OR  ((RUB-N9(K) = 17) AND (RS9-17 < ZERO))
COBOL            OR  ((RUB-N9(K) = 18) AND (RS9-18 < ZERO))
COBOL                MOVE '-'                TO MSCFORM-SIGNE
COBOL            ELSE
COBOL                MOVE '+'                TO MSCFORM-SIGNE.
COBOL       ******************************************************************
COBOL        SIGNE-SL9.
COBOL            IF  ((RUB-N9(K) = 1) AND (RSL9-1   < ZERO))
COBOL            OR  ((RUB-N9(K) = 2) AND (RSL9-2   < ZERO))
COBOL            OR  ((RUB-N9(K) = 3) AND (RSL9-3   < ZERO))
COBOL            OR  ((RUB-N9(K) = 4) AND (RSL9-4   < ZERO))
COBOL            OR  ((RUB-N9(K) = 5) AND (RSL9-5   < ZERO))
COBOL            OR  ((RUB-N9(K) = 6) AND (RSL9-6   < ZERO))
COBOL            OR  ((RUB-N9(K) = 7) AND (RSL9-7   < ZERO))
COBOL            OR  ((RUB-N9(K) = 8) AND (RSL9-8   < ZERO))
COBOL            OR  ((RUB-N9(K) = 9) AND (RSL9-9   < ZERO))
COBOL            OR  ((RUB-N9(K) = 10) AND (RSL9-10 < ZERO))
COBOL            OR  ((RUB-N9(K) = 11) AND (RSL9-11 < ZERO))
COBOL            OR  ((RUB-N9(K) = 12) AND (RSL9-12 < ZERO))
COBOL            OR  ((RUB-N9(K) = 13) AND (RSL9-13 < ZERO))
COBOL            OR  ((RUB-N9(K) = 14) AND (RSL9-14 < ZERO))
COBOL            OR  ((RUB-N9(K) = 15) AND (RSL9-15 < ZERO))
COBOL            OR  ((RUB-N9(K) = 16) AND (RSL9-16 < ZERO))
COBOL            OR  ((RUB-N9(K) = 17) AND (RSL9-17 < ZERO))
COBOL            OR  ((RUB-N9(K) = 18) AND (RSL9-18 < ZERO))
COBOL                MOVE '-'                TO MSCFORM-SIGNE
COBOL            ELSE
COBOL                MOVE '+'                TO MSCFORM-SIGNE.
COBOL       ******************************************************************
COBOL        SIGNE-SLS9.
COBOL            IF  ((RUB-N9(K) = 1) AND (RSLS9-1   < ZERO))
COBOL            OR  ((RUB-N9(K) = 2) AND (RSLS9-2   < ZERO))
COBOL            OR  ((RUB-N9(K) = 3) AND (RSLS9-3   < ZERO))
COBOL            OR  ((RUB-N9(K) = 4) AND (RSLS9-4   < ZERO))
COBOL            OR  ((RUB-N9(K) = 5) AND (RSLS9-5   < ZERO))
COBOL            OR  ((RUB-N9(K) = 6) AND (RSLS9-6   < ZERO))
COBOL            OR  ((RUB-N9(K) = 7) AND (RSLS9-7   < ZERO))
COBOL            OR  ((RUB-N9(K) = 8) AND (RSLS9-8   < ZERO))
COBOL            OR  ((RUB-N9(K) = 9) AND (RSLS9-9   < ZERO))
COBOL            OR  ((RUB-N9(K) = 10) AND (RSLS9-10 < ZERO))
COBOL            OR  ((RUB-N9(K) = 11) AND (RSLS9-11 < ZERO))
COBOL            OR  ((RUB-N9(K) = 12) AND (RSLS9-12 < ZERO))
COBOL            OR  ((RUB-N9(K) = 13) AND (RSLS9-13 < ZERO))
COBOL            OR  ((RUB-N9(K) = 14) AND (RSLS9-14 < ZERO))
COBOL            OR  ((RUB-N9(K) = 15) AND (RSLS9-15 < ZERO))
COBOL            OR  ((RUB-N9(K) = 16) AND (RSLS9-16 < ZERO))
COBOL            OR  ((RUB-N9(K) = 17) AND (RSLS9-17 < ZERO))
COBOL            OR  ((RUB-N9(K) = 18) AND (RSLS9-18 < ZERO))
COBOL                MOVE '-'                TO MSCFORM-SIGNE
COBOL            ELSE
COBOL                MOVE '+'                TO MSCFORM-SIGNE.
COBOL       ******************************************************************
COBOL        SIGNE-STS9.
COBOL            IF  ((RUB-N9(K) = 1) AND (RSTS9-1   < ZERO))
COBOL            OR  ((RUB-N9(K) = 2) AND (RSTS9-2   < ZERO))
COBOL            OR  ((RUB-N9(K) = 3) AND (RSTS9-3   < ZERO))
COBOL            OR  ((RUB-N9(K) = 4) AND (RSTS9-4   < ZERO))
COBOL            OR  ((RUB-N9(K) = 5) AND (RSTS9-5   < ZERO))
COBOL            OR  ((RUB-N9(K) = 6) AND (RSTS9-6   < ZERO))
COBOL            OR  ((RUB-N9(K) = 7) AND (RSTS9-7   < ZERO))
COBOL            OR  ((RUB-N9(K) = 8) AND (RSTS9-8   < ZERO))
COBOL            OR  ((RUB-N9(K) = 9) AND (RSTS9-9   < ZERO))
COBOL            OR  ((RUB-N9(K) = 10) AND (RSTS9-10 < ZERO))
COBOL            OR  ((RUB-N9(K) = 11) AND (RSTS9-11 < ZERO))
COBOL            OR  ((RUB-N9(K) = 12) AND (RSTS9-12 < ZERO))
COBOL            OR  ((RUB-N9(K) = 13) AND (RSTS9-13 < ZERO))
COBOL            OR  ((RUB-N9(K) = 14) AND (RSTS9-14 < ZERO))
COBOL            OR  ((RUB-N9(K) = 15) AND (RSTS9-15 < ZERO))
COBOL            OR  ((RUB-N9(K) = 16) AND (RSTS9-16 < ZERO))
COBOL            OR  ((RUB-N9(K) = 17) AND (RSTS9-17 < ZERO))
COBOL            OR  ((RUB-N9(K) = 18) AND (RSTS9-18 < ZERO))
COBOL                MOVE '-'                TO MSCFORM-SIGNE
COBOL            ELSE
COBOL                MOVE '+'                TO MSCFORM-SIGNE.
COBOL       ******************************************************************
COBOL        FORMAT-S9C3.
COBOL            IF  (RUB-N9(K) = 1)
COBOL                MOVE RS9C3-1            TO V9-1
COBOL                MOVE V9-1               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 2)
COBOL                MOVE RS9C3-2            TO V9-2
COBOL                MOVE V9-2               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 3)
COBOL                MOVE RS9C3-3            TO V9-3
COBOL                MOVE V9-3               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 4)
COBOL                MOVE RS9C3-4            TO V9-4
COBOL                MOVE V9-4               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 5)
COBOL                MOVE RS9C3-5            TO V9-5
COBOL                MOVE V9-5               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 6)
COBOL                MOVE RS9C3-6            TO V9-6
COBOL                MOVE V9-6               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 7)
COBOL                MOVE RS9C3-7            TO V9-7
COBOL                MOVE V9-7               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 8)
COBOL                MOVE RS9C3-8            TO V9-8
COBOL                MOVE V9-8               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 9)
COBOL                MOVE RS9C3-9            TO V9-9
COBOL                MOVE V9-9               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 10)
COBOL                MOVE RS9C3-10           TO V9-10
COBOL                MOVE V9-10              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 11)
COBOL                MOVE RS9C3-11           TO V9-11
COBOL                MOVE V9-11              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 12)
COBOL                MOVE RS9C3-12           TO V9-12
COBOL                MOVE V9-12              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 13)
COBOL                MOVE RS9C3-13           TO V9-13
COBOL                MOVE V9-13              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 14)
COBOL                MOVE RS9C3-14           TO V9-14
COBOL                MOVE V9-14              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 15)
COBOL                MOVE RS9C3-15           TO V9-15
COBOL                MOVE V9-15              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 16)
COBOL                MOVE RS9C3-16           TO V9-16
COBOL                MOVE V9-16              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 17)
COBOL                MOVE RS9C3-17           TO V9-17
COBOL                MOVE V9-17              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 18)
COBOL                MOVE RS9C3-18           TO V9-18
COBOL                MOVE V9-18              TO MSCFORM-VALEUR MSCFORM-NUM.
COBOL       ******************************************************************
COBOL        FORMAT-9C3.
COBOL            IF  (RUB-N9(K) = 1)
COBOL                MOVE R9C3-1             TO V9-1
COBOL                MOVE V9-1               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 2)
COBOL                MOVE R9C3-2             TO V9-2
COBOL                MOVE V9-2               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 3)
COBOL                MOVE R9C3-3             TO V9-3
COBOL                MOVE V9-3               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 4)
COBOL                MOVE R9C3-4             TO V9-4
COBOL                MOVE V9-4               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 5)
COBOL                MOVE R9C3-5             TO V9-5
COBOL                MOVE V9-5               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 6)
COBOL                MOVE R9C3-6             TO V9-6
COBOL                MOVE V9-6               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 7)
COBOL                MOVE R9C3-7             TO V9-7
COBOL                MOVE V9-7               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 8)
COBOL                MOVE R9C3-8             TO V9-8
COBOL                MOVE V9-8               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 9)
COBOL                MOVE R9C3-9             TO V9-9
COBOL                MOVE V9-9               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 10)
COBOL                MOVE R9C3-10            TO V9-10
COBOL                MOVE V9-10              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 11)
COBOL                MOVE R9C3-11            TO V9-11
COBOL                MOVE V9-11              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 12)
COBOL                MOVE R9C3-12            TO V9-12
COBOL                MOVE V9-12              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 13)
COBOL                MOVE R9C3-13            TO V9-13
COBOL                MOVE V9-13              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 14)
COBOL                MOVE R9C3-14            TO V9-14
COBOL                MOVE V9-14              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 15)
COBOL                MOVE R9C3-15            TO V9-15
COBOL                MOVE V9-15              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 16)
COBOL                MOVE R9C3-16            TO V9-16
COBOL                MOVE V9-16              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 17)
COBOL                MOVE R9C3-17            TO V9-17
COBOL                MOVE V9-17              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 18)
COBOL                MOVE R9C3-18            TO V9-18
COBOL                MOVE V9-18              TO MSCFORM-VALEUR MSCFORM-NUM.
COBOL       ******************************************************************
COBOL        FORMAT-S9C.
COBOL            IF  (RUB-N9(K) = 1)
COBOL                MOVE RS9C-1             TO V9-1
COBOL                MOVE V9-1               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 2)
COBOL                MOVE RS9C-2             TO V9-2
COBOL                MOVE V9-2               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 3)
COBOL                MOVE RS9C-3             TO V9-3
COBOL                MOVE V9-3               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 4)
COBOL                MOVE RS9C-4             TO V9-4
COBOL                MOVE V9-4               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 5)
COBOL                MOVE RS9C-5             TO V9-5
COBOL                MOVE V9-5               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 6)
COBOL                MOVE RS9C-6             TO V9-6
COBOL                MOVE V9-6               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 7)
COBOL                MOVE RS9C-7             TO V9-7
COBOL                MOVE V9-7               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 8)
COBOL                MOVE RS9C-8             TO V9-8
COBOL                MOVE V9-8               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 9)
COBOL                MOVE RS9C-9             TO V9-9
COBOL                MOVE V9-9               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 10)
COBOL                MOVE RS9C-10            TO V9-10
COBOL                MOVE V9-10              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 11)
COBOL                MOVE RS9C-11            TO V9-11
COBOL                MOVE V9-11              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 12)
COBOL                MOVE RS9C-12            TO V9-12
COBOL                MOVE V9-12              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 13)
COBOL                MOVE RS9C-13            TO V9-13
COBOL                MOVE V9-13              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 14)
COBOL                MOVE RS9C-14            TO V9-14
COBOL                MOVE V9-14              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 15)
COBOL                MOVE RS9C-15            TO V9-15
COBOL                MOVE V9-15              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 16)
COBOL                MOVE RS9C-16            TO V9-16
COBOL                MOVE V9-16              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 17)
COBOL                MOVE RS9C-17            TO V9-17
COBOL                MOVE V9-17              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 18)
COBOL                MOVE RS9C-18            TO V9-18
COBOL                MOVE V9-18              TO MSCFORM-VALEUR MSCFORM-NUM.
COBOL       ******************************************************************
COBOL        FORMAT-9C.
COBOL            IF  (RUB-N9(K) = 1)
COBOL                MOVE R9C-1              TO V9-1
COBOL                MOVE V9-1               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 2)
COBOL                MOVE R9C-2              TO V9-2
COBOL                MOVE V9-2               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 3)
COBOL                MOVE R9C-3              TO V9-3
COBOL                MOVE V9-3               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 4)
COBOL                MOVE R9C-4              TO V9-4
COBOL                MOVE V9-4               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 5)
COBOL                MOVE R9C-5              TO V9-5
COBOL                MOVE V9-5               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 6)
COBOL                MOVE R9C-6              TO V9-6
COBOL                MOVE V9-6               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 7)
COBOL                MOVE R9C-7              TO V9-7
COBOL                MOVE V9-7               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 8)
COBOL                MOVE R9C-8              TO V9-8
COBOL                MOVE V9-8               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 9)
COBOL                MOVE R9C-9              TO V9-9
COBOL                MOVE V9-9               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 10)
COBOL                MOVE R9C-10             TO V9-10
COBOL                MOVE V9-10              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 11)
COBOL                MOVE R9C-11             TO V9-11
COBOL                MOVE V9-11              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 12)
COBOL                MOVE R9C-12             TO V9-12
COBOL                MOVE V9-12              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 13)
COBOL                MOVE R9C-13             TO V9-13
COBOL                MOVE V9-13              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 14)
COBOL                MOVE R9C-14             TO V9-14
COBOL                MOVE V9-14              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 15)
COBOL                MOVE R9C-15             TO V9-15
COBOL                MOVE V9-15              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 16)
COBOL                MOVE R9C-16             TO V9-16
COBOL                MOVE V9-16              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 17)
COBOL                MOVE R9C-17             TO V9-17
COBOL                MOVE V9-17              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 18)
COBOL                MOVE R9C-18             TO V9-18
COBOL                MOVE V9-18              TO MSCFORM-VALEUR MSCFORM-NUM.
COBOL       ******************************************************************
COBOL        FORMAT-S9.
COBOL            IF  (RUB-N9(K) = 1)
COBOL                MOVE RS9-1              TO V9-1
COBOL                MOVE V9-1               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 2)
COBOL                MOVE RS9-2              TO V9-2
COBOL                MOVE V9-2               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 3)
COBOL                MOVE RS9-3              TO V9-3
COBOL                MOVE V9-3               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 4)
COBOL                MOVE RS9-4              TO V9-4
COBOL                MOVE V9-4               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 5)
COBOL                MOVE RS9-5              TO V9-5
COBOL                MOVE V9-5               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 6)
COBOL                MOVE RS9-6              TO V9-6
COBOL                MOVE V9-6               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 7)
COBOL                MOVE RS9-7              TO V9-7
COBOL                MOVE V9-7               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 8)
COBOL                MOVE RS9-8              TO V9-8
COBOL                MOVE V9-8               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 9)
COBOL                MOVE RS9-9              TO V9-9
COBOL                MOVE V9-9               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 10)
COBOL                MOVE RS9-10             TO V9-10
COBOL                MOVE V9-10              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 11)
COBOL                MOVE RS9-11             TO V9-11
COBOL                MOVE V9-11              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 12)
COBOL                MOVE RS9-12             TO V9-12
COBOL                MOVE V9-12              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 13)
COBOL                MOVE RS9-13             TO V9-13
COBOL                MOVE V9-13              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 14)
COBOL                MOVE RS9-14             TO V9-14
COBOL                MOVE V9-14              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 15)
COBOL                MOVE RS9-15             TO V9-15
COBOL                MOVE V9-15              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 16)
COBOL                MOVE RS9-16             TO V9-16
COBOL                MOVE V9-16              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 17)
COBOL                MOVE RS9-17             TO V9-17
COBOL                MOVE V9-17              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 18)
COBOL                MOVE RS9-18             TO V9-18
COBOL                MOVE V9-18              TO MSCFORM-VALEUR MSCFORM-NUM.
COBOL       ******************************************************************
COBOL        FORMAT-SL9.
COBOL            IF  (RUB-N9(K) = 1)
COBOL                MOVE RSL9-1             TO V9-1
COBOL                MOVE V9-1               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 2)
COBOL                MOVE RSL9-2             TO V9-2
COBOL                MOVE V9-2               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 3)
COBOL                MOVE RSL9-3             TO V9-3
COBOL                MOVE V9-3               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 4)
COBOL                MOVE RSL9-4             TO V9-4
COBOL                MOVE V9-4               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 5)
COBOL                MOVE RSL9-5             TO V9-5
COBOL                MOVE V9-5               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 6)
COBOL                MOVE RSL9-6             TO V9-6
COBOL                MOVE V9-6               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 7)
COBOL                MOVE RSL9-7             TO V9-7
COBOL                MOVE V9-7               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 8)
COBOL                MOVE RSL9-8             TO V9-8
COBOL                MOVE V9-8               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 9)
COBOL                MOVE RSL9-9             TO V9-9
COBOL                MOVE V9-9               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 10)
COBOL                MOVE RSL9-10            TO V9-10
COBOL                MOVE V9-10              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 11)
COBOL                MOVE RSL9-11            TO V9-11
COBOL                MOVE V9-11              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 12)
COBOL                MOVE RSL9-12            TO V9-12
COBOL                MOVE V9-12              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 13)
COBOL                MOVE RSL9-13            TO V9-13
COBOL                MOVE V9-13              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 14)
COBOL                MOVE RSL9-14            TO V9-14
COBOL                MOVE V9-14              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 15)
COBOL                MOVE RSL9-15            TO V9-15
COBOL                MOVE V9-15              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 16)
COBOL                MOVE RSL9-16            TO V9-16
COBOL                MOVE V9-16              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 17)
COBOL                MOVE RSL9-17            TO V9-17
COBOL                MOVE V9-17              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 18)
COBOL                MOVE RSL9-18            TO V9-18
COBOL                MOVE V9-18              TO MSCFORM-VALEUR MSCFORM-NUM.
COBOL       ******************************************************************
COBOL        FORMAT-SLS9.
COBOL            IF  (RUB-N9(K) = 1)
COBOL                MOVE RSLS9-1            TO V9-1
COBOL                MOVE V9-1               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 2)
COBOL                MOVE RSLS9-2            TO V9-2
COBOL                MOVE V9-2               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 3)
COBOL                MOVE RSLS9-3            TO V9-3
COBOL                MOVE V9-3               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 4)
COBOL                MOVE RSLS9-4            TO V9-4
COBOL                MOVE V9-4               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 5)
COBOL                MOVE RSLS9-5            TO V9-5
COBOL                MOVE V9-5               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 6)
COBOL                MOVE RSLS9-6            TO V9-6
COBOL                MOVE V9-6               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 7)
COBOL                MOVE RSLS9-7            TO V9-7
COBOL                MOVE V9-7               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 8)
COBOL                MOVE RSLS9-8            TO V9-8
COBOL                MOVE V9-8               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 9)
COBOL                MOVE RSLS9-9            TO V9-9
COBOL                MOVE V9-9               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 10)
COBOL                MOVE RSLS9-10           TO V9-10
COBOL                MOVE V9-10              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 11)
COBOL                MOVE RSLS9-11           TO V9-11
COBOL                MOVE V9-11              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 12)
COBOL                MOVE RSLS9-12           TO V9-12
COBOL                MOVE V9-12              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 13)
COBOL                MOVE RSLS9-13           TO V9-13
COBOL                MOVE V9-13              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 14)
COBOL                MOVE RSLS9-14           TO V9-14
COBOL                MOVE V9-14              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 15)
COBOL                MOVE RSLS9-15           TO V9-15
COBOL                MOVE V9-15              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 16)
COBOL                MOVE RSLS9-16           TO V9-16
COBOL                MOVE V9-16              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 17)
COBOL                MOVE RSLS9-17           TO V9-17
COBOL                MOVE V9-17              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 18)
COBOL                MOVE RSLS9-18           TO V9-18
COBOL                MOVE V9-18              TO MSCFORM-VALEUR MSCFORM-NUM.
COBOL       ******************************************************************
COBOL        FORMAT-STS9.
COBOL            IF  (RUB-N9(K) = 1)
COBOL                MOVE RSTS9-1            TO V9-1
COBOL                MOVE V9-1               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 2)
COBOL                MOVE RSTS9-2            TO V9-2
COBOL                MOVE V9-2               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 3)
COBOL                MOVE RSTS9-3            TO V9-3
COBOL                MOVE V9-3               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 4)
COBOL                MOVE RSTS9-4            TO V9-4
COBOL                MOVE V9-4               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 5)
COBOL                MOVE RSTS9-5            TO V9-5
COBOL                MOVE V9-5               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 6)
COBOL                MOVE RSTS9-6            TO V9-6
COBOL                MOVE V9-6               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 7)
COBOL                MOVE RSTS9-7            TO V9-7
COBOL                MOVE V9-7               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 8)
COBOL                MOVE RSTS9-8            TO V9-8
COBOL                MOVE V9-8               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 9)
COBOL                MOVE RSTS9-9            TO V9-9
COBOL                MOVE V9-9               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 10)
COBOL                MOVE RSTS9-10           TO V9-10
COBOL                MOVE V9-10              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 11)
COBOL                MOVE RSTS9-11           TO V9-11
COBOL                MOVE V9-11              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 12)
COBOL                MOVE RSTS9-12           TO V9-12
COBOL                MOVE V9-12              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 13)
COBOL                MOVE RSTS9-13           TO V9-13
COBOL                MOVE V9-13              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 14)
COBOL                MOVE RSTS9-14           TO V9-14
COBOL                MOVE V9-14              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 15)
COBOL                MOVE RSTS9-15           TO V9-15
COBOL                MOVE V9-15              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 16)
COBOL                MOVE RSTS9-16           TO V9-16
COBOL                MOVE V9-16              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 17)
COBOL                MOVE RSTS9-17           TO V9-17
COBOL                MOVE V9-17              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 18)
COBOL                MOVE RSTS9-18           TO V9-18
COBOL                MOVE V9-18              TO MSCFORM-VALEUR MSCFORM-NUM.
COBOL       ******************************************************************
COBOL        FORMAT-9.
COBOL            IF  (RUB-N9(K) = 1)
COBOL                MOVE R9-1               TO V9-1
COBOL                MOVE V9-1               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 2)
COBOL                MOVE R9-2               TO V9-2
COBOL                MOVE V9-2               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 3)
COBOL                MOVE R9-3               TO V9-3
COBOL                MOVE V9-3               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 4)
COBOL                MOVE R9-4               TO V9-4
COBOL                MOVE V9-4               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 5)
COBOL                MOVE R9-5               TO V9-5
COBOL                MOVE V9-5               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 6)
COBOL                MOVE R9-6               TO V9-6
COBOL                MOVE V9-6               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 7)
COBOL                MOVE R9-7               TO V9-7
COBOL                MOVE V9-7               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 8)
COBOL                MOVE R9-8               TO V9-8
COBOL                MOVE V9-8               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 9)
COBOL                MOVE R9-9               TO V9-9
COBOL                MOVE V9-9               TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 10)
COBOL                MOVE R9-10              TO V9-10
COBOL                MOVE V9-10              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 11)
COBOL                MOVE R9-11              TO V9-11
COBOL                MOVE V9-11              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 12)
COBOL                MOVE R9-12              TO V9-12
COBOL                MOVE V9-12              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 13)
COBOL                MOVE R9-13              TO V9-13
COBOL                MOVE V9-13              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 14)
COBOL                MOVE R9-14              TO V9-14
COBOL                MOVE V9-14              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 15)
COBOL                MOVE R9-15              TO V9-15
COBOL                MOVE V9-15              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 16)
COBOL                MOVE R9-16              TO V9-16
COBOL                MOVE V9-16              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 17)
COBOL                MOVE R9-17              TO V9-17
COBOL                MOVE V9-17              TO MSCFORM-VALEUR MSCFORM-NUM
COBOL            ELSE
COBOL            IF  (RUB-N9(K) = 18)
COBOL                MOVE R9-18              TO V9-18
COBOL                MOVE V9-18              TO MSCFORM-VALEUR MSCFORM-NUM.
COBOL       *******< FIN DU SOURCE : MSSFORM >********************************
COBOL MEMBER NAME  MSSLOGO
COBOL        IDENTIFICATION DIVISION.
COBOL       ******************************************************************
COBOL       * MSOL                                                       IBM *
COBOL       * ----                                                           *
COBOL       * EDITION PAR DISPLAY D'UN LOGO MSOL          (118 COLONNES)     *
COBOL       ******************************************************************
COBOL        PROGRAM-ID.   MSSLOGO.
COBOL        AUTHOR.       MSOL.
COBOL       ******************************************************************
COBOL        ENVIRONMENT DIVISION.
COBOL        CONFIGURATION SECTION.
COBOL        SOURCE-COMPUTER. IBM-3090.
COBOL        OBJECT-COMPUTER. IBM-3090.
COBOL       ******************************************************************
COBOL        INPUT-OUTPUT SECTION.
COBOL        FILE-CONTROL.
COBOL       ******************************************************************
COBOL        DATA DIVISION.
COBOL       ******************************************************************
COBOL        FILE SECTION.
COBOL       ******************************************************************
COBOL        WORKING-STORAGE SECTION.
COBOL 00 0   01  L0   PIC X(080)  VALUE ALL '*'.
COBOL 01 0   01  L1   PIC X(080)  VALUE SPACE.
COBOL 02 0   01  L2.
COBOL 02 1       05 F PIC X(022)  VALUE SPACE.
COBOL 02 2       05 M PIC X(011)  VALUE '**    **'.
COBOL 02 3       05 S PIC X(011)  VALUE ' ******  '.
COBOL 02 4       05 O PIC X(011)  VALUE '  ****   '.
COBOL 02 5       05 L PIC X(011)  VALUE '**       '.
COBOL 03 0   01  L3.
COBOL 03 1       05 F PIC X(022)  VALUE SPACE.
COBOL 03 2       05 M PIC X(011)  VALUE '***  ***'.
COBOL 03 3       05 S PIC X(011)  VALUE '******** '.
COBOL 03 4       05 O PIC X(011)  VALUE ' ******* '.
COBOL 03 5       05 L PIC X(011)  VALUE '**       '.
COBOL 04 0   01  L4.
COBOL 04 1       05 F PIC X(022)  VALUE SPACE.
COBOL 04 2       05 M PIC X(011)  VALUE '** ** **'.
COBOL 04 3       05 S PIC X(011)  VALUE '**       '.
COBOL 04 4       05 O PIC X(011)  VALUE '**     **'.
COBOL 04 5       05 L PIC X(011)  VALUE '**       '.
COBOL 05 0   01  L5.
COBOL 05 1       05 F PIC X(022)  VALUE SPACE.
COBOL 05 2       05 M PIC X(011)  VALUE '** ** **'.
COBOL 05 3       05 S PIC X(011)  VALUE '**       '.
COBOL 05 4       05 O PIC X(011)  VALUE '**     **'.
COBOL 05 5       05 L PIC X(011)  VALUE '**       '.
COBOL 06 0   01  L6.
COBOL 06 1       05 F PIC X(022)  VALUE SPACE.
COBOL 06 2       05 M PIC X(011)  VALUE '**    **'.
COBOL 06 3       05 S PIC X(011)  VALUE '**       '.
COBOL 06 4       05 O PIC X(011)  VALUE '**     **'.
COBOL 06 5       05 L PIC X(011)  VALUE '**       '.
COBOL 07 0   01  L7.
COBOL 07 1       05 F PIC X(022)  VALUE SPACE.
COBOL 07 2       05 M PIC X(011)  VALUE '**    **'.
COBOL 07 3       05 S PIC X(011)  VALUE '*******  '.
COBOL 07 4       05 O PIC X(011)  VALUE '**     **'.
COBOL 07 5       05 L PIC X(011)  VALUE '**       '.
COBOL 08 0   01  L8.
COBOL 08 1       05 F PIC X(022)  VALUE SPACE.
COBOL 08 2       05 M PIC X(011)  VALUE '**    **'.
COBOL 08 3       05 S PIC X(011)  VALUE ' ******* '.
COBOL 08 4       05 O PIC X(011)  VALUE '**     **'.
COBOL 08 5       05 L PIC X(011)  VALUE '**       '.
COBOL 09 0   01  L9.
COBOL 09 1       05 F PIC X(022)  VALUE SPACE.
COBOL 09 2       05 M PIC X(011)  VALUE '**    **'.
COBOL 09 3       05 S PIC X(011)  VALUE '      ** '.
COBOL 09 4       05 O PIC X(011)  VALUE '**     **'.
COBOL 09 5       05 L PIC X(011)  VALUE '**       '.
COBOL 10 0   01  L10.
COBOL 10 1       05 F PIC X(022)  VALUE SPACE.
COBOL 10 2       05 M PIC X(011)  VALUE '**    **'.
COBOL 10 3       05 S PIC X(011)  VALUE '      ** '.
COBOL 10 4       05 O PIC X(011)  VALUE '**     **'.
COBOL 10 5       05 L PIC X(011)  VALUE '**       '.
COBOL 11 0   01  L11.
COBOL 11 1       05 F PIC X(022)  VALUE SPACE.
COBOL 11 2       05 M PIC X(011)  VALUE '**    **'.
COBOL 11 3       05 S PIC X(011)  VALUE '      ** '.
COBOL 11 4       05 O PIC X(011)  VALUE '**     **'.
COBOL 11 5       05 L PIC X(011)  VALUE '**       '.
COBOL 12 0   01  L12.
COBOL 12 1       05 F PIC X(022)  VALUE SPACE.
COBOL 12 2       05 M PIC X(011)  VALUE '**    **'.
COBOL 12 3       05 S PIC X(011)  VALUE '******** '.
COBOL 12 4       05 O PIC X(011)  VALUE ' ******* '.
COBOL 12 5       05 L PIC X(011)  VALUE '*********'.
COBOL 13 0   01  L13.
COBOL 13 1       05 F PIC X(022)  VALUE SPACE.
COBOL 13 2       05 M PIC X(011)  VALUE '**    **'.
COBOL 13 3       05 S PIC X(011)  VALUE ' ******  '.
COBOL 13 4       05 O PIC X(011)  VALUE '  *****  '.
COBOL 13 5       05 L PIC X(011)  VALUE '*********'.
COBOL       ******************************************************************
COBOL        LINKAGE SECTION.
COBOL       ******************************************************************
COBOL        PROCEDURE DIVISION.
COBOL            DISPLAY L0.
COBOL            DISPLAY L0.
COBOL            DISPLAY L1.
COBOL            DISPLAY L1.
COBOL
COBOL            DISPLAY L2.
COBOL            DISPLAY L3.
COBOL            DISPLAY L4.
COBOL            DISPLAY L5.
COBOL            DISPLAY L6.
COBOL            DISPLAY L7.
COBOL            DISPLAY L8.
COBOL            DISPLAY L9.
COBOL            DISPLAY L10.
COBOL            DISPLAY L11.
COBOL            DISPLAY L12.
COBOL            DISPLAY L13.
COBOL
COBOL            DISPLAY L1.
COBOL            DISPLAY L1.
COBOL            DISPLAY L0.
COBOL            DISPLAY L0.
COBOL            DISPLAY L1.
COBOL            DISPLAY L1.
COBOL            GOBACK.
COBOL       *******< FIN DU SOURCE : MSSLOGO >********************************
COBOL MEMBER NAME  MSPCC
COBOL        IDENTIFICATION DIVISION.
COBOL       ******************************************************************
COBOL       * MSOL                  MIGRATION                            IBM *
COBOL       *----------------------------------------------------------------*
COBOL       * AUTEUR : CHARLES BERTRAND                                      *
COBOL       * DATE   : 22/11/2016                                            *
COBOL       * BUT    : COMPARAISON DE 2 FICHIERS                             *
COBOL       *----------------------------------------------------------------*
COBOL       * COMPARAISON DE 2 FICHIERS                                      *
COBOL       *----------------------------------------------------------------*
COBOL       * //FCOPY  DD DSN=BIB.COPY(COPY)                                 *
COBOL       * //SYSUT1 DD DSN=FICHIER.AVANT                                  *
COBOL       * //SYSUT2 DD DSN=FICHIER.APRES                                  *
COBOL       * //SYSIN  DD *                                                  *
COBOL       * *DCB=FB,80,8000     OU DCB1=FB,80,8000                         *
COBOL       * *DCB2=FB,80,8000    INUTILE SI MEME DCB POUR LES 2 FICHIERS    *
COBOL       *                     SI DCB FBA/VBA ON SKIPPE LE 1ER CAR        *
COBOL       * *TITLE=<TITRE DE L'EDITION> OU <NOM DU FICHIER A COMPARER>     *
COBOL       * ** ECARTS A IGNORER                                            *
COBOL       * *MASK=RUBR          RUBRIQUE NON COMPAREE                      *
COBOL       * *MASK=RUBR,DELTA,1  SI NUMERIQUE EST LA DIFFERENCE EST <=1     *
COBOL       * *MASK=RUBR,LOW      IGNORE SI LOW-VALUE = SPACE                *
COBOL       * *SKIP=999           IGNORE LES 999 PREMIERES LIGNES            *
COBOL       * *STOP=999           COMPARE 999 LIGNES                         *
COBOL       * *MAXI=999           ECART ACCEPTE AVANT ARRET (10 DEFAUT)      *
COBOL       * *REPORT             IGNORE LES LIGNES VIDES                    *
COBOL       * *DETAIL             EDITE LES ECARTS PAR RUBRIQUE              *
COBOL       ******************************************************************
COBOL        PROGRAM-ID. MSPCC.
COBOL       ******************************************************************
COBOL        ENVIRONMENT DIVISION.
COBOL        CONFIGURATION SECTION.
COBOL        SOURCE-COMPUTER. IBM-3090.
COBOL        OBJECT-COMPUTER. IBM-3090.
COBOL       *****************************************************************
COBOL        INPUT-OUTPUT SECTION.
COBOL        FILE-CONTROL.
COBOL            SELECT  F-SYSUT1       ASSIGN TO  SYSUT1
COBOL               FILE STATUS IS FS1.
COBOL            SELECT  F-SYSUT2       ASSIGN TO  SYSUT2
COBOL               FILE STATUS IS FS2.
COBOL            SELECT  F-SYSPRINT     ASSIGN TO  SYSPRINT
COBOL               FILE STATUS IS FS-PRINT.
COBOL       *****************************************************************
COBOL        DATA DIVISION.
COBOL       *****************************************************************
COBOL        FILE SECTION.
COBOL       *------------*
COBOL        FD  F-SYSUT1
COBOL            RECORD CONTAINS 1 TO 32760 CHARACTERS
COBOL            RECORDING MODE IS U.
COBOL        01  UT1-BLOC.
COBOL            05  FILLER PIC X OCCURS 32760
COBOL                DEPENDING ON LG-BLOC1.
COBOL
COBOL        FD  F-SYSUT2
COBOL            RECORD CONTAINS 1 TO 32760 CHARACTERS
COBOL            RECORDING MODE IS U.
COBOL        01  UT2-BLOC.
COBOL            05  FILLER PIC X OCCURS 32760
COBOL                DEPENDING ON LG-BLOC2.
COBOL
COBOL        FD  F-SYSPRINT
COBOL            LABEL RECORD OMITTED
COBOL            RECORDING MODE IS F.
COBOL        01  SYSPRINT-RECORD PIC X(132).
COBOL
COBOL       *****************************************************************
COBOL        WORKING-STORAGE SECTION.
COBOL       *-----------------------*
COBOL       * CONSTANTES
COBOL        77  PROG-ID                     PIC  X(08) VALUE 'MSPCC   '.
COBOL        77  PROG-DESC                   PIC  X(72) VALUE
COBOL            '(C) MOVE SOLUTIONS COMPARE DE FICHIER'.
COBOL        77  K-OUI                       PIC  X(01) VALUE '1'.
COBOL        77  K-IGNORE                    PIC  X(01) VALUE 'I'.
COBOL        77  K-BAS                       PIC  X(01) VALUE 'B'.
COBOL        77  K-HAUT                      PIC  X(01) VALUE 'H'.
COBOL        77  K-DELTA                     PIC  X(01) VALUE 'D'.
COBOL        77  K-SIGN                      PIC  X(01) VALUE 'S'.
COBOL        77  K-MIN-MAJ                   PIC  X(01) VALUE 'M'.
COBOL        77  K-LOW-SPACE                 PIC  X(01) VALUE 'L'.
COBOL        77  K-SPACE                     PIC  X(01) VALUE '_'.
COBOL        77  SP-MSSCOPY                  PIC  X(08) VALUE 'MSSCOPY'.
COBOL        77  SP-MSSHEXA                  PIC  X(08) VALUE 'MSSHEXA'.
COBOL        77  SP-MSSLOGO                  PIC  X(08) VALUE 'MSSLOGO'.
COBOL        77  SP-MSSOPT                   PIC  X(08) VALUE 'MSSOPT '.
COBOL        01  T-REGLE.
COBOL            05 F PIC X(20) VALUE '----+----1----+----2'.
COBOL            05 F PIC X(20) VALUE '----+----3----+----4'.
COBOL            05 F PIC X(20) VALUE '----+----5----+----6'.
COBOL            05 F PIC X(20) VALUE '----+----7----+----8'.
COBOL            05 F PIC X(20) VALUE '----+----9----+----0'.
COBOL            05 F PIC X(20) VALUE '----+----1----+----2'.
COBOL            05 F PIC X(20) VALUE '----+----3----+----4'.
COBOL
COBOL       *---------------------------------------------------------------*
COBOL        01  ZONES-TECHNIQUES.
COBOL            05  FS-PRINT                PIC  X(02).
COBOL            05  Z1                      PIC  X(20).
COBOL            05  Z2                      PIC  X(20).
COBOL            05  W-OFSET                 PIC  X(20).
COBOL            05  W-LG                    PIC  X(20).
COBOL            05  W-COMMENT               PIC  X(45).
COBOL            05  W-PIC.
COBOL                10  W-PIC-X             PIC  X(02) VALUE 'X('.
COBOL                10  W-PIC-LG            PIC  9(05).
COBOL                10  W-PIC-PAR           PIC  X(01) VALUE ')'.
COBOL            05  W-RUB                   PIC  X(32).
COBOL            05  FILLER REDEFINES W-RUB.
COBOL                10  W-RUB-R             PIC  X(02).
COBOL                10  W-RUB-POS           PIC  9(05).
COBOL                10  W-RUB-F1            PIC  X(01).
COBOL                10  W-RUB-LG            PIC  9(05).
COBOL                10  W-RUB-F2            PIC  X(19).
COBOL            05  W-TITLE                 PIC  X(80).
COBOL            05  W-TAGRUB.
COBOL                10  W-TAG-TYP           PIC  X(01) VALUE SPACE.
COBOL                10  W-TAG-ECART   COMP  PIC  9(05) VALUE ZERO.
COBOL                10  W-TAG-MASK    COMP  PIC  9(05) VALUE ZERO.
COBOL       * POUR EVALUER DES ZONES ALPHA EN NUMERIQUE
COBOL            05  ZN9               COMP  PIC  9(09) VALUE ZERO.
COBOL            05  ZNX.
COBOL                10 ZN1   OCCURS 20      PIC  9(01).
COBOL       * ZONES DE TRAVAIL
COBOL        77  I                     COMP  PIC  9(05) VALUE ZERO.
COBOL        77  IX                    COMP  PIC  9(05) VALUE ZERO.
COBOL        77  I-FIN                 COMP  PIC  9(05) VALUE ZERO.
COBOL        77  I-MSG                 COMP  PIC  9(05) VALUE ZERO.
COBOL        77  J                     COMP  PIC  9(05) VALUE ZERO.
COBOL        77  JX                    COMP  PIC  9(05) VALUE ZERO.
COBOL        77  N                     COMP  PIC  9(05) VALUE ZERO.
COBOL        77  R                     COMP  PIC  9(05) VALUE ZERO.
COBOL        77  IZ                    COMP  PIC  9(05) VALUE ZERO.
COBOL        77  NB-COMPARE            COMP  PIC  9(09) VALUE ZERO.
COBOL        77  NB-ECART              COMP  PIC  9(09) VALUE ZERO.
COBOL        77  NB-ACCEPT             COMP  PIC  9(09) VALUE ZERO.
COBOL        01  W-ACCEPT                    PIC  X(01) VALUE ZERO.
COBOL            88 ACCEPTED    VALUE '1'.
COBOL        01  W-QUEL-RECORD               PIC  X(01) VALUE 'H'.
COBOL            88 REC-BAS     VALUE 'B'.
COBOL            88 REC-HAUT    VALUE 'H'.
COBOL        01  W-AFFICHABLE                PIC  X(01) VALUE ZERO.
COBOL            88 AFFICHABLE  VALUE '1'.
COBOL        01  W-MODE-DEBUG                PIC  X(01) VALUE ZERO.
COBOL            88 MODE-DEBUG  VALUE '1'.
COBOL        77  LG9                         PIC  9(05) VALUE ZERO.
COBOL        77  MSCSIGN-CH                  PIC  X(01) VALUE SPACE.
COBOL
COBOL       *---------------------------------------------------------------*
COBOL       * MANIPULATION SYSUT1
COBOL        01  ZONE-FILE1.
COBOL            05  FS1                     PIC  X(02) VALUE SPACE.
COBOL            05  LG-BLOC1          COMP  PIC  9(05) VALUE ZERO.
COBOL            05  LG-REC1           COMP  PIC  9(05) VALUE ZERO.
COBOL            05  NB-BLOC1          COMP  PIC  9(09) VALUE ZERO.
COBOL            05  NB-REC1           COMP  PIC  9(09) VALUE ZERO.
COBOL            05  NB-REC-VIDE1      COMP  PIC  9(09) VALUE ZERO.
COBOL            05  A1                COMP  PIC  9(05) VALUE ZERO.
COBOL            05  B1                COMP  PIC  9(05) VALUE ZERO.
COBOL            05  LG-BLOC-LU1X.
COBOL              10 LG-BLOC-LU1      COMP  PIC  9(05) VALUE ZERO.
COBOL            05  LG-REC-LU1X.
COBOL              10 LG-REC-LU1       COMP  PIC  9(05) VALUE ZERO.
COBOL       * FORMAT FICHIER
COBOL            05  W-ASA1                  PIC  X(01) VALUE SPACE.
COBOL                  88 WITH-ASA1        VALUE 'A'.
COBOL            05  W-RECFM1                PIC  X(05).
COBOL            05  FILLER REDEFINES W-RECFM1.
COBOL                10  FILLER              PIC  X(01).
COBOL                  88 FILE-FIXE1       VALUE 'F'.
COBOL                  88 FILE-VARIABLE1   VALUE 'V'.
COBOL                10  FILLER              PIC  X(04).
COBOL       * BUFFER
COBOL            05  UT1-REC                 PIC  X(32760).
COBOL            05  W1-REC                  PIC  X(32760).
COBOL       * FIN DE LA LECTURE DES RECORDS
COBOL            05  W-FIN-SYSUT1            PIC  X(01).
COBOL              88  FIN-SYSUT1          VALUE '1'.
COBOL
COBOL       *---------------------------------------------------------------*
COBOL       * MANIPULATION SYSUT2
COBOL        01  ZONE-FILE2.
COBOL            05  FS2                     PIC  X(02) VALUE SPACE.
COBOL            05  LG-BLOC2          COMP  PIC  9(05) VALUE ZERO.
COBOL            05  LG-REC2           COMP  PIC  9(05) VALUE ZERO.
COBOL            05  NB-BLOC2          COMP  PIC  9(09) VALUE ZERO.
COBOL            05  NB-REC2           COMP  PIC  9(09) VALUE ZERO.
COBOL            05  NB-REC-VIDE2      COMP  PIC  9(09) VALUE ZERO.
COBOL            05  A2                COMP  PIC  9(05) VALUE ZERO.
COBOL            05  B2                COMP  PIC  9(05) VALUE ZERO.
COBOL            05  LG-BLOC-LU2X.
COBOL              10 LG-BLOC-LU2      COMP  PIC  9(05) VALUE ZERO.
COBOL            05  LG-REC-LU2X.
COBOL              10 LG-REC-LU2       COMP  PIC  9(05) VALUE ZERO.
COBOL       * FORMAT FICHIER
COBOL            05  W-ASA2                  PIC  X(01) VALUE SPACE.
COBOL                  88 WITH-ASA2        VALUE 'A'.
COBOL            05  W-RECFM2                PIC  X(05).
COBOL            05  FILLER REDEFINES W-RECFM2.
COBOL                10  FILLER              PIC  X(01).
COBOL                  88 FILE-FIXE2       VALUE 'F'.
COBOL                  88 FILE-VARIABLE2   VALUE 'V'.
COBOL                10  FILLER              PIC  X(04).
COBOL       * BUFFER
COBOL            05  UT2-REC                 PIC  X(32760).
COBOL            05  W2-REC                  PIC  X(32760).
COBOL       * FIN DE LA LECTURE DES RECORDS
COBOL            05  W-FIN-SYSUT2            PIC  X(01).
COBOL              88  FIN-SYSUT2   VALUE '1'.
COBOL
COBOL       *---------------------------------------------------------------*
COBOL        01  OPTIONS-DE-COMPARAISON.
COBOL            05  MASK-DETAIL             PIC  X(01) VALUE SPACE.
COBOL              88 AVEC-DETAIL VALUE '1'.
COBOL            05  MASK-REPORT             PIC  X(01) VALUE SPACE.
COBOL              88 MODE-REPORT VALUE '1'.
COBOL            05  MASK-SKIP         COMP  PIC  9(09) VALUE ZERO.
COBOL            05  MASK-SKIP-OPT     COMP  PIC  9(09) VALUE ZERO.
COBOL            05  MASK-STOP         COMP  PIC  9(09) VALUE 999999999.
COBOL            05  MASK-STOP-OPT     COMP  PIC  9(09) VALUE 999999999.
COBOL            05  MAX-DIFF          COMP  PIC  9(09) VALUE 10.
COBOL            05  MAX-DIFF-OPT      COMP  PIC  9(09) VALUE 10.
COBOL            05  MAX-MASK          COMP  PIC  9(05) VALUE 100.
COBOL            05  NB-DIFF           COMP  PIC  9(09) VALUE ZERO.
COBOL            05  NB-DIFF-ACCEPT    COMP  PIC  9(09) VALUE ZERO.
COBOL            05  NB-MASK           COMP  PIC  9(05) VALUE ZERO.
COBOL            05  FILLER OCCURS 100.
COBOL                10  MASK-ACCEPT   COMP  PIC  9(09).
COBOL                10  MASK-COMMENT        PIC  X(45).
COBOL                10  MASK-DELTA    COMP  PIC  9(05).
COBOL                10  MASK-ECART    COMP  PIC  9(09).
COBOL                10  MASK-LG       COMP  PIC  9(05) VALUE ZERO.
COBOL                10  MASK-POS      COMP  PIC  9(05) VALUE ZERO.
COBOL                10  MASK-RUB      COMP  PIC  9(05).
COBOL                10  MASK-TYP            PIC  X(01).
COBOL
COBOL       *---------------------------------------------------------------*
COBOL       * RESTITUTION
COBOL        01  L0.
COBOL            05  F PIC  X(31) VALUE '-------------------------------'.
COBOL            05  FILLER                  PIC  X(01) VALUE SPACE.
COBOL            05  F PIC  X(17) VALUE 'NUMERO DE RECORD'.
COBOL            05  L0-REC                  PIC  ZZZBZZZBZZ9.
COBOL        01  L1.
COBOL            05  L1-RUB                  PIC  X(31).
COBOL            05  FILLER                  PIC  X(01) VALUE '!'.
COBOL            05  L1-VAL                  PIC  X(33).
COBOL            05  FILLER                  PIC  X(01) VALUE '!'.
COBOL            05  L1-HEXA                 PIC  X(66).
COBOL        01  L2.
COBOL            05  L2-OFSET.
COBOL                10  L2-POS              PIC  ZZZZ9.
COBOL                10  L2-OFS              PIC  X.
COBOL                10  L2-LG               PIC  ZZ9.
COBOL                10  FILLER              PIC  X(01) VALUE SPACE.
COBOL            05  L2-PIC                  PIC  X(21).
COBOL            05  FILLER                  PIC  X(01) VALUE '!'.
COBOL            05  L2-VAL                  PIC  X(33).
COBOL            05  FILLER                  PIC  X(01) VALUE '!'.
COBOL            05  L2-HEXA                 PIC  X(66).
COBOL
COBOL        01  L3.
COBOL            05  L3-MSG                  PIC  X(45).
COBOL            05  L3-NB                   PIC  ZZZBZZZBZZ9.
COBOL            05  L3-PART2.
COBOL                10 FILLER               PIC  X(05).
COBOL                10 L3-MSG2              PIC  X(13).
COBOL                10 L3-NB2               PIC  ZZZBZZZBZZ9.
COBOL
COBOL        01  L4.
COBOL            05  L4-OFS-D                PIC  ZZZZZ.
COBOL            05  FILLER                  PIC  X(01) VALUE '.'.
COBOL            05  L4-OFS-F                PIC  ZZZZZ.
COBOL            05  FILLER                  PIC  X(01) VALUE '!'.
COBOL            05  L4-REGLE                PIC  X(100).
COBOL            05  FILLER                  PIC  X(01) VALUE '!'.
COBOL
COBOL        01  L5.
COBOL            05  FILLER                  PIC  X(11) VALUE SPACE.
COBOL            05  L5-SEP1                 PIC  X(01) VALUE '!'.
COBOL            05  L5-RECORD               PIC  X(100).
COBOL            05  L5-SEP2                 PIC  X(01) VALUE '!'.
COBOL
COBOL        01  LD-MASK-HEAD.
COBOL            05  FILLER     PIC  X(30) VALUE 'RUBRIQUE EN ECART'.
COBOL            05  FILLER                  PIC  X(06) VALUE ' OFSET'.
COBOL            05  FILLER                  PIC  X(06) VALUE '  LONG'.
COBOL            05  FILLER                  PIC  X(22) VALUE '    PICTURE'.
COBOL            05  FILLER                  PIC  X(11) VALUE '      ECART'.
COBOL            05  FILLER                  PIC  X(11) VALUE '   ACCEPTED'.
COBOL            05  FILLER                  PIC  X(01) VALUE SPACE.
COBOL            05  FILLER                  PIC  X(45) VALUE 'COMMENT'.
COBOL
COBOL        01  LD-MASK-DETAIL.
COBOL            05  LDR-RUB                 PIC  X(30).
COBOL            05  LDR-POS                 PIC  Z(05)9.
COBOL            05  LDR-LG                  PIC  Z(05)9.
COBOL            05  FILLER                  PIC  X(01).
COBOL            05  LDR-PIC                 PIC  X(21).
COBOL            05  LDR-ECART               PIC  ZZZBZZZBZZ9.
COBOL            05  LDR-ACCEPT              PIC  ZZZBZZZBZZ9.
COBOL            05  FILLER                  PIC  X(01).
COBOL            05  LDR-COMMENT             PIC  X(45) VALUE '...'.
COBOL
COBOL        01  SYSPRINT-LL VALUE SPACE.
COBOL            05  LL  OCCURS 100          PIC  X(132).
COBOL
COBOL       * FORMATAGE EN HEXADECIMAL
COBOL         01  L-VALEUR                   PIC  X(150).
COBOL         01  L-VALEUR-HEXA              PIC  X(300).
COBOL         01  L-VALEUR-HEXA-D1           PIC  X(150).
COBOL         01  L-VALEUR-HEXA-D2           PIC  X(150).
COBOL         01  L-LONGUEUR           COMP  PIC  9(05) VALUE 150.
COBOL
COBOL       * COPY MSOL POUR APPEL AUTRES SOUS-PRO
COBOL            COPY MSCCOPY SUPPRESS.
COBOL            COPY MSCOPT  SUPPRESS.
COBOL
COBOL       *****************************************************************
COBOL        PROCEDURE DIVISION.
COBOL       *------------------*
COBOL            PERFORM INITIALISATION.
COBOL            PERFORM COMPARAISON-DES-FICHIERS.
COBOL
COBOL       *-----------------*
COBOL        FIN-DU-TRAITEMENT.
COBOL       *-----------------*
COBOL            PERFORM MESSAGES-INFORMATIFS.
COBOL            PERFORM EDITION-DU-COMPTE-RENDU.
COBOL            PERFORM FERMETURE-DES-FICHIERS.
COBOL            GOBACK.
COBOL
COBOL       *****************************************************************
COBOL        COMPARAISON-DES-FICHIERS.
COBOL       *------------------------*
COBOL            PERFORM UNTIL FIN-SYSUT1 OR FIN-SYSUT2
COBOL                       OR (MAX-DIFF  = ZERO)
COBOL                       OR (MASK-STOP = ZERO)
COBOL               IF MASK-SKIP = ZERO
COBOL                  ADD 1                      TO NB-COMPARE
COBOL                  SUBTRACT 1               FROM MASK-STOP
COBOL                  PERFORM COMPARE-RECORD
COBOL               ELSE
COBOL                  SUBTRACT 1               FROM MASK-SKIP
COBOL               END-IF
COBOL               PERFORM LECTURE-SYSUT1
COBOL               PERFORM LECTURE-SYSUT2
COBOL            END-PERFORM.
COBOL
COBOL       ******************************************************************
COBOL        COMPARE-RECORD.
COBOL       *--------------*
COBOL       * LES RECORDS SONT PLUS COURTS QUE LA STRUCTURE, ON COMPLEMENTE
COBOL       * A SPACE LA FIN DU RECORD POUR NE PAS CREER DE FAUX DELTAS
COBOL            IF LG-REC-LU1 < LG-COPY
COBOL               COMPUTE N = LG-COPY - LG-REC-LU1
COBOL               COMPUTE I = LG-REC-LU1 + 1
COBOL               MOVE SPACE                    TO UT1-REC(I:N)
COBOL            END-IF
COBOL
COBOL            IF LG-REC-LU2 < LG-COPY
COBOL               COMPUTE N = LG-COPY - LG-REC-LU2
COBOL               COMPUTE I = LG-REC-LU2 + 1
COBOL               MOVE SPACE                    TO UT2-REC(I:N)
COBOL            END-IF
COBOL
COBOL       * L'ENREG N'EST PAS STRICTEMENT EGAL ON ANALYSE LE DETAIL
COBOL            IF UT1-REC(1:LG-COPY) NOT = UT2-REC(1:LG-COPY)
COBOL               ADD  1                        TO NB-ECART
COBOL               MOVE K-OUI                    TO W-ACCEPT
COBOL               PERFORM ANALYSE-RUBRIQUE
COBOL               VARYING I-RUB FROM 1 BY 1
COBOL                 UNTIL (I-RUB > NB-RUB)
COBOL               IF ACCEPTED
COBOL                  ADD 1                      TO NB-ACCEPT
COBOL               ELSE
COBOL                  SUBTRACT 1               FROM MAX-DIFF
COBOL                  PERFORM EDITE-DIFFERENCE-PAR-RECORD
COBOL               END-IF
COBOL            END-IF.
COBOL
COBOL       ******************************************************************
COBOL        ANALYSE-RUBRIQUE.
COBOL       *----------------*
COBOL            MOVE RUB-POS(I-RUB)              TO I
COBOL            MOVE RUB-LG (I-RUB)              TO J
COBOL            MOVE RUB-TAG(I-RUB)              TO W-TAGRUB
COBOL
COBOL            IF MODE-DEBUG
COBOL               DISPLAY NB-REC1 '!RUB=' RUB-NOM(I-RUB) W-TAGRUB
COBOL            END-IF
COBOL
COBOL            IF  (RUB-PICTURE(I-RUB) NOT = SPACE)
COBOL            AND (UT1-REC(I:J)       NOT = UT2-REC(I:J))
COBOL               ADD  1                        TO W-TAG-ECART
COBOL               MOVE W-TAGRUB                 TO RUB-TAG(I-RUB)
COBOL               IF (W-TAG-TYP NOT = K-IGNORE)
COBOL                  ADD 1                      TO NB-DIFF
COBOL                  ADD 1                      TO MASK-ECART(W-TAG-MASK)
COBOL                  PERFORM ANALYSE-DIFFERENCE
COBOL                     THRU ANALYSE-DIFFERENCE-X
COBOL               ELSE
COBOL                  ADD 1                      TO MASK-ACCEPT(W-TAG-MASK)
COBOL               END-IF
COBOL            END-IF.
COBOL
COBOL       ******************************************************************
COBOL        ANALYSE-DIFFERENCE.
COBOL       *------------------*
COBOL       * ON SORT DE L'ETIQUETTE SI ON ACCEPTE LA DIFFERENCE
COBOL            IF  (W-TAG-TYP = K-LOW-SPACE)
COBOL            AND (UT1-REC(I:J) = SPACE OR LOW-VALUE OR HIGH-VALUE)
COBOL            AND (UT2-REC(I:J) = SPACE OR LOW-VALUE OR HIGH-VALUE)
COBOL               ADD 1                         TO NB-DIFF-ACCEPT
COBOL               ADD 1                         TO MASK-ACCEPT(W-TAG-MASK)
COBOL               GO TO ANALYSE-DIFFERENCE-X.
COBOL
COBOL            IF (W-TAG-TYP = K-SIGN)
COBOL               PERFORM ELIMINE-LE-SIGNE
COBOL               IF (UT1-REC(I:J) = UT2-REC(I:J))
COBOL                  ADD 1                      TO NB-DIFF-ACCEPT
COBOL                  ADD 1                      TO MASK-ACCEPT(W-TAG-MASK)
COBOL                  GO TO ANALYSE-DIFFERENCE-X.
COBOL
COBOL            IF (W-TAG-TYP = K-MIN-MAJ)
COBOL               MOVE FUNCTION UPPER-CASE(UT1-REC(I:J)) TO W1-REC(1:J)
COBOL               MOVE FUNCTION UPPER-CASE(UT2-REC(I:J)) TO W2-REC(1:J)
COBOL               IF (W1-REC(1:J) = W2-REC(1:J))
COBOL                  ADD 1                      TO NB-DIFF-ACCEPT
COBOL                  ADD 1                      TO MASK-ACCEPT(W-TAG-MASK)
COBOL                  GO TO ANALYSE-DIFFERENCE-X.
COBOL
COBOL            IF AVEC-DETAIL
COBOL               PERFORM EDITE-DIFFERENCE-PAR-RUBRIQUE.
COBOL
COBOL            MOVE SPACE                       TO W-ACCEPT.
COBOL
COBOL       *------------------*
COBOL        ANALYSE-DIFFERENCE-X. EXIT.
COBOL
COBOL       ******************************************************************
COBOL        EDITE-DIFFERENCE-PAR-RUBRIQUE.
COBOL       *-----------------------------*
COBOL            IF ACCEPTED
COBOL               MOVE NB-REC1                  TO L0-REC
COBOL               WRITE SYSPRINT-RECORD FROM L0.
COBOL
COBOL            DIVIDE J BY 33 GIVING N REMAINDER R.
COBOL            IF (R > ZERO) ADD 1 TO N.
COBOL
COBOL            MOVE RUB-NOM(I-RUB)              TO L1-RUB
COBOL            MOVE RUB-POS(I-RUB)              TO L2-POS
COBOL            MOVE ':'                         TO L2-OFS
COBOL            MOVE RUB-LG (I-RUB)              TO L2-LG
COBOL            MOVE RUB-PICTURE(I-RUB)          TO L2-PIC
COBOL
COBOL            PERFORM VARYING R FROM 1 BY 1 UNTIL R > N
COBOL               COMPUTE B1 = RUB-POS(I-RUB) + 33 * R - 33
COBOL               IF (R < N)
COBOL                  MOVE 33                    TO L-LONGUEUR
COBOL               ELSE
COBOL                  COMPUTE L-LONGUEUR = J - 33 * R + 33
COBOL               END-IF
COBOL               COMPUTE B2 = 2 * L-LONGUEUR
COBOL
COBOL               MOVE UT1-REC(B1:L-LONGUEUR)   TO L1-VAL L-VALEUR
COBOL               CALL SP-MSSHEXA USING L-VALEUR L-VALEUR-HEXA L-LONGUEUR
COBOL               MOVE L-VALEUR-HEXA(1:B2)      TO L1-HEXA
COBOL
COBOL               MOVE UT2-REC(B1:L-LONGUEUR)   TO L2-VAL L-VALEUR
COBOL               CALL SP-MSSHEXA USING L-VALEUR L-VALEUR-HEXA L-LONGUEUR
COBOL               MOVE L-VALEUR-HEXA(1:B2)      TO L2-HEXA
COBOL
COBOL               PERFORM VARYING B1 FROM 1 BY 1
COBOL                 UNTIL (B1 > B2)
COBOL                  IF (L1-HEXA(B1:1) = L2-HEXA(B1:1))
COBOL                     MOVE '.'                TO L2-HEXA(B1:1)
COBOL                  END-IF
COBOL               END-PERFORM
COBOL
COBOL               PERFORM VARYING B1 FROM 1 BY 1
COBOL                 UNTIL (B1 > L-LONGUEUR)
COBOL                  IF (L1-VAL(B1:1) = L2-VAL(B1:1))
COBOL                     MOVE '.'                TO L2-VAL(B1:1)
COBOL                  END-IF
COBOL                  IF (L1-VAL(B1:1) = SPACE OR <= X'32')
COBOL                     MOVE K-SPACE            TO L1-VAL(B1:1)
COBOL                  END-IF
COBOL                  IF (L2-VAL(B1:1) = SPACE OR <= X'32')
COBOL                     MOVE K-SPACE            TO L2-VAL(B1:1)
COBOL                  END-IF
COBOL               END-PERFORM
COBOL
COBOL               WRITE SYSPRINT-RECORD FROM L1
COBOL               WRITE SYSPRINT-RECORD FROM L2
COBOL               MOVE '               ...'     TO L1-RUB
COBOL               MOVE SPACE                    TO L2-PIC
COBOL               MOVE SPACE                    TO L2-OFSET
COBOL            END-PERFORM.
COBOL            MOVE SPACE                       TO SYSPRINT-RECORD.
COBOL            WRITE SYSPRINT-RECORD.
COBOL
COBOL       ******************************************************************
COBOL        EDITE-DIFFERENCE-PAR-RECORD.
COBOL       *---------------------------*
COBOL            PERFORM GET-SYSUT1.
COBOL            PERFORM GET-SYSUT2.
COBOL       * NBRE DE LIGNE A EDITER SI LE RECORD FAIT PLUS DE 100C
COBOL            MOVE LG-COPY                     TO J.
COBOL            DIVIDE J BY 100 GIVING N REMAINDER R.
COBOL            IF (R > ZERO) ADD 1 TO N.
COBOL
COBOL       * POUR TOUS LES MORCEAUX DE 100 DE L'ENREGISTREMENT
COBOL            MOVE 1                           TO B1
COBOL            PERFORM EDITE-PAR-100C
COBOL            VARYING R FROM 1 BY 1 UNTIL (R > N).
COBOL
COBOL       ******************************************************************
COBOL        EDITE-PAR-100C.
COBOL       *--------------*
COBOL            COMPUTE B2 = B1 + 99
COBOL            IF (B2 > LG-COPY) MOVE LG-COPY   TO B2 END-IF
COBOL
COBOL       * REGLETTE
COBOL            MOVE B1                          TO L4-OFS-D
COBOL            MOVE B2                          TO L4-OFS-F
COBOL            MOVE T-REGLE                     TO L4-REGLE
COBOL            WRITE SYSPRINT-RECORD FROM L4
COBOL            COMPUTE B2 = 1 + B2 - B1
COBOL
COBOL       * RECORD AVANT (AU-DESSUS)
COBOL            MOVE UT1-REC(B1:B2)              TO L-VALEUR
COBOL            MOVE B2                          TO L-LONGUEUR
COBOL            CALL SP-MSSHEXA USING L-VALEUR L-VALEUR-HEXA L-LONGUEUR
COBOL            PERFORM SPLIT-HEXA
COBOL
COBOL       * AFFICHAGE EN HEXA SI DATA NON AFFICHABLE
COBOL            MOVE K-HAUT                      TO W-QUEL-RECORD
COBOL            PERFORM TEST-CHAR
COBOL            VARYING IX FROM 1 BY 1
COBOL              UNTIL (IX > B2)
COBOL
COBOL            IF (L-VALEUR-HEXA-D1(1:B2) NOT = SPACE)
COBOL               MOVE L-VALEUR-HEXA-D1(1:B2)   TO L5-RECORD
COBOL               WRITE SYSPRINT-RECORD       FROM L5
COBOL            END-IF
COBOL
COBOL            MOVE L-VALEUR-HEXA-D2(1:B2)      TO L5-RECORD
COBOL            WRITE SYSPRINT-RECORD          FROM L5
COBOL
COBOL       * RECORD APRES (EN DESSOUS)
COBOL            MOVE UT2-REC(B1:B2)              TO L-VALEUR
COBOL            MOVE B2                          TO L-LONGUEUR
COBOL            CALL SP-MSSHEXA USING L-VALEUR L-VALEUR-HEXA L-LONGUEUR
COBOL            PERFORM SPLIT-HEXA
COBOL
COBOL       * MARQUAGE DE L'ECART
COBOL            MOVE K-BAS                       TO W-QUEL-RECORD
COBOL            MOVE SPACE                       TO L5-RECORD
COBOL            MOVE B1                          TO JX
COBOL            PERFORM VARYING IX FROM 1 BY 1
COBOL              UNTIL (IX > B2)
COBOL               PERFORM TEST-CHAR
COBOL               IF (UT1-REC(JX:1) NOT = UT2-REC(JX:1))
COBOL                  MOVE '*'                   TO L5-RECORD(IX:1)
COBOL               ELSE
COBOL                  MOVE SPACE                 TO L-VALEUR-HEXA-D1(IX:1)
COBOL                  MOVE SPACE                 TO L-VALEUR-HEXA-D2(IX:1)
COBOL               END-IF
COBOL               ADD 1                         TO JX
COBOL            END-PERFORM
COBOL
COBOL            IF MODE-DEBUG
COBOL               DISPLAY '---2----------------------'
COBOL               DISPLAY '** > ' L5-RECORD(1:B2) '<'
COBOL               DISPLAY '** > ' L-VALEUR-HEXA-D1(1:B2) '<'
COBOL               DISPLAY '** > ' L-VALEUR-HEXA-D2(1:B2) '<'
COBOL               DISPLAY '--------------------------'
COBOL            END-IF
COBOL            IF (L5-RECORD NOT = SPACE)
COBOL               WRITE SYSPRINT-RECORD       FROM L5
COBOL
COBOL               IF (L-VALEUR-HEXA-D1(1:B2) NOT = SPACE)
COBOL                  MOVE L-VALEUR-HEXA-D1(1:B2) TO L5-RECORD
COBOL                  WRITE SYSPRINT-RECORD    FROM L5
COBOL               END-IF
COBOL
COBOL               MOVE L-VALEUR-HEXA-D2(1:B2)   TO L5-RECORD
COBOL               WRITE SYSPRINT-RECORD       FROM L5
COBOL            END-IF
COBOL
COBOL       * LIGNE VIDE ENTRE 2 RECORDS
COBOL            MOVE SPACE                       TO SYSPRINT-RECORD
COBOL            WRITE SYSPRINT-RECORD
COBOL
COBOL            ADD 100                          TO B1.
COBOL
COBOL       ******************************************************************
COBOL        TEST-CHAR.
COBOL       *---------*
COBOL            MOVE FUNCTION UPPER-CASE(L-VALEUR(IX:1)) TO MSCSIGN-CH
COBOL            IF (MSCSIGN-CH = SPACE)
COBOL            OR (MSCSIGN-CH >= 'A' AND <= 'Z')
COBOL            OR (MSCSIGN-CH >= '0' AND <= '9')
COBOL            OR (MSCSIGN-CH = '/' OR '-' OR '+' OR '.'
COBOL                          OR ':' OR ',' OR '?' OR '&'
COBOL                          OR '' OR '' OR '$' OR '='
COBOL                          OR '' OR '~' OR '' OR '_')
COBOL               IF REC-HAUT
COBOL                  MOVE SPACE                 TO L-VALEUR-HEXA-D1(IX:1)
COBOL                  MOVE L-VALEUR(IX:1)        TO L-VALEUR-HEXA-D2(IX:1)
COBOL               ELSE
COBOL                  MOVE L-VALEUR(IX:1)        TO L-VALEUR-HEXA-D1(IX:1)
COBOL                  MOVE SPACE                 TO L-VALEUR-HEXA-D2(IX:1)
COBOL               END-IF
COBOL            END-IF.
COBOL
COBOL       ******************************************************************
COBOL        ELIMINE-LE-SIGNE.
COBOL       *----------------*
COBOL            COMPUTE B1 = I + J - 1.
COBOL
COBOL            MOVE UT1-REC(B1:1)               TO MSCSIGN-CH
COBOL            PERFORM MSCSIGN-CORR-SIGNE
COBOL            MOVE MSCSIGN-CH                  TO UT1-REC(B1:1).
COBOL
COBOL            MOVE UT2-REC(B1:1)               TO MSCSIGN-CH
COBOL            PERFORM MSCSIGN-CORR-SIGNE
COBOL            MOVE MSCSIGN-CH                  TO UT2-REC(B1:1).
COBOL
COBOL       ******************************************************************
COBOL        INITIALISATION.
COBOL       *--------------*
COBOL
COBOL            IF MODE-DEBUG DISPLAY 'MSPCC DEBUG MODE ON' END-IF
COBOL
COBOL       *> LOGO MOVE
COBOL            CALL SP-MSSLOGO.
COBOL            DISPLAY PROG-ID PROG-DESC
COBOL
COBOL       *> ANALYSE DU COPY
COBOL            CALL SP-MSSCOPY  USING PARAM-MSSCOPY
COBOL            PERFORM VARYING I-RUB FROM 1 BY 1
COBOL              UNTIL (I-RUB > NB-RUB)
COBOL               MOVE W-TAGRUB                 TO RUB-TAG(I-RUB)
COBOL            END-PERFORM
COBOL
COBOL       *> CHARGEMENT DES OPTIONS EN MEMOIRE
COBOL            CALL SP-MSSOPT   USING PARAM-OPT.
COBOL
COBOL       *> TRAITEMENT DES OPTIONS DE LA SYSIN
COBOL            PERFORM VARYING I FROM 1 BY 1
COBOL              UNTIL (I > NB-OPT)
COBOL                 OR (OPT-MOTCLE(I) = SPACE)
COBOL
COBOL               EVALUATE OPT-MOTCLE(I)
COBOL
COBOL       *> POUR AVOIR UN AFFICHAGE DE MESSAGE DE DEBUG
COBOL                WHEN 'DEBUG'
COBOL                  MOVE K-OUI                 TO W-MODE-DEBUG
COBOL
COBOL       *> POUR AVOIR LE DETAIL PAR RUBRIQUE DU COPY
COBOL                WHEN 'DETAIL'
COBOL                  MOVE K-OUI                 TO MASK-DETAIL
COBOL
COBOL       *> DCB FORMAT DU FICHIER EXEMPLE: DCB=FB,80,400
COBOL                WHEN 'DCB'
COBOL                WHEN 'DCB1'
COBOL                  UNSTRING OPT-PARM(I) DELIMITED BY ','
COBOL                      INTO W-RECFM1 Z1 Z2
COBOL                  MOVE Z1                    TO ZNX
COBOL                  PERFORM STR-TO-INT
COBOL                  MOVE ZN9                   TO LG-REC1 LG-REC2
COBOL                  MOVE ZN9                   TO LG-REC-LU1 LG-REC-LU2
COBOL                  MOVE Z2                    TO ZNX
COBOL                  PERFORM STR-TO-INT
COBOL                  MOVE ZN9                   TO LG-BLOC1 LG-BLOC2 A1 A2
COBOL                  IF FILE-VARIABLE1
COBOL                     SUBTRACT 4            FROM LG-REC1 LG-REC2
COBOL                  END-IF
COBOL
COBOL                WHEN 'DCB2'
COBOL                  UNSTRING OPT-PARM(I) DELIMITED BY ','
COBOL                      INTO W-RECFM2 Z1 Z2
COBOL                  MOVE Z1                    TO ZNX
COBOL                  PERFORM STR-TO-INT
COBOL                  MOVE ZN9                   TO LG-REC2
COBOL                  MOVE Z2                    TO ZNX
COBOL                  PERFORM STR-TO-INT
COBOL                  MOVE ZN9                   TO LG-BLOC2 A2
COBOL                  IF FILE-VARIABLE2
COBOL                     SUBTRACT 4            FROM LG-REC2
COBOL                  END-IF
COBOL
COBOL       *> MASQUAGE DES ECARTS ON STOCKE L'INFO DANS LE TAG DE LA RUBRIQUE
COBOL                WHEN 'MASK'
COBOL                WHEN 'MASQUE'
COBOL                  IF (NB-MASK >= MAX-MASK)
COBOL                     MOVE 12                 TO RETURN-CODE
COBOL                     DISPLAY 'MASK: TROP DE MASQUES ' MAX-MASK
COBOL                     GOBACK
COBOL                  END-IF
COBOL                  PERFORM CHARGE-MASQUE
COBOL
COBOL       * TITRE DE LA COMPARAISON
COBOL                WHEN 'TITLE'
COBOL                  MOVE OPT-PARM(I)           TO W-TITLE
COBOL
COBOL       * ON IGNORE LES PREMIERS ENREGISTREMENTS
COBOL                WHEN 'SKIP'
COBOL                  MOVE OPT-VALUE(I)          TO MASK-SKIP
COBOL
COBOL       * ON COMPARE UN NOMBRE DEFINI D'ENREG
COBOL                WHEN 'STOP'
COBOL                  MOVE OPT-VALUE(I)          TO MASK-STOP
COBOL
COBOL       * ON IGNORE LES LIGNES BLANCHES ET LES CODES ASA EN 1
COBOL                WHEN 'REPORT'
COBOL                  MOVE K-OUI                 TO MASK-REPORT
COBOL
COBOL       * NBRE D'ECART ACCEPTE AVANT ARRET DU COMPARE
COBOL                WHEN 'MAXI'
COBOL                  IF OPT-VALUE(I) > ZERO
COBOL                     MOVE OPT-VALUE(I)       TO MAX-DIFF
COBOL                  END-IF
COBOL
COBOL               END-EVALUATE
COBOL
COBOL            END-PERFORM.
COBOL
COBOL       * ON MEMORISE LES VALEURS POUR RESTITUTION A LA FIN
COBOL            MOVE MAX-DIFF                    TO MAX-DIFF-OPT.
COBOL            MOVE MASK-SKIP                   TO MASK-SKIP-OPT.
COBOL            MOVE MASK-STOP                   TO MASK-STOP-OPT.
COBOL
COBOL       * DETECTION SI LES RECFM CONTIENNENT UN CODE ASA
COBOL            PERFORM VARYING I FROM 1 BY 1
COBOL            UNTIL (I > LENGTH OF W-RECFM1)
COBOL               IF (W-RECFM1(I:1) = 'A') MOVE 'A' TO W-ASA1 END-IF
COBOL               IF (W-RECFM2(I:1) = 'A') MOVE 'A' TO W-ASA2 END-IF
COBOL            END-PERFORM
COBOL
COBOL       * SI COMPARAISON SANS COPY
COBOL            IF (LG-COPY = ZERO)
COBOL               IF (LG-COPY < LG-REC1) MOVE LG-REC1 TO LG-COPY END-IF
COBOL               IF (LG-COPY < LG-REC2) MOVE LG-REC2 TO LG-COPY END-IF
COBOL
COBOL               MOVE 1                        TO J
COBOL               PERFORM VARYING I FROM 1 BY 1
COBOL                 UNTIL (I > NB-MASK)
COBOL                  IF (MASK-POS(I) > J)
COBOL                     ADD  1                  TO NB-RUB
COBOL                     MOVE J                  TO RUB-POS(NB-RUB)
COBOL                     COMPUTE RUB-LG(NB-RUB) = MASK-POS(I) - J
COBOL                     MOVE RUB-LG(NB-RUB)     TO RUB-N9(NB-RUB)
COBOL                     MOVE 'R-'               TO W-RUB-R
COBOL                     MOVE '-'                TO W-RUB-F1
COBOL                     MOVE SPACE              TO W-RUB-F2
COBOL                     MOVE RUB-POS(NB-RUB)    TO W-RUB-POS
COBOL                     MOVE RUB-LG(NB-RUB)     TO W-RUB-LG
COBOL                     MOVE RUB-LG(NB-RUB)     TO W-PIC-LG
COBOL                     MOVE W-RUB              TO RUB-NOM(NB-RUB)
COBOL                     MOVE W-PIC              TO RUB-PICTURE(NB-RUB)
COBOL                     MOVE 'X'                TO RUB-TYPE(NB-RUB)
COBOL                     MOVE 5                  TO RUB-NIVEAU(NB-RUB)
COBOL                     INITIALIZE W-TAGRUB
COBOL                     MOVE W-TAGRUB           TO RUB-TAG(NB-RUB)
COBOL                     ADD RUB-LG(NB-RUB)      TO J
COBOL                  END-IF
COBOL
COBOL                  ADD  1                     TO NB-RUB
COBOL                  MOVE NB-RUB                TO MASK-RUB(I)
COBOL                  MOVE 'R-'                  TO W-RUB-R
COBOL                  MOVE '-'                   TO W-RUB-F1
COBOL                  MOVE SPACE                 TO W-RUB-F2
COBOL                  MOVE MASK-POS(I)           TO W-RUB-POS
COBOL                  MOVE MASK-LG(I)            TO W-RUB-LG
COBOL                  MOVE MASK-LG(I)            TO W-PIC-LG
COBOL                  MOVE W-RUB                 TO RUB-NOM(NB-RUB)
COBOL                  MOVE W-PIC                 TO RUB-PICTURE(NB-RUB)
COBOL                  MOVE MASK-POS(I)           TO RUB-POS(NB-RUB)
COBOL                  MOVE MASK-LG(I)            TO RUB-LG(NB-RUB)
COBOL                  MOVE MASK-LG(I)            TO RUB-N9(NB-RUB)
COBOL                  MOVE 'X'                   TO RUB-TYPE(NB-RUB)
COBOL                  MOVE 5                     TO RUB-NIVEAU(NB-RUB)
COBOL                  MOVE I                     TO W-TAG-MASK
COBOL                  MOVE MASK-TYP(I)           TO W-TAG-TYP
COBOL                  MOVE W-TAGRUB              TO RUB-TAG(NB-RUB)
COBOL                  ADD RUB-LG(NB-RUB)         TO J
COBOL               END-PERFORM
COBOL
COBOL               IF (J < LG-COPY)
COBOL                  ADD 1                      TO NB-RUB
COBOL                  COMPUTE RUB-LG(NB-RUB) = LG-COPY - J + 1
COBOL                  MOVE J                     TO RUB-POS(NB-RUB)
COBOL                  MOVE 'R-'                  TO W-RUB-R
COBOL                  MOVE '-'                   TO W-RUB-F1
COBOL                  MOVE SPACE                 TO W-RUB-F2
COBOL                  MOVE J                     TO W-RUB-POS
COBOL                  MOVE RUB-LG(NB-RUB)        TO W-RUB-LG
COBOL                  MOVE RUB-LG(NB-RUB)        TO W-PIC-LG
COBOL                  MOVE W-RUB                 TO RUB-NOM(NB-RUB)
COBOL                  MOVE W-PIC                 TO RUB-PICTURE(NB-RUB)
COBOL                  MOVE 'X'                   TO RUB-TYPE(NB-RUB)
COBOL                  MOVE 5                     TO RUB-NIVEAU(NB-RUB)
COBOL                  INITIALIZE W-TAGRUB
COBOL                  MOVE W-TAGRUB              TO RUB-TAG(NB-RUB)
COBOL                  ADD RUB-LG(NB-RUB)         TO J
COBOL               END-IF
COBOL
COBOL               IF MODE-DEBUG
COBOL                  PERFORM VARYING I FROM 1 BY 1 UNTIL (I > NB-RUB)
COBOL                     DISPLAY 'COPY!' I '!' RUB-NOM(I) '!' RUB-PICTURE(I)
COBOL                               '!' RUB-POS(I) '!' RUB-LG(I)
COBOL                  END-PERFORM
COBOL                  PERFORM VARYING I FROM 1 BY 1 UNTIL (I > NB-MASK)
COBOL                     MOVE MASK-RUB(I) TO J
COBOL                     DISPLAY 'MASK!' I '!' RUB-NOM(J) '!' MASK-RUB(I)
COBOL                               '!' MASK-TYP(I)
COBOL                               '!' MASK-POS(I) '!' MASK-LG(I)
COBOL                  END-PERFORM
COBOL               END-IF
COBOL            END-IF
COBOL
COBOL       * DELTA ENTRE LONGUEUR DU COPY ET LONGUEUR DU RECORD
COBOL       * ON RAJOUTE UNE RUBRIQUE ALPHA EN FIN DE COPY
COBOL            IF (LG-COPY > LG-REC1)
COBOL            OR (LG-COPY > LG-REC2)
COBOL               ADD  1                        TO NB-RUB
COBOL               MOVE 'OVERFLOW'               TO RUB-NOM(NB-RUB)
COBOL               COMPUTE RUB-POS(NB-RUB) = LG-COPY + 1
COBOL               IF (LG-REC1 >= LG-REC2)
COBOL                  COMPUTE RUB-LG(NB-RUB) = LG-REC1 - LG-COPY
COBOL                  MOVE LG-REC1               TO LG-COPY
COBOL               ELSE
COBOL                  COMPUTE RUB-LG(NB-RUB) = LG-REC2 - LG-COPY
COBOL                  MOVE LG-REC2               TO LG-COPY
COBOL               END-IF
COBOL               MOVE RUB-LG(NB-RUB)           TO LG9
COBOL               STRING 'X(' LG9 ')'
COBOL                 DELIMITED BY SIZE INTO RUB-PICTURE(NB-RUB)
COBOL               DISPLAY T-RUB(NB-RUB)
COBOL            END-IF
COBOL
COBOL            IF MODE-DEBUG
COBOL               DISPLAY 'LG COPY = ' LG-COPY
COBOL               DISPLAY 'NB MASK = ' NB-MASK
COBOL            END-IF
COBOL
COBOL       *> LECTURE BLOC/RECORD DE CHAQUE FICHIER
COBOL            PERFORM OUVERTURE-DES-FICHIERS.
COBOL
COBOL            PERFORM LECTURE-SYSUT1.
COBOL            PERFORM LECTURE-SYSUT2.
COBOL
COBOL       *****************************************************************
COBOL        CHARGE-MASQUE.
COBOL       *-------------*
COBOL            ADD  1                           TO NB-MASK
COBOL            MOVE SPACE                       TO Z1 W-COMMENT
COBOL            UNSTRING OPT-PARM(I) DELIMITED BY ','
COBOL                INTO W-RUB Z1 W-COMMENT
COBOL            IF W-COMMENT = SPACE
COBOL               MOVE Z1                       TO W-COMMENT
COBOL            END-IF
COBOL
COBOL       * SI PAS DE COPY LE MASQUE EST EN OFS:LONGUEUR,MASQUE
COBOL            IF (NB-RUB = ZERO)
COBOL               MOVE 1                        TO I-RUB
COBOL               MOVE ZERO                     TO MASK-RUB(NB-MASK)
COBOL               UNSTRING W-RUB DELIMITED BY ':'
COBOL                   INTO W-OFSET W-LG
COBOL               MOVE W-OFSET                  TO ZNX
COBOL               PERFORM STR-TO-INT
COBOL               MOVE ZN9                      TO MASK-POS(NB-MASK)
COBOL               MOVE W-LG                     TO ZNX
COBOL               PERFORM STR-TO-INT
COBOL               MOVE ZN9                      TO MASK-LG (NB-MASK)
COBOL               IF (MASK-POS(NB-MASK) = ZERO)
COBOL               OR (MASK-LG (NB-MASK) = ZERO)
COBOL                  MOVE 12                    TO RETURN-CODE
COBOL                  DISPLAY 'MASK: OFSET:LONGUEUR INCORRECT '
COBOL                          'OFS=' W-OFSET ', LG=' W-LG
COBOL                  GOBACK
COBOL               END-IF
COBOL
COBOL       * SINON RUBRIQUE,MASQUE
COBOL            ELSE
COBOL               PERFORM BOUCLE
COBOL               VARYING I-RUB FROM 1 BY 1
COBOL                 UNTIL (I-RUB > NB-RUB)
COBOL                    OR (RUB-NOM(I-RUB) = W-RUB)
COBOL               IF (I-RUB > NB-RUB)
COBOL                  MOVE 12                    TO RETURN-CODE
COBOL                  DISPLAY 'MASK: RUBRIQUE INCONNUE ' W-RUB
COBOL                  GOBACK
COBOL               END-IF
COBOL               MOVE I-RUB                    TO MASK-RUB(NB-MASK)
COBOL               MOVE RUB-LG (I-RUB)           TO MASK-LG (NB-MASK)
COBOL               MOVE RUB-POS(I-RUB)           TO MASK-POS(NB-MASK)
COBOL            END-IF
COBOL
COBOL            MOVE NB-MASK                     TO W-TAG-MASK
COBOL            EVALUATE Z1
COBOL       * ON IGNORE COMPLETEMENT LA RUBRIQUE
COBOL             WHEN SPACE
COBOL             WHEN 'IGNORE'
COBOL               MOVE K-IGNORE                 TO MASK-TYP(NB-MASK)
COBOL               MOVE K-IGNORE                 TO W-TAG-TYP
COBOL       * ON ACCEPTE LES DIFFERENCES LOW-VALUE = SPACE
COBOL             WHEN 'LOW'
COBOL               MOVE K-LOW-SPACE              TO MASK-TYP(NB-MASK)
COBOL       * TRANSFORMATION MINUSCULE EN MAJUSCULE
COBOL             WHEN 'MINMAJ'
COBOL             WHEN 'MIN-MAJ'
COBOL               MOVE K-MIN-MAJ                TO MASK-TYP(NB-MASK)
COBOL               MOVE K-MIN-MAJ                TO W-TAG-TYP
COBOL       * POUR LES NUMERIQUES ETENDUES LE SIGNE EST SUR LE DERNIER CAR
COBOL       * POUR LES COMP-3 EGALITE SI POSITIF ET SANS SIGNE
COBOL             WHEN 'SIGN'
COBOL             WHEN 'SIGNE'
COBOL               MOVE K-SIGN                   TO MASK-TYP(NB-MASK)
COBOL               MOVE K-SIGN                   TO W-TAG-TYP
COBOL       * POUR UNE ZONE NUMERIQUE ON CALCULE LA DIFFERENCE
COBOL              WHEN 'DELTA'
COBOL                MOVE K-DELTA                 TO MASK-TYP(NB-MASK)
COBOL                MOVE K-DELTA                 TO W-TAG-TYP
COBOL                MOVE Z2                      TO ZNX
COBOL                PERFORM STR-TO-INT
COBOL                MOVE ZN9                     TO MASK-DELTA(NB-MASK)
COBOL       * NON IMPLEMENTE OU ERREUR
COBOL             WHEN OTHER
COBOL               DISPLAY 'MASK: MASQUE NON TRAITEE ' Z1
COBOL               MOVE 12                       TO RETURN-CODE
COBOL               GOBACK
COBOL            END-EVALUATE
COBOL
COBOL            MOVE W-TAGRUB                    TO RUB-TAG(I-RUB)
COBOL            MOVE W-COMMENT                   TO MASK-COMMENT(NB-MASK).
COBOL
COBOL       *****************************************************************
COBOL        BOUCLE. EXIT.
COBOL
COBOL       *****************************************************************
COBOL        OUVERTURE-DES-FICHIERS.
COBOL       *----------------------*
COBOL            OPEN INPUT  F-SYSUT1
COBOL            IF FS1 NOT = ZERO
COBOL               MOVE 12                       TO RETURN-CODE
COBOL               DISPLAY 'ERREUR OUVERTURE SYSUT-1 : ' FS1
COBOL               GOBACK.
COBOL
COBOL            OPEN INPUT  F-SYSUT2
COBOL            IF FS2 NOT = ZERO
COBOL               MOVE 12                       TO RETURN-CODE
COBOL               DISPLAY 'ERREUR OUVERTURE SYSUT-2 : ' FS2
COBOL               CLOSE F-SYSUT1
COBOL               GOBACK.
COBOL
COBOL            OPEN OUTPUT F-SYSPRINT.
COBOL            IF FS-PRINT NOT = ZERO
COBOL               MOVE 12                       TO RETURN-CODE
COBOL               DISPLAY 'ERREUR OUVERTURE SYSPRINT: ' FS-PRINT
COBOL               CLOSE F-SYSUT1
COBOL               CLOSE F-SYSUT2
COBOL               GOBACK.
COBOL
COBOL       *****************************************************************
COBOL        FERMETURE-DES-FICHIERS.
COBOL       *----------------------*
COBOL            CLOSE F-SYSUT1 F-SYSUT2 F-SYSPRINT.
COBOL
COBOL       *****************************************************************
COBOL        LECTURE-SYSUT1.
COBOL       *--------------*
COBOL            MOVE ZERO                        TO N
COBOL            PERFORM TEST AFTER
COBOL              UNTIL FIN-SYSUT1
COBOL                 OR (UT1-REC(1:LG-REC-LU1) NOT = SPACE)
COBOL                 OR NOT MODE-REPORT
COBOL               EVALUATE TRUE
COBOL                  WHEN FILE-FIXE1  PERFORM LECTURE-SYSUT1-FIXE
COBOL                  WHEN FILE-VARIABLE1 PERFORM LECTURE-SYSUT1-VARIABLE
COBOL               END-EVALUATE
COBOL               IF NOT FIN-SYSUT1
COBOL                  ADD 1                      TO N
COBOL                  IF WITH-ASA1
COBOL                     ADD 1                   TO A1
COBOL                     SUBTRACT 1            FROM LG-REC-LU1
COBOL                  END-IF
COBOL                  PERFORM GET-SYSUT1
COBOL               END-IF
COBOL            END-PERFORM.
COBOL            IF (N > 1)
COBOL               COMPUTE NB-REC-VIDE1 = NB-REC-VIDE1 + N - 1.
COBOL
COBOL       *****************************************************************
COBOL        GET-SYSUT1.
COBOL       *----------*
COBOL            MOVE UT1-BLOC(A1:LG-REC-LU1)     TO UT1-REC(1:LG-REC1).
COBOL
COBOL            IF MODE-DEBUG
COBOL               DISPLAY '1!' A1 '!' LG-REC-LU1 '!' UT1-REC(1:LG-REC1)
COBOL            END-IF.
COBOL
COBOL       *****************************************************************
COBOL        READ-BLOC1.
COBOL       *----------*
COBOL            MOVE LOW-VALUE                   TO UT1-BLOC
COBOL            READ F-SYSUT1
COBOL
COBOL             AT END
COBOL               MOVE K-OUI                    TO W-FIN-SYSUT1
COBOL
COBOL             NOT AT END
COBOL               ADD  1                        TO NB-BLOC1
COBOL               ADD  1                        TO NB-REC1
COBOL
COBOL               EVALUATE TRUE
COBOL                WHEN FILE-FIXE1
COBOL                  MOVE 1                     TO A1
COBOL                  MOVE LG-REC1               TO LG-REC-LU1
COBOL
COBOL                WHEN FILE-VARIABLE1
COBOL                  MOVE UT1-BLOC(1:2)         TO LG-BLOC-LU1X(3:2)
COBOL                  MOVE UT1-BLOC(3:2)         TO LG-BLOC-LU1X(1:2)
COBOL                  MOVE UT1-BLOC(5:2)         TO LG-REC-LU1X(3:2)
COBOL                  MOVE UT1-BLOC(7:2)         TO LG-REC-LU1X(1:2)
COBOL                  SUBTRACT 4               FROM LG-REC-LU1
COBOL                  MOVE 9                     TO A1
COBOL               END-EVALUATE
COBOL            END-READ.
COBOL
COBOL       *****************************************************************
COBOL        LECTURE-SYSUT1-FIXE.
COBOL       *-------------------*
COBOL            ADD LG-REC1                      TO A1
COBOL
COBOL            IF (A1 > LG-BLOC1)
COBOL               PERFORM READ-BLOC1
COBOL            ELSE
COBOL               IF (UT1-BLOC(A1:LG-REC1) = LOW-VALUE)
COBOL                  MOVE K-OUI                 TO W-FIN-SYSUT1
COBOL                  MOVE HIGH-VALUE            TO UT1-REC
COBOL               ELSE
COBOL                  ADD 1                      TO NB-REC1
COBOL                  MOVE LG-REC1               TO LG-REC-LU1
COBOL               END-IF
COBOL            END-IF.
COBOL
COBOL       *****************************************************************
COBOL        LECTURE-SYSUT1-VARIABLE.
COBOL       *-----------------------*
COBOL            ADD LG-REC-LU1                   TO A1
COBOL
COBOL            IF (A1 > LG-BLOC-LU1)
COBOL               PERFORM READ-BLOC1
COBOL
COBOL            ELSE
COBOL               ADD  1                        TO NB-REC1
COBOL               COMPUTE B1 = A1 + 2
COBOL               MOVE UT1-BLOC(A1:2)           TO LG-REC-LU1X(3:2)
COBOL               MOVE UT1-BLOC(B1:2)           TO LG-REC-LU1X(1:2)
COBOL               SUBTRACT 4                  FROM LG-REC-LU1
COBOL               ADD  4                        TO A1
COBOL            END-IF.
COBOL
COBOL       *****************************************************************
COBOL        LECTURE-SYSUT2.
COBOL       *--------------*
COBOL            MOVE ZERO                        TO N
COBOL            PERFORM TEST AFTER
COBOL              UNTIL FIN-SYSUT2
COBOL                 OR (UT2-REC(1:LG-REC-LU2) NOT = SPACE)
COBOL                 OR NOT MODE-REPORT
COBOL               EVALUATE TRUE
COBOL                  WHEN FILE-FIXE2  PERFORM LECTURE-SYSUT2-FIXE
COBOL                  WHEN FILE-VARIABLE2 PERFORM LECTURE-SYSUT2-VARIABLE
COBOL               END-EVALUATE
COBOL               IF NOT FIN-SYSUT2
COBOL                  ADD 1                      TO N
COBOL                  IF WITH-ASA2
COBOL                     ADD 1                   TO A2
COBOL                     SUBTRACT 1            FROM LG-REC-LU2
COBOL                  END-IF
COBOL                  PERFORM GET-SYSUT2
COBOL               END-IF
COBOL            END-PERFORM.
COBOL            IF (N > 1)
COBOL               COMPUTE NB-REC-VIDE2 = NB-REC-VIDE2 + N - 1.
COBOL
COBOL       *****************************************************************
COBOL        GET-SYSUT2.
COBOL       *----------*
COBOL            MOVE UT2-BLOC(A2:LG-REC-LU2)     TO UT2-REC(1:LG-REC2)
COBOL
COBOL            IF MODE-DEBUG
COBOL               DISPLAY '2!' A2 '!' LG-REC-LU2 '!' UT2-REC(1:LG-REC2)
COBOL            END-IF.
COBOL
COBOL       *****************************************************************
COBOL        READ-BLOC2.
COBOL       *----------*
COBOL            MOVE LOW-VALUE                   TO UT2-BLOC
COBOL            READ F-SYSUT2
COBOL
COBOL             AT END
COBOL               MOVE K-OUI                    TO W-FIN-SYSUT2
COBOL
COBOL             NOT AT END
COBOL               ADD  1                        TO NB-BLOC2
COBOL               ADD  1                        TO NB-REC2
COBOL
COBOL               EVALUATE TRUE
COBOL                WHEN FILE-FIXE2
COBOL                  MOVE 1                     TO A2
COBOL                  MOVE LG-REC2               TO LG-REC-LU2
COBOL
COBOL                WHEN FILE-VARIABLE2
COBOL                  MOVE UT2-BLOC(1:2)         TO LG-BLOC-LU2X(3:2)
COBOL                  MOVE UT2-BLOC(3:2)         TO LG-BLOC-LU2X(1:2)
COBOL                  MOVE UT2-BLOC(5:2)         TO LG-REC-LU2X(3:2)
COBOL                  MOVE UT2-BLOC(7:2)         TO LG-REC-LU2X(1:2)
COBOL                  SUBTRACT 4               FROM LG-REC-LU2
COBOL                  MOVE 9                     TO A2
COBOL               END-EVALUATE
COBOL            END-READ.
COBOL
COBOL       *****************************************************************
COBOL        LECTURE-SYSUT2-FIXE.
COBOL       *-------------------*
COBOL            ADD LG-REC2                      TO A2
COBOL
COBOL            IF (A2 > LG-BLOC2)
COBOL               PERFORM READ-BLOC2
COBOL
COBOL            ELSE
COBOL               IF (UT2-BLOC(A2:LG-REC2) = LOW-VALUE)
COBOL                  MOVE K-OUI                 TO W-FIN-SYSUT2
COBOL                  MOVE HIGH-VALUE            TO UT2-REC
COBOL               ELSE
COBOL                  ADD 1                      TO NB-REC2
COBOL                  MOVE LG-REC2               TO LG-REC-LU2
COBOL               END-IF
COBOL            END-IF.
COBOL
COBOL       *****************************************************************
COBOL        LECTURE-SYSUT2-VARIABLE.
COBOL       *-----------------------*
COBOL            ADD LG-REC-LU2                   TO A2
COBOL
COBOL            IF (A2 > LG-BLOC-LU2)
COBOL               PERFORM READ-BLOC2
COBOL
COBOL            ELSE
COBOL               ADD  1                        TO NB-REC2
COBOL               COMPUTE B2 = A2 + 2
COBOL               MOVE UT2-BLOC(A2:2)           TO LG-REC-LU2X(3:2)
COBOL               MOVE UT2-BLOC(B2:2)           TO LG-REC-LU2X(1:2)
COBOL               SUBTRACT 4                  FROM LG-REC-LU2
COBOL               ADD  4                        TO A2
COBOL            END-IF.
COBOL
COBOL       *****************************************************************
COBOL        MESSAGES-INFORMATIFS.
COBOL       *--------------------*
COBOL            IF (W-TITLE NOT = SPACE)
COBOL               ADD  1                        TO I-MSG
COBOL               MOVE W-TITLE                  TO LL(I-MSG)
COBOL               ADD  1                        TO I-MSG
COBOL               MOVE '-'                      TO LL(I-MSG)
COBOL            END-IF
COBOL
COBOL            IF (MAX-DIFF = ZERO)
COBOL               ADD  1                        TO I-MSG
COBOL               MOVE 'LIMITE DU NOMBRE D''ECART ACCEPTE ATTEINTE'
COBOL                 TO L3-MSG
COBOL               MOVE MAX-DIFF-OPT             TO L3-NB
COBOL               MOVE SPACE                    TO L3-PART2
COBOL               MOVE L3                       TO LL(I-MSG)
COBOL               MOVE 2                        TO RETURN-CODE
COBOL            ELSE
COBOL               IF (MAX-DIFF = MAX-DIFF-OPT)
COBOL                  ADD  1                     TO I-MSG
COBOL                  MOVE 'COMPARE OK'          TO LL(I-MSG)
COBOL                  ADD  1                     TO I-MSG
COBOL                  MOVE '-'                   TO LL(I-MSG)
COBOL               ELSE
COBOL                  MOVE 1                     TO RETURN-CODE
COBOL               END-IF
COBOL            END-IF
COBOL
COBOL            IF (MASK-STOP = ZERO)
COBOL               ADD  1                        TO I-MSG
COBOL               MOVE 'LIMITE DU NOMBRE D''ENREG A COMPARER ATTEINTE'
COBOL                 TO L3-MSG
COBOL               MOVE MASK-STOP-OPT            TO L3-NB
COBOL               MOVE SPACE                    TO L3-PART2
COBOL               MOVE L3                       TO LL(I-MSG)
COBOL            END-IF
COBOL
COBOL            IF (MASK-SKIP-OPT NOT = ZERO)
COBOL               ADD  1                        TO I-MSG
COBOL               MOVE 'NB D''ENREG IGNORE EN DEBUT DE FICHIER (SKIP)'
COBOL                 TO L3-MSG
COBOL               MOVE MASK-SKIP-OPT            TO L3-NB
COBOL               MOVE SPACE                    TO L3-PART2
COBOL               MOVE L3                       TO LL(I-MSG)
COBOL            END-IF
COBOL
COBOL            ADD  1                           TO I-MSG
COBOL            MOVE 'NB D''ENREG LU SYSUT1'     TO L3-MSG
COBOL            MOVE NB-REC1                     TO L3-NB
COBOL            IF (NB-REC-VIDE1 > ZERO)
COBOL               MOVE 'DONT VIDE'              TO L3-MSG2
COBOL               MOVE NB-REC-VIDE1             TO L3-NB2
COBOL            ELSE
COBOL               MOVE SPACE                    TO L3-PART2
COBOL            END-IF
COBOL            MOVE L3                          TO LL(I-MSG)
COBOL
COBOL            ADD  1                           TO I-MSG
COBOL            MOVE 'NB D''ENREG LU SYSUT2'     TO L3-MSG
COBOL            MOVE NB-REC2                     TO L3-NB
COBOL            IF (NB-REC-VIDE2 > ZERO)
COBOL               MOVE 'DONT VIDE'              TO L3-MSG2
COBOL               MOVE NB-REC-VIDE2             TO L3-NB2
COBOL            ELSE
COBOL               MOVE SPACE                    TO L3-PART2
COBOL            END-IF
COBOL            MOVE L3                          TO LL(I-MSG)
COBOL
COBOL            ADD  1                           TO I-MSG
COBOL            MOVE 'NB D''ENREG COMPARE'       TO L3-MSG
COBOL            MOVE NB-COMPARE                  TO L3-NB
COBOL            MOVE SPACE                       TO L3-PART2
COBOL            MOVE L3                          TO LL(I-MSG)
COBOL
COBOL            ADD  1                           TO I-MSG
COBOL            MOVE 'NB D''ENREG AVEC ECART'    TO L3-MSG
COBOL            MOVE NB-ECART                    TO L3-NB
COBOL            MOVE 'DONT ACCEPTE'              TO L3-MSG2
COBOL            MOVE NB-ACCEPT                   TO L3-NB2
COBOL            MOVE L3                          TO LL(I-MSG)
COBOL
COBOL            IF (FIN-SYSUT1 AND NOT FIN-SYSUT2)
COBOL            OR (FIN-SYSUT2 AND NOT FIN-SYSUT1)
COBOL               ADD  1                        TO I-MSG
COBOL               MOVE 'NOMBRE ENREG DIFFERENT ENTRE LES FICHIERS'
COBOL                 TO LL(I-MSG)
COBOL            END-IF
COBOL            .
COBOL       *****************************************************************
COBOL        EDITION-DU-COMPTE-RENDU.
COBOL       *--------------------*
COBOL            IF (NB-DIFF > ZERO)
COBOL               ADD  1                        TO I-MSG
COBOL               MOVE '-'                      TO LL(I-MSG)
COBOL               ADD  1                        TO I-MSG
COBOL               MOVE LD-MASK-HEAD             TO LL(I-MSG)
COBOL
COBOL               PERFORM VARYING I FROM 1 BY 1 UNTIL (I > NB-RUB)
COBOL                  MOVE RUB-TAG(I)            TO W-TAGRUB
COBOL                  MOVE W-TAG-MASK            TO J
COBOL                  MOVE W-TAG-ECART           TO LDR-ECART
COBOL                  IF (W-TAG-ECART > 0)
COBOL                     IF (J > ZERO)
COBOL                        MOVE MASK-ACCEPT(J)  TO LDR-ACCEPT
COBOL                        MOVE MASK-COMMENT(J) TO LDR-COMMENT
COBOL                     ELSE
COBOL                        MOVE ZERO            TO LDR-ACCEPT
COBOL                        MOVE SPACE           TO LDR-COMMENT
COBOL                     END-IF
COBOL                     MOVE RUB-NOM(I)         TO LDR-RUB
COBOL                     MOVE RUB-POS(I)         TO LDR-POS
COBOL                     MOVE RUB-LG(I)          TO LDR-LG
COBOL                     MOVE RUB-PICTURE(I)     TO LDR-PIC
COBOL                     ADD 1                   TO I-MSG
COBOL                     MOVE LD-MASK-DETAIL     TO LL(I-MSG)
COBOL                  END-IF
COBOL               END-PERFORM
COBOL            END-IF.
COBOL
COBOL            MOVE SPACE                       TO SYSPRINT-RECORD
COBOL            WRITE SYSPRINT-RECORD
COBOL            PERFORM VARYING I FROM 1 BY 1 UNTIL (I > 100)
COBOL               IF (LL(I) = '-')
COBOL                  MOVE SPACE                 TO SYSPRINT-RECORD
COBOL                  WRITE SYSPRINT-RECORD
COBOL               ELSE
COBOL                  IF (LL(I) NOT = SPACE)
COBOL                     WRITE SYSPRINT-RECORD FROM LL(I)
COBOL                  END-IF
COBOL               END-IF
COBOL            END-PERFORM.
COBOL
COBOL       *****************************************************************
COBOL        STR-TO-INT.
COBOL       *----------*
COBOL            MOVE ZERO                        TO ZN9
COBOL            PERFORM VARYING IZ FROM 1 BY 1 UNTIL IZ > LENGTH OF ZNX
COBOL               IF ZN1(IZ) NUMERIC
COBOL                  COMPUTE ZN9 = ZN9 * 10 + ZN1(IZ)
COBOL               END-IF
COBOL            END-PERFORM.
COBOL
COBOL       *****************************************************************
COBOL        SPLIT-HEXA.
COBOL       *----------*
COBOL       * SPLIT DE LA VALEUR HEXA SUR 2 LIGNES
COBOL            MOVE ZERO                        TO IX JX
COBOL            PERFORM UNTIL (JX > L-LONGUEUR)
COBOL              ADD  1                         TO IX JX
COBOL              MOVE L-VALEUR-HEXA(IX:1)       TO L-VALEUR-HEXA-D1(JX:1)
COBOL              ADD  1                         TO IX
COBOL              MOVE L-VALEUR-HEXA(IX:1)       TO L-VALEUR-HEXA-D2(JX:1)
COBOL            END-PERFORM.
COBOL
COBOL       *****< COPY DE PROCEDURE >***************************************
COBOL            COPY MSCSIGN SUPPRESS.
COBOL
COBOL       *****< FIN DU SOURCE : MSPCC   >*********************************
COBOL MEMBER NAME  TTEST
COBOL        IDENTIFICATION DIVISION.
COBOL **************************************************************************
COBOL        PROGRAM-ID. TTEST.
COBOL **************************************************************************
COBOL        AUTHOR. MOVE SOLUTIONS.
COBOL        ENVIRONMENT DIVISION.
COBOL        CONFIGURATION SECTION.
COBOL        SOURCE-COMPUTER. IBM-370.
COBOL        OBJECT-COMPUTER. IBM-370.
COBOL        SPECIAL-NAMES.
COBOL       *    DECIMAL-POINT IS COMMA.
COBOL
COBOL        INPUT-OUTPUT SECTION.
COBOL       *=====================
COBOL        FILE-CONTROL.
COBOL            SELECT F-TRAV   ASSIGN TO  TRAV.
COBOL **************************************************************************
COBOL        DATA DIVISION.
COBOL       *==============
COBOL        FILE SECTION.
COBOL       *=============
COBOL        FD  F-TRAV
COBOL            RECORDING MODE IS V
COBOL            BLOCK 0 RECORDS.
COBOL        01  REG-TRAV.
COBOL            05  TRAV-LG       PIC 9(8) COMP.
COBOL            05  TRAV-DATA.
COBOL                10 FILLER PIC X OCCURS 76 DEPENDING ON TRAV-LG.
COBOL **************************************************************************
COBOL        WORKING-STORAGE SECTION.
COBOL        77 ZZ           PIC --9V,999999999.
COBOL        77 AA-1-8       PIC S9(1)V9(8) COMP-3.
COBOL        77 BB-2-7       PIC S9(2)V9(7) COMP-3.
COBOL        77 CC-2-7       PIC S9(2)V9(7) COMP-3.
COBOL **************************************************************************
COBOL        PROCEDURE DIVISION.
COBOL            DISPLAY  "CREATION FICHIER TRAV EN VARIABLE"
COBOL            OPEN OUTPUT F-TRAV
COBOL            MOVE 11 TO TRAV-LG
COBOL            MOVE "1234567890 "                 TO TRAV-DATA
COBOL            WRITE REG-TRAV
COBOL            MOVE 27 TO TRAV-LG
COBOL            MOVE "ABCDEFGHIJKLMNOPQRSTUVWXYZ " TO TRAV-DATA
COBOL            WRITE REG-TRAV
COBOL            CLOSE F-TRAV.
COBOL
COBOL            DISPLAY  "***=****,123456789***"
COBOL
COBOL            COMPUTE AA-1-8 = 1.12345672
COBOL            COMPUTE BB-2-7 = AA-1-8
COBOL            MOVE BB-2-7 TO ZZ
COBOL            DISPLAY "01 = " ZZ
COBOL
COBOL            COMPUTE AA-1-8 = 1.12345675
COBOL            COMPUTE BB-2-7 = AA-1-8
COBOL            MOVE BB-2-7 TO ZZ
COBOL            DISPLAY "01 = " ZZ
COBOL
COBOL            COMPUTE AA-1-8 = 1.12345678
COBOL            COMPUTE BB-2-7 = AA-1-8
COBOL            MOVE BB-2-7 TO ZZ
COBOL            DISPLAY "01 = " ZZ
COBOL
COBOL            COMPUTE AA-1-8 = 1.12345672
COBOL            COMPUTE BB-2-7 ROUNDED = AA-1-8
COBOL            MOVE BB-2-7 TO ZZ
COBOL            DISPLAY "01R= " ZZ
COBOL
COBOL            COMPUTE AA-1-8 = 1.12345675
COBOL            COMPUTE BB-2-7 ROUNDED = AA-1-8
COBOL            MOVE BB-2-7 TO ZZ
COBOL            DISPLAY "01R= " ZZ
COBOL
COBOL            COMPUTE AA-1-8 = 1.12345678
COBOL            COMPUTE BB-2-7 ROUNDED = AA-1-8
COBOL            MOVE BB-2-7 TO ZZ
COBOL            DISPLAY "01R= " ZZ
COBOL
COBOL            GOBACK.
COBOL MEMBER NAME  PTRACE1
COBOL        IDENTIFICATION DIVISION.
COBOL        PROGRAM-ID. PTRACE1.
COBOL        ENVIRONMENT DIVISION.
COBOL        DATA DIVISION.
COBOL        WORKING-STORAGE SECTION.
COBOL        01 PGM-NAME PIC X(08) VALUE 'PTRACE1'.
COBOL        01 EDIT               PIC  9(15).
COBOL        01 CICS-ABEND         PIC  X(04) VALUE SPACE.
COBOL        01 TIRET              PIC  X(80) VALUE ALL '-'.
COBOL        01 MSG                PIC  X(79) VALUE SPACE.
COBOL        01 LON                PIC  S9(4) COMP.
COBOL        01 DATE-SEP           PIC  X(01) VALUE '-'.
COBOL        01 TIME-SEP           PIC  X(01) VALUE ':'.
COBOL        01 CICS-ABSTIME       PIC  S9(15) COMP-3.
COBOL        01 CICS-YEAR          PIC  S9(08) COMP.
COBOL        01 CICS-SIECLE        PIC  9(02).
COBOL        01 CICS-YYMMDD.
COBOL           05 CICS-YY         PIC  9(02).
COBOL           05 FILLER          PIC  X(01).
COBOL           05 CIS-MON         PIC  9(02).
COBOL           05 FILLER          PIC  X(01).
COBOL           05 CICS-DD         PIC  9(02).
COBOL        01 CICS-TIME.
COBOL           05 CICS-HH         PIC  9(02).
COBOL           05 FILLER          PIC  X(01).
COBOL           05 CICS-MIN        PIC  9(02).
COBOL           05 FILLER          PIC  X(01).
COBOL           05 CICS-SS         PIC  9(02).
COBOL        LINKAGE SECTION.
COBOL        01 DFHCOMMAREA        PIC X(1).
COBOL        PROCEDURE DIVISION.
COBOL
COBOL            PERFORM CALL-TRAIT
COBOL            EXEC CICS RETURN
COBOL            END-EXEC.
COBOL            GOBACK.
COBOL
COBOL       *-----------------------------------------------------------------
COBOL       *     RECUPERATION DATE SYSTEME
COBOL       *-----------------------------------------------------------------
COBOL        RECUP-DATE.
COBOL
COBOL            EXEC CICS ASKTIME
COBOL                 ABSTIME(CICS-ABSTIME)
COBOL            END-EXEC.
COBOL            EXEC CICS FORMATTIME
COBOL                 ABSTIME(CICS-ABSTIME)
COBOL                 YYMMDD(CICS-YYMMDD)
COBOL                 YEAR(CICS-YEAR)
COBOL                 DATESEP(DATE-SEP)
COBOL                 TIME(CICS-TIME)
COBOL                 TIMESEP(TIME-SEP)
COBOL            END-EXEC.
COBOL            MOVE CICS-YEAR         TO CICS-SIECLE
COBOL            .
COBOL
COBOL       *-----------------------------------------------------------------
COBOL       *     APPEL TRAITEMENT
COBOL       *-----------------------------------------------------------------
COBOL        CALL-TRAIT.
COBOL
COBOL            PERFORM RECUP-DATE
COBOL            MOVE LENGTH OF MSG TO LON
COBOL            INITIALIZE MSG
COBOL            STRING
COBOL               'LE '
COBOL               CICS-SIECLE
COBOL               CICS-YYMMDD
COBOL               ' A '
COBOL               CICS-TIME
COBOL               ' : DEBUT DU TRAITEMENT '
COBOL               PGM-NAME
COBOL               DELIMITED BY SIZE INTO MSG
COBOL            END-STRING
COBOL            PERFORM DISP.
COBOL *******    EXEC CICS LINK PROGRAMM(NOM-PROG) END-EXEC
COBOL            .
COBOL
COBOL       *-----------------------------------------------------------------
COBOL       *     DISP
COBOL       *-----------------------------------------------------------------
COBOL
COBOL        DISP.
COBOL            EXEC CICS
COBOL               SEND TEXT FROM(MSG) LENGTH(LON)
COBOL            END-EXEC
COBOL            .
COBOL
COBOL
BMS   MEMBER NAME  BCOBCIC
BMS            TITLE 'MOVE SOLUTIONS EXEMPLE MAP BMS  '                       00
BMS            PRINT ON,NOGEN                                                 00
BMS   BCOBCIC  DFHMSD TYPE=MAP,LANG=COBOL,MODE=INOUT,SUFFIX=                  00
BMS            TITLE 'MOVE SOLUTIONS EXEMPLE MAP BMS  '                       00
BMS   BCOBCIC  DFHMDI SIZE=(24,80),CTRL=(HONEOM,FREEKB,FRSET),COLUMN=SAME,   *00
BMS                  LINE=1,DATA=FIELD,TIOAPFX=YES,JUSTIFY=(LEFT),OBFMT=NO    00
BMS            DFHMDF POS=(1,1),LENGTH=39,                                   *00
BMS                  INITIAL='MOVE SOLUTION - CHARLES BERTRAND',             *00
BMS                  ATTRB=(ASKIP,NORM)                                       00
BMS            DFHMDF POS=(1,76),LENGTH=4,INITIAL='TCOB',ATTRB=(ASKIP,NORM)   00
BMS            DFHMDF POS=(5,1),LENGTH=39,                                   *00
BMS                  INITIAL='10. PREMIER CHOIX .....................',      *00
BMS                  ATTRB=(ASKIP,NORM)                                       00
BMS            DFHMDF POS=(6,1),LENGTH=18,INITIAL='20. SECOND CHOIX..',      *00
BMS                  ATTRB=(ASKIP,NORM)                                       00
BMS            DFHMDF POS=(6,30),LENGTH=10,INITIAL='(PCOBCIC )',ATTRB=(ASKIP,*00
BMS                  NORM)                                                    00
BMS            DFHMDF POS=(11,1),LENGTH=9,INITIAL='MON CHOIX',ATTRB=(ASKIP,NO*00
BMS                  RM)                                                      00
BMS   CHOIX    DFHMDF POS=(11,11),LENGTH=2,INITIAL='..',ATTRB=(UNPROT,NUM,NOR*00
BMS                  M,IC,FSET)                                               00
BMS   SSCHOIX  DFHMDF POS=(11,14),LENGTH=1,INITIAL='.',ATTRB=(UNPROT,NUM,NORM*00
BMS                  ,FSET)                                                   00
BMS            DFHMDF POS=(11,16),LENGTH=1,ATTRB=(ASKIP,NORM)                 00
BMS            DFHMSD TYPE=FINAL                                              00
BMS            END                                                            00
BMS   MEMBER NAME  MTRACE1
BMS            TITLE 'MOVE SOLUTIONS  MAP POUR TRACE   '                      00
BMS            PRINT ON,NOGEN                                                 00
BMS   MTRACE1  DFHMSD TYPE=MAP,LANG=COBOL,MODE=INOUT,SUFFIX=                  00
BMS            TITLE 'MOVE SOLUTIONS MAP POUR TRACE   '                       00
BMS   MTRACE1  DFHMDI SIZE=(24,80),CTRL=(HONEOM,FREEKB,FRSET),COLUMN=SAME,   *00
BMS                  LINE=1,DATA=FIELD,TIOAPFX=YES,JUSTIFY=(LEFT),OBFMT=NO    00
BMS   LIGTOP1  DFHMDF POS=(01,01),LENGTH=79,                                 *00
BMS            ATTRB=(ASKIP,NORM)                                             00
BMS   LIGTOP2  DFHMDF POS=(02,01),LENGTH=79,                                 *00
BMS            ATTRB=(ASKIP,NORM)                                             00
BMS   LIGTOP3  DFHMDF POS=(03.01),LENGTH=79,                                 *00
BMS            ATTRB=(ASKIP,NORM)                                             00
BMS   LIGDET1  DFHMDF POS=(13.01),LENGTH=79,                                 *00
BMS            ATTRB=(ASKIP,NORM)                                             00
BMS   LIGBOT1  DFHMDF POS=(22,01),LENGTH=79,                                 *00
BMS            ATTRB=(ASKIP,NORM)                                             00
BMS   LITCHOI  DFHMDF POS=(23,1),LENGTH=9,                                   *00
BMS            ITITIAL='MON CHOIX',                                          *00
BMS            ATTRB=(ASKIP,NORM)                                             00
BMS   SAICHOI  DFHMDF POS=(23,1),LENGTH=9,                                   *00
BMS            ITITIAL='.',                                                  *00
BMS            ATTRB=(UNPROT,NUM,NORM,IC,FSET)                                00
BMS   LIGBOT3  DFHMDF POS=(24.01),LENGTH=79,                                 *00
BMS            ATTRB=(ASKIP,NORM)                                             00
BMS            DFHMSD TYPE=FINAL                                              00
BMS            END                                                            00
